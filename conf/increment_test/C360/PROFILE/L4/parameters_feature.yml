# Config file for query generator
l4_customer_profile_ltv_to_date:
  where_clause: ""
  feature_list:
    # this is mandatory for joining to union_features table
    access_method_num: "access_method_num"
    register_date: "register_date"
    crm_sub_id: "crm_sub_id"
    charge_type: "charge_type"
    partition_month: "to_date(cast(partition_month) as String,'yyyyMM')"
    subscription_status: "mobile_status"

    ltv_to_date: >
      sum(norms_net_revenue) over (
            partition by crm_sub_id,
                         access_method_num,
                         register_date
            order by partition_month asc )
  granularity: ""
