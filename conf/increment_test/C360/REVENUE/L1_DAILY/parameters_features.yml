l1_revenue_prepaid_pru_f_usage_multi_daily:
  where_clause: ""
  feature_list:
    rev_arpu_total_net_rev: "total_net_tariff_revenue"
    rev_arpu_total_net_tariff_rev_reward: "total_net_tariff_revenue_reward"
    rev_arpu_total_net_tariff_rev_exc_reward: "total_net_tariff_revenue_exc_reward"
    rev_arpu_share_of_exc_reward_over_total_rev: "total_net_tariff_revenue_exc_reward / total_net_tariff_revenue"
    rev_arpu_share_of_revenue_reward_over_total_rev: "total_net_tariff_revenue_reward / total_net_tariff_revenue"
    rev_arpu_diffence_in_exc_reward_rev_reward: "total_net_tariff_revenue_exc_reward - total_net_tariff_revenue_reward"
    rev_arpu_number_of_distinct_ontop_packages: "case when gprs_ontop_package_name is not null then 1 else 0"
    rev_arpu_total_data_rev: "total_net_tariff_gprs_revenue"
    rev_arpu_total_data_rev_by_package: "total_net_tariff_gprs_package"
    rev_arpu_total_data_rev_by_ppu: "total_net_tariff_gprs_exc_package"

    ########################################### 4g #####################################################################
    rev_arpu_total_data_rev_4g: "total_net_tariff_gprs_revenue * (total_vol_gprs_4g/total_vol_gprs)"
    # share of 4G data revenue in data revenue
    rev_arpu_share_data_rev_4g: "(total_net_tariff_gprs_revenue * (total_vol_gprs_4g/total_vol_gprs))
                                / (total_net_tariff_gprs_revenue)"

    rev_arpu_total_data_rev_by_package_4g: "total_net_tariff_gprs_package * (total_vol_gprs_4g/total_vol_gprs)"
    # share of 4G data revenue in data package
    rev_arpu_share_data_rev_by_package_4g: "(total_net_tariff_gprs_package * (total_vol_gprs_4g/total_vol_gprs))
                                            / (total_net_tariff_gprs_package)"

    rev_arpu_total_data_rev_by_ppu_4g: "total_net_tariff_gprs_exc_package * (total_vol_gprs_4g/total_vol_gprs)"
    # share of 4G data revenue in data PPY
    rev_arpu_share_data_rev_by_ppu_4g: "(total_net_tariff_gprs_exc_package * (total_vol_gprs_4g/total_vol_gprs))
                                        / (total_net_tariff_gprs_exc_package)"

    ########################################## 3g ######################################################################
    rev_arpu_total_data_rev_2g_3g: "total_net_tariff_gprs_revenue * (total_vol_gprs_2g_3g/total_vol_gprs)"
    # share of 3G data revenue in data revenue
    rev_arpu_share_data_rev_2g_3g: "(total_net_tariff_gprs_revenue * (total_vol_gprs_2g_3g/total_vol_gprs))
                                    / (total_net_tariff_gprs_revenue)"

    rev_arpu_total_data_rev_by_package_2g_3g: "total_net_tariff_gprs_package * (total_vol_gprs_2g_3g/total_vol_gprs)"
    # share of 3G data revenue in data package
    rev_arpu_share_data_rev_by_package_2g_3g: "(total_net_tariff_gprs_package * (total_vol_gprs_2g_3g/total_vol_gprs))
                                              / (total_net_tariff_gprs_package)"

    rev_arpu_total_data_rev_by_ppu_2g_3g: "total_net_tariff_gprs_revenue * (total_vol_gprs_2g_3g/total_vol_gprs)"
    # share of 3G data revenue in data PPU
    rev_arpu_share_data_rev_by_ppu_2g_3g: "(total_net_tariff_gprs_exc_package * (total_vol_gprs_2g_3g/total_vol_gprs))
                                          / (total_net_tariff_gprs_exc_package)"

    #############################################per_unit###############################################################
    rev_arpu_total_data_rev_by_per_unit: "total_net_tariff_gprs_revenue / total_vol_gprs"

    rev_arpu_total_data_rev_per_unit_2g_3g: "(total_net_tariff_gprs_revenue * (total_vol_gprs_2g_3g/total_vol_gprs))
                                              / (total_vol_gprs_2g_3g)"

    rev_arpu_total_data_rev_per_unit_4g: "(total_net_tariff_gprs_revenue * (total_vol_gprs_4g/total_vol_gprs))
                                              / (total_vol_gprs_4g)"

    ##############################diff data revenue by package##########################################################
    rev_arpu_diffence_rev_by_package_ppu: "(total_net_tariff_gprs_package - total_net_tariff_gprs_exc_package)"

    rev_arpu_diffence_rev_by_package_ppu_4g: "(total_net_tariff_gprs_package * (total_vol_gprs_4g/total_vol_gprs))
     - (total_net_tariff_gprs_exc_package * (total_vol_gprs_4g/total_vol_gprs))"

    rev_arpu_diffence_rev_by_package_ppu_2g_3g: "(total_net_tariff_gprs_revenue * (total_vol_gprs_2g_3g/total_vol_gprs))
     - (total_net_tariff_gprs_exc_package * (total_vol_gprs_2g_3g/total_vol_gprs))"

    rev_arpu_diffence_rev_2g_3g_vs_4g: "(total_net_tariff_gprs_revenue * (total_vol_gprs_2g_3g/total_vol_gprs))
     - (total_net_tariff_gprs_revenue * (total_vol_gprs_4g/total_vol_gprs))"

    rev_arpu_diffence_rev_per_unit_2g_3g_vs_4g: "((total_net_tariff_gprs_revenue * (total_vol_gprs_2g_3g/total_vol_gprs))
        / (total_vol_gprs_2g_3g))  - ((total_net_tariff_gprs_revenue * (total_vol_gprs_4g/total_vol_gprs))
                                                      / (total_vol_gprs_4g))"
      ##############################voice features######################################################################

    rev_arpu_total_voice: "total_net_tariff_revenue_basic"
    rev_arpu_total_voice_intra: "total_net_tariff_basic_intra"
    # share of intra voice revenue
    rev_arpu_share_voice_intra: "total_net_tariff_basic_intra/total_net_tariff_revenue_basic"
    rev_arpu_total_voice_non_intra: "total_net_tariff_basic_non_intra"
    # share of non intra voice revenue
    rev_arpu_share_voice_non_intra: "total_net_tariff_basic_non_intra/total_net_tariff_revenue_basic"
    rev_arpu_total_voice_per_call: "total_net_tariff_revenue_basic/total_call"
    rev_arpu_total_voice_intra_per_call: "total_net_tariff_basic_intra/total_call"
    rev_arpu_total_voice_non_intra_per_call: "total_net_tariff_basic_non_intra/total_call"
    rev_arpu_total_voice_per_minute: "total_net_tariff_revenue_basic/total_minute"
    rev_arpu_total_voice_intra_per_minute: "total_net_tariff_basic_intra/total_minute"
    rev_arpu_total_voice_non_intra_per_minute: "total_net_tariff_basic_non_intra/total_minute"
    rev_arpu_difference_voice_intra_non_intra: "(total_net_tariff_basic_intra - total_net_tariff_basic_non_intra"
    rev_arpu_difference_voice_intra_non_intra_per_min:
                    "(total_net_tariff_basic_intra/total_minute) - (total_net_tariff_basic_non_intra/total_minute)"
    rev_arpu_total_days_0_rev: "case when total_net_tariff_revenue = 0 OR total_net_tariff_revenue is NULL
    THEN 1 ELSE 0 END"
    rev_arpu_total_days_data_0_rev: "case when total_net_tariff_gprs_revenue = 0 OR
    total_net_tariff_revenue is NULL THEN 1 ELSE 0 END"
    rev_arpu_total_days_data_ppu_0_rev: "case when total_net_tariff_gprs_exc_package = 0 OR
    total_net_tariff_revenue is NULL THEN 1 ELSE 0 END)"

    rev_arpu_total_days_4g_data_0_rev: "case when (total_net_tariff_gprs_revenue * (total_vol_gprs_4g/total_vol_gprs))
    = 0 or (total_net_tariff_gprs_revenue * (total_vol_gprs_4g/total_vol_gprs)) IS NULL THEN 1 else 0 end)"

    rev_arpu_total_days_2g_3g_data_0_rev: "case when (total_net_tariff_gprs_revenue * (total_vol_gprs_2g_3g/total_vol_gprs))
      = 0 OR (total_net_tariff_gprs_revenue * (total_vol_gprs_2g_3g/total_vol_gprs)) IS NULL THEN 1 else 0 end)"

    rev_arpu_total_days_4g_data_pkg_0_rev: "case when (total_net_tariff_gprs_package * (total_vol_gprs_4g/total_vol_gprs))
      = 0 OR (total_net_tariff_gprs_package * (total_vol_gprs_4g/total_vol_gprs)) IS NULL THEN 1 else 0 end)"

    rev_arpu_total_days_2g_3g_data_pkg_0_rev: "case when (total_net_tariff_gprs_package * (total_vol_gprs_2g_3g/total_vol_gprs))
      = 0 OR (total_net_tariff_gprs_package * (total_vol_gprs_2g_3g/total_vol_gprs)) IS NULL THEN 1 else 0 end)"

    rev_arpu_total_days_4g_data_ppu_0_rev: "case when (total_net_tariff_gprs_exc_package * (total_vol_gprs_4g/total_vol_gprs))
                = 0 OR (total_net_tariff_gprs_exc_package * (total_vol_gprs_4g/total_vol_gprs)) IS NULL THEN 1 else 0 end)"

    rev_arpu_total_days_2g_3g_data_ppu_0_rev: "case when (total_net_tariff_gprs_exc_package * (total_vol_gprs_2g_3g/total_vol_gprs))
      = 0 OR (total_net_tariff_gprs_exc_package * (total_vol_gprs_2g_3g/total_vol_gprs)) IS NULL THEN 1 else 0 end)"

    rev_arpu_total_days_voice_0_rev: "case when total_net_tariff_revenue_basic = 0 OR
      total_net_tariff_revenue is NULL THEN 1 ELSE 0 END"

    rev_arpu_total_days_voice_intra_0_rev: "case when total_net_tariff_basic_intra = 0 OR
    total_net_tariff_basic_intra is NULL THEN 1 ELSE 0 END)"

    rev_arpu_total_days_voice_non_intra_0_rev: "case when total_net_tariff_basic_non_intra = 0 OR
   total_net_tariff_basic_non_intra is NULL THEN 1 ELSE 0 END)"

    rev_arpu_total_days_voice_per_call_0_rev: "case when total_net_tariff_revenue_basic/total_call = 0 OR
      total_net_tariff_revenue_basic/total_call is NULL THEN 1 ELSE 0 END"

    rev_arpu_total_days_voice_intra_per_call_0_rev: "case when total_net_tariff_basic_intra/total_call = 0 OR
    total_net_tariff_basic_intra/total_call is NULL THEN 1 ELSE 0 END)"

    rev_arpu_total_days_voice_non_intra_per_call_0_rev: "case when total_net_tariff_basic_non_intra/total_call = 0 OR
   total_net_tariff_basic_non_intra/total_call is NULL THEN 1 ELSE 0 END)"

    rev_arpu_total_days_voice_per_min_0_rev: "case when total_net_tariff_revenue_basic/total_minute = 0 OR
      total_net_tariff_revenue_basic/total_minute is NULL THEN 1 ELSE 0 END"

    rev_arpu_total_days_voice_intra_per_min_0_rev: "case when total_net_tariff_basic_intra/total_minute = 0 OR
    total_net_tariff_basic_intra/total_minute is NULL THEN 1 ELSE 0 END)"

    rev_arpu_total_days_voice_non_intra_per_min_0_rev: "case when total_net_tariff_basic_non_intra/total_minute = 0 OR
   total_net_tariff_basic_non_intra/total_minute is NULL THEN 1 ELSE 0 END)"

    rev_arpu_last_date_on_top_package: "case when lower(has_ontop_gprs_yn) = 'y' then date(day_id) else NULL end"

  granularity: "access_method_num, register_date, day_id"
  event_date_column: "date(day_id)"