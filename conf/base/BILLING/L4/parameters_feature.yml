l4_billing_topup_and_volume:
  partition_by: ["access_method_num","register_date"]
  feature_list:
    sum: ["top_ups","top_up_volume"]
    avg: ["top_ups_avg","top_up_volume_avg"]
  read_from: "l2"

l4_billing_rpu:
  partition_by: ["access_method_num","register_date","crm_sub_id"]
  feature_list:
    sum: ["rpu","rpu_gprs","rpu_vas","rpu_voice"]
    avg: ["rpu","rpu_gprs","rpu_vas","rpu_voice"]
  read_from: "l3"

l4_billing_rpu_roaming:
  partition_by: ["access_method_number","mobile_register_date","crm_sub_id"]
  feature_list:
    sum: ["rpu_roaming"]
    avg: ["rpu_roaming_avg"]
  read_from: "l2"

l4_billing_time_diff_bw_topups:
  partition_by: ["access_method_num","register_date"]
  feature_list:
    sum: ["time_diff"]
    avg: ["time_diff_avg"]
  read_from: "l2"

l4_billing_before_top_up_balance:
  partition_by: ["access_method_num","account_id"]
  feature_list:
    sum: ["before_top_up_balance"]
    avg: ["before_top_up_balance"]
  read_from: "l2"

l4_billing_top_up_channels:
  partition_by: ["access_method_num","register_date"]
  feature_list:
    sum: ["top_ups_by_bank_atm_cdm","top_up_vol_by_bank_atm_cdm","top_ups_by_cash_card","top_up_vol_by_cash_card",
          "top_ups_by_digital_online_self_service","top_up_vol_by_digital_online_self_service","top_ups_by_epin_slip",
          "top_up_vol_by_epin_slip","top_ups_by_epos","top_up_vol_by_epos","top_ups_by_rom","top_up_vol_by_rom"]
    avg: ["top_ups_avg_by_bank_atm_cdm","top_up_vol_avg_by_bank_atm_cdm","top_ups_avg_by_cash_card","top_up_vol_avg_by_cash_card",
          "top_ups_avg_by_digital_online_self_service","top_up_vol_avg_by_digital_online_self_service","top_ups_avg_by_epin_slip",
          "top_up_vol_avg_by_epin_slip","top_ups_avg_by_epos","top_up_vol_avg_by_epos","top_ups_avg_by_rom","top_up_vol_avg_by_rom"]
  read_from: "l2"

l4_payments_bill_volume:
  partition_by: ["account_identifier"]
  feature_list:
    sum: ["bill_volume"]
    avg: ["bill_volume"]
  read_from: "l3"