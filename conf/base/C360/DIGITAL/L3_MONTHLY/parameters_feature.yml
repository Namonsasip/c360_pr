
l3_digital_cxenxse_user_profile_monthly:
  where_clause: ""
  feature_list:
    digital_nummber_of_device_brands: "sum(case WHEN groups = 'device-brand' AND lower(item) IS NOT NULL
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_apple: "max(case WHEN groups = 'device-brand' AND lower(item) = 'apple'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_samsung: "max(case WHEN groups = 'device-brand' AND lower(item) = 'samsung'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_huwaei: "max(case WHEN groups = 'device-brand' AND lower(item) = 'huawei'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_oppo: "max(case WHEN groups = 'device-brand' AND lower(item) = 'oppo'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_ais: "max(case WHEN groups = 'device-brand' AND lower(item) = 'ais'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_dtac: "max(case WHEN groups = 'device-brand' AND lower(item) = 'dtac'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_true: "max(case WHEN groups = 'device-brand' AND lower(item) = 'true'
                                       THEN 1 ELSE 0 END)"
    digital_nummber_of_distinct_device_type: "count(Distinct device_type)"

    digital_is_device_mobile: "max(case WHEN lower(device_type) = 'mobile' THEN 1 ELSE 0 END)"

    digital_is_device_tablet: "max(case WHEN lower(device_type) = 'tablet' THEN 1 ELSE 0 END)"

    digital_is_device_desktop: "max(case WHEN lower(device_type) = 'desktop' THEN 1 ELSE 0 END)"

    digital_is_ais_mpay_used: "max(case WHEN groups = 'ais-app-mpay' AND lower(item) = 'y' THEN 1 ELSE 0 END)"

    digital_is_my_ais_app_used: "max(case WHEN groups = 'ais-app-myais' AND lower(item) = 'y' THEN 1 ELSE 0 END)"

    digital_is_serenade: "max(case WHEN groups = 'ais-serenade-flag' AND lower(item) = 'y' THEN 1 ELSE 0 END)"

  granularity: "access_method_num,start_of_month"

l3_digital_cxenxse_site_traffic_monthly:
  where_clause: ""
  feature_list:
    digital_site_traffic_browser_rank: "row_number() over (partition by user_id, browser, start_of_month
                                                                                    order by count(browser) desc)"
    digital_site_traffic_active_time_per_browser: "sum(activetime)"
  granularity: "user_id,browser,start_of_month"

l3_digital_cxenxse_site_traffic_monthly_top_3:
  where_clause: "where digital_site_traffic_browser_rank <= 3"
    feature_list:
      userid: userid
      browser_rank: digital_site_traffic_browser_rank
      site_traffic_browser: site_traffic_browser
      digital_site_traffic_active_time_per_browser: digital_site_traffic_active_time_per_browser
    granularity: ""

