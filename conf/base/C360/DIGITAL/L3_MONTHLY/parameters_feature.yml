
l3_digital_cxenxse_user_profile_monthly:
  where_clause: ""
  feature_list:
    digital_number_of_device_brands: "count(device_brand)"
    digital_number_of_distinct_device_brands: "count(Distinct device_brand)"
    digital_is_device_brands_apple: "max(case WHEN groups = 'device-brand' AND lower(item) = 'apple'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_samsung: "max(case WHEN groups = 'device-brand' AND lower(item) = 'samsung'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_huwaei: "max(case WHEN groups = 'device-brand' AND lower(item) = 'huawei'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_oppo: "max(case WHEN groups = 'device-brand' AND lower(item) = 'oppo'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_ais: "max(case WHEN groups = 'device-brand' AND lower(item) = 'ais'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_dtac: "max(case WHEN groups = 'device-brand' AND lower(item) = 'dtac'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_true: "max(case WHEN groups = 'device-brand' AND lower(item) = 'true'
                                       THEN 1 ELSE 0 END)"
    digital_number_of_distinct_device_type: "count(Distinct device_type)"
    digital_number_of_device_type: "count(device_type)"

    digital_is_device_mobile: "max(case WHEN lower(device_type) = 'mobile' THEN 1 ELSE 0 END)"

    digital_is_device_tablet: "max(case WHEN lower(device_type) = 'tablet' THEN 1 ELSE 0 END)"

    digital_is_device_desktop: "max(case WHEN lower(device_type) = 'desktop' THEN 1 ELSE 0 END)"

    digital_is_ais_mpay_used: "max(case WHEN groups = 'ais-app-mpay' AND lower(item) = 'y' THEN 1 ELSE 0 END)"

    digital_is_my_ais_app_used: "max(case WHEN groups = 'ais-app-myais' AND lower(item) = 'y' THEN 1 ELSE 0 END)"

  granularity: "subscription_identifier, start_of_month"

l3_soc_app_monthly_stats:
  feature_list:
    soc_app_monthly_all_download_traffic: "sum(fea_soc_app_total_download_traffic_total)"
    soc_app_monthly_all_visit_counts: "sum(fea_soc_app_total_frequency_access_total)"
    soc_app_monthly_all_duration: "sum(fea_soc_app_total_visit_duration)"
  granularity: "subscription_identifier,mobile_no,start_of_month"

l3_digital_app_monthly_feature_pipeline:
  feature_list:
    digital_mobile_app_category_agg_total_visit_counts: "sum(digital_mobile_app_category_agg_total_visit_count)"
    digital_mobile_app_category_agg_total_visit_duration: "sum(digital_mobile_app_category_agg_total_visit_duration)"
    digital_mobile_app_category_agg_total_volume_byte: "sum(digital_mobile_app_category_agg_)"
    digital_mobile_app_category_agg_total_download_byte: "sum(digital_mobile_app_category_agg_total_download_byte)"
    digital_mobile_app_category_agg_total_upload_byte: "sum(digital_mobile_app_category_agg_total_upload_byte)"
  granularliry: "subscription_identifier,mobile_no,category_name,priority"

l3_digital_mobile_app_agg_category_timeband:
  where_clause: ""
  feature_list:
    total_visit_count  : "sum(total_visit_count)"
    total_visit_duration : "sum(total_visit_duration)"
    total_volumn_byte : "sum(total_volumn_byte+ul_byte)"
    total_download_byte : "sum(total_download_byte)"
    total_upload_byte : "sum(total_upload_byte)"
  granularity: "mobile_no,category_name,start_of_month,priority"
