
l3_digital_cxenxse_user_profile_monthly:
  where_clause: ""
  feature_list:
    digital_nummber_of_device_brands: "sum(case WHEN profile_group = 'device-brand' AND lower(profile_value) IS NOT NULL
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_apple: "max(case WHEN profile_group = 'device-brand' AND lower(profile_value) = 'apple'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_samsung: "max(case WHEN profile_group = 'device-brand' AND lower(profile_value) = 'samsung'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_huwaei: "max(case WHEN profile_group = 'device-brand' AND lower(profile_value) = 'huwaei'
                                       THEN 1 ELSE 0 END)"
    digital_is_device_brands_oppo: "max(case WHEN profile_group = 'device-brand' AND lower(profile_value) = 'oppo'
                                       THEN 1 ELSE 0 END)"
    digital_nummber_of_distinct_device_type: "count(Distinct device_type)"

    digital_is_device_mobile: "max(case WHEN lower(device_type) = 'mobile' THEN 1 ELSE 0 END)"

    digital_is_device_tablet: "max(case WHEN lower(device_type) = 'tablet' THEN 1 ELSE 0 END)"

    digital_is_device_pc: "max(case WHEN lower(device_type) = 'pc' THEN 1 ELSE 0 END)"

    digital_is_device_phablet: "max(case WHEN lower(device_type) = 'phablet' THEN 1 ELSE 0 END)"

    digital_is_ais_mpay_used: "max(case WHEN profile_group = 'ais-app-mpay' AND lower(profile_value) = 'y'
                                                                     THEN 1 ELSE 0 END)"

    digital_is_my_ais_app_used: "max(case WHEN profile_group = 'ais-app-myais' AND lower(profile_value) = 'y'
                                                                     THEN 1 ELSE 0 END)"

    digital_is_serenade: "max(case WHEN profile_group = 'ais-serenade-flag' AND lower(profile_value) = 'y'
                                                                     THEN 1 ELSE 0 END)"

  granularity: "access_method_num,start_of_month"
