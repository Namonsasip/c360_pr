# Digital active time per browser
l1_digital_cxenxse_site_traffic_daily:
  where_clause: ""
  feature_list:
    digital_time_spent_browser_chrome: "sum(CASE WHEN lower(browser) = 'chrome' THEN activetime ELSE 0 END)"
    digital_time_spent_browser_safari: "sum(CASE WHEN lower(browser) = 'safari' THEN activetime ELSE 0 END)"
    digital_time_spent_browser_line: "sum(CASE WHEN lower(browser) = 'line' THEN activetime ELSE 0 END)"
    digital_time_spent_browser_opera: "sum(CASE WHEN lower(browser) = 'opera' THEN activetime ELSE 0 END)"
    digital_time_spent_referrersocialnetwork_facebook: "sum(CASE WHEN lower(referrersocialnetwork) = 'facebook'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrerhostclass_social:  "sum(CASE WHEN lower(referrerhostclass) = 'social' THEN
    activetime ELSE 0 END)"
    digital_time_spent_referrerhostclass_other: "sum(CASE WHEN lower(referrerhostclass) = 'other'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrerhostclass_direct: "sum(CASE WHEN lower(referrerhostclass) = 'direct'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrerhostclass_internal: "sum(CASE WHEN lower(referrerhostclass) = 'internal'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrersearch_engine_internal: "sum(CASE WHEN lower(referrersearchengine) = 'internal'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrersearch_engine_other: "sum(CASE WHEN lower(referrersearchengine) = 'other'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrersearch_engine_google: "sum(CASE WHEN lower(referrersearchengine) = 'google'
                                                        THEN activetime ELSE 0 END)"

    digital_is_explorer: "max(CASE WHEN digital_is_explorer = 1 THEN 1 ELSE 0 END)"

    digital_is_serenade: "max(digital_is_serenade)"

  granularity: "subscription_identifier, access_method_num, event_partition_date, start_of_week, start_of_month"

l1_digital_cxenxse_site_traffic_popular_host_daily:
  where_clause: ""
  feature_list:
    digital_popular_host: "sum(activetime)"
  granularity: "subscription_identifier, access_method_num, host, event_partition_date, start_of_week, start_of_month"

l1_digital_cxenxse_site_traffic_popular_postalcode_daily:
  where_clause: ""
  feature_list:
    digital_popular_postalcode: "count(subscription_identifier)"
  granularity: "subscription_identifier, access_method_num, postalcode, event_partition_date, start_of_week,
   start_of_month"

l1_digital_cxenxse_site_traffic_popular_referrerquery_daily:
  where_clause: ""
  feature_list:
    digital_popular_referrerquery: "count(subscription_identifier)"
  granularity: "subscription_identifier, access_method_num, referrerquery, event_partition_date, start_of_week,
   start_of_month"

l1_digital_cxenxse_site_traffic_popular_referrerhost_daily:
  where_clause: ""
  feature_list:
    digital_popular_referrerhost: "count(subscription_identifier)"
  granularity: "subscription_identifier, access_method_num, referrerhost, event_partition_date, start_of_week,
   start_of_month"

l1_digital_catecory_level_lv1:
  level : "category_level_1"
l1_digital_catecory_level_lv2:
  level : "category_level_2"
l1_digital_catecory_level_lv3:
  level : "category_level_3"
l1_digital_catecory_level_lv4:
  level : "category_level_4"

l1_digital_mobile_app_agg_category_daily:
  where_clause: ""
  feature_list:
    total_visit_count  : "sum(count_trans)"
    total_visit_duration : "sum(duration)"
    total_volumn_byte : "sum(total_byte)"
    total_download_byte : "sum(download_byte)"
    total_upload_byte : "sum(upload_byte)"
  granularity: "subscription_identifier,mobile_no,category_name,event_partition_date,priority"

l1_digital_mobile_web_agg_category_daily:
  where_clause: ""
  feature_list:
    total_visit_count  : "sum(trans)"
    total_visit_duration : "sum(duration)"
    total_volumn_byte : "sum(total_byte)"
    total_download_byte : "sum(download_byte)"
    total_upload_byte : "sum(upload_byte)"
  granularity: "subscription_identifier,mobile_no,category_name,event_partition_date,priority"

l1_digital_mobile_web_agg_category_timebrand:
  where_clause: ""
  feature_list:
    total_volumn_byte : "sum(upload_byte)+sum(download_byte)"
  granularity: "subscription_identifier,mobile_no,category_name,event_partition_date,priority"

##########################################################
l1_soc_web_daily_agg_features:
    feature_list:
        total_download_kb: "sum(total_download_kb)"
        total_duration: "sum(total_duration)"
        fea_soc_web_total_download_traffic_afternoon: "sum(total_soc_web_download_traffic_afternoon)"
        total_visit_counts_afternoon: "sum(total_visit_counts_afternoon)"
        total_visit_duration_afternoon: "sum(total_visit_duration_afternoon)"
    granularity: "mobile_no,partition_date,level_1"

l1_soc_web_daily_ratio_based_features:
    feature_list:
        mobile_no: "mobile_no"
        partition_date: "partition_date"
        level_1: "level_1"
        fea_soc_web_total_download_kb: "total_download_kb"
        fea_soc_web_total_download_traffic_afternoon: "fea_soc_web_total_download_traffic_afternoon"
        total_visit_counts_afternoon: "total_visit_counts_afternoon"
        total_visit_duration_afternoon: "total_visit_duration_afternoon"
        fea_soc_web_category_weight_by_download_traffic: "round(total_download_kb/total_soc_web_daily_download_traffic, 2)"
        fea_soc_web_share_afternoon_download_traffic: "round(fea_soc_web_total_download_traffic_afternoon/total_download_kb, 2)"
    granularity: ""

# SOC web daily favourites

l1_soc_web_daily_popular_domain_by_download_volume:
  feature_list:
    mobile_no: "mobile_no"
    partition_date: "partition_date"
    level_1: "level_1"
    url: "url"
    rank: "row_number() over(partition by mobile_no,
                      partition_date,level_1
                      order by total_download_kb desc,priority asc,url asc)"
  granularity: ""

l1_soc_web_daily_most_popular_domain_by_download_volume:
  where_clause: "where rank = 1"
  feature_list:
    mobile_no: "mobile_no"
    partition_date: "partition_date"
    level_1: level_1
    fea_soc_web_favourite_domain_by_download_volume: "url"
  granularity: ""

l1_soc_web_daily_popular_category_by_download_volume:
  feature_list:
    total_download_volume_by_category: "sum(total_download_kb)"
    rank: "row_number() over(partition by mobile_no,
                      partition_date
                      order by sum(total_download_kb) desc,priority asc)"
  granularity: "mobile_no,partition_date,level_1,priority"

l1_soc_web_daily_most_popular_category_by_download_volume:
  where_clause: "where rank = 1"
  feature_list:
    mobile_no: "mobile_no"
    partition_date: "partition_date"
    fea_soc_web_favourite_category_by_download_volume: "level_1"
  granularity: ""

l1_relay_daily_total_pageviews_visits_count:
  where_clause: ""
  feature_list:
    fea_relay_total_pageviews_visits_count: "count(*)"
  granularity: "subscription_identifier,partition_date,mobile_no"