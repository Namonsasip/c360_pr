# Digital active time per browser
l1_digital_cxenxse_site_traffic_daily:
  where_clause: ""
  feature_list:
    digital_time_spent_browser_chrome: "sum(CASE WHEN lower(browser) = 'chrome' THEN activetime ELSE 0 END)"
    digital_time_spent_browser_safari: "sum(CASE WHEN lower(browser) = 'safari' THEN activetime ELSE 0 END)"
    digital_time_spent_browser_line: "sum(CASE WHEN lower(browser) = 'line' THEN activetime ELSE 0 END)"
    digital_time_spent_browser_opera: "sum(CASE WHEN lower(browser) = 'opera' THEN activetime ELSE 0 END)"
    digital_time_spent_referrersocialnetwork_facebook: "sum(CASE WHEN lower(referrersocialnetwork) = 'facebook'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrerhostclass_social:  "sum(CASE WHEN lower(referrerhostclass) = 'social' THEN
    activetime ELSE 0 END)"
    digital_time_spent_referrerhostclass_other: "sum(CASE WHEN lower(referrerhostclass) = 'other'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrerhostclass_direct: "sum(CASE WHEN lower(referrerhostclass) = 'direct'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrerhostclass_internal: "sum(CASE WHEN lower(referrerhostclass) = 'internal'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrersearch_engine_internal: "sum(CASE WHEN lower(referrersearchengine) = 'internal'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrersearch_engine_other: "sum(CASE WHEN lower(referrersearchengine) = 'other'
                                                        THEN activetime ELSE 0 END)"
    digital_time_spent_referrersearch_engine_google: "sum(CASE WHEN lower(referrersearchengine) = 'google'
                                                        THEN activetime ELSE 0 END)"

    digital_is_explorer: "max(CASE WHEN digital_is_explorer = 1 THEN 1 ELSE 0 END)"

    digital_is_serenade: "max(digital_is_serenade)"

  granularity: "subscription_identifier, access_method_num, event_partition_date, start_of_week, start_of_month"

l1_digital_cxenxse_site_traffic_popular_host_daily:
  where_clause: ""
  feature_list:
    digital_popular_host: "sum(activetime)"
  granularity: "subscription_identifier, access_method_num, host, event_partition_date, start_of_week, start_of_month"

l1_digital_cxenxse_site_traffic_popular_postalcode_daily:
  where_clause: ""
  feature_list:
    digital_popular_postalcode: "count(subscription_identifier)"
  granularity: "subscription_identifier, access_method_num, postalcode, event_partition_date, start_of_week,
   start_of_month"

l1_digital_cxenxse_site_traffic_popular_referrerquery_daily:
  where_clause: ""
  feature_list:
    digital_popular_referrerquery: "count(subscription_identifier)"
  granularity: "subscription_identifier, access_method_num, referrerquery, event_partition_date, start_of_week,
   start_of_month"

l1_digital_cxenxse_site_traffic_popular_referrerhost_daily:
  where_clause: ""
  feature_list:
    digital_popular_referrerhost: "count(subscription_identifier)"
  granularity: "subscription_identifier, access_method_num, referrerhost, event_partition_date, start_of_week,
   start_of_month"

l1_digital_catecory_level_lv1:
  level : "category_level_1"
l1_digital_catecory_level_lv2:
  level : "category_level_2"
l1_digital_catecory_level_lv3:
  level : "category_level_3"
l1_digital_catecory_level_lv4:
  level : "category_level_4"

l1_digital_mobile_app_agg_category_daily:
  where_clause: ""
  feature_list:
    total_visit_count  : "sum(count_trans)"
    total_visit_duration : "sum(duration)"
    total_volumn_byte : "sum(total_byte)"
    total_download_byte : "sum(download_byte)"
    total_upload_byte : "sum(upload_byte)"
  granularity: "subscription_identifier,mobile_no,category_name,event_partition_date,priority"

l1_digital_mobile_web_agg_category_daily:
  where_clause: ""
  feature_list:
    total_visit_count  : "sum(trans)"
    total_visit_duration : "sum(duration)"
    total_volumn_byte : "sum(total_byte)"
    total_download_byte : "sum(download_byte)"
    total_upload_byte : "sum(upload_byte)"
  granularity: "subscription_identifier,mobile_no,category_name,event_partition_date,priority"

#l1_digital_relay_engagement_pageview_count_visit_by_cid:
#  where_clause: ""
#  feature_list:
#    total_visit_count: "count(campaign_id)"
#  granularity: "subscription_identifier,mobile_no,event_partition_date,campaign_id"

l1_digital_relay_engagement_pageviews_count_visit:
  where_clause: ""
  feature_list:
    total_visit_count: "count(*)"
  granularity: "subscription_identifier,mobile_no,event_partition_date"

l1_digital_relay_engagement_conversion_count_visit_by_cid:
  where_clause: ""
  feature_list:
    total_conversion_product_count: "count(campaign_id)"
  granularity: "subscription_identifier,mobile_no,event_partition_date,campaign_id"

l1_digital_relay_engagement_conversion_package_count_visit_by_cid:
  where_clause: ""
  feature_list:
    total_conversion_package_count: "count(campaign_id)"
  granularity: "subscription_identifier,mobile_no,event_partition_date,campaign_id"
