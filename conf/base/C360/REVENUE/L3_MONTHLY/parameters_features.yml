# Config file for query generator
l3_revenue_postpaid_ru_f_sum_revenue_by_service_monthly:
  where_clause: ""
  feature_list:
    rev_arpu_total_revenue: "sum(total_net_revenue)"
    rev_arpu_total_gprs_net_revenue: "sum(total_gprs_net_revenue)"
    rev_arpu_total_vas_net_revenue: "sum(total_vas_net_revenue)"
    rev_arpu_total_sms_net_revenue: "sum(total_sms_net_revenue)"
    rev_arpu_total_others_net_revenue: "sum(total_others_net_revenue)"
    rev_arpu_total_voice_net_revenue: "sum(total_voice_net_revenue)"
    rev_arpu_total_mms_net_revenue: "sum(total_mms_net_revenue)"
    rev_arpu_total_ir_net_revenue: "sum(total_ir_net_revenue)"
    rev_arpu_total_idd_net_revenue: "sum(total_idd_net_revenue)"
    rev_arpu_total_voice_net_tariff_rev_mth: "sum(total_voice_net_tariff_rev_mth)"
    rev_arpu_total_vas_net_tariff_rev_mth: "sum(total_vas_net_tariff_rev_mth)"
    rev_arpu_total_gprs_net_tariff_rev_mth: "sum(total_gprs_net_tariff_rev_mth)"
    rev_arpu_total_sms_net_tariff_rev_mth: "sum(total_sms_net_tariff_rev_mth)"
    rev_arpu_total_mms_net_tariff_rev_mth: "sum(total_mms_net_tariff_rev_mth)"
    rev_arpu_total_others_net_tariff_rev_mth: "sum(total_others_net_tariff_rev_mth)"
    rev_arpu_total_ir_net_tariff_rev_mth: "sum(total_ir_net_tariff_rev_mth)"
    rev_arpu_total_idd_net_tariff_rev_mth: "sum(total_idd_net_tariff_rev_mth)"
    rev_arpu_total_voice_net_tariff_rev_ppu: "sum(total_voice_net_tariff_rev_ppu)"
    rev_arpu_total_vas_net_tariff_rev_ppu: "sum(total_vas_net_tariff_rev_ppu)"
    rev_arpu_total_gprs_net_tariff_rev_ppu: "sum(total_gprs_net_tariff_rev_ppu)"
    rev_arpu_total_sms_net_tariff_rev_ppu: "sum(total_sms_net_tariff_rev_ppu)"
    rev_arpu_total_mms_net_tariff_rev_ppu: "sum(total_mms_net_tariff_rev_ppu)"
    rev_arpu_total_others_net_tariff_rev_ppu: "sum(total_others_net_tariff_rev_ppu)"
    rev_arpu_total_ir_net_tariff_rev_ppu: "sum(total_ir_net_tariff_rev_ppu)"
    rev_arpu_total_idd_net_tariff_rev_ppu: "sum(total_idd_net_tariff_rev_ppu)"
  granularity: "sub_id, mgt_mth_id"
  event_date_column: "date(mgt_mth_id)"

l3_revenue_prepaid_ru_f_sum_revenue_by_service_monthly:
  where_clause: ""
  feature_list:
    rev_arpu_total_revenue: "sum(total_net_revenue_af)"
    rev_arpu_total_gprs_net_revenue: "sum(total_gprs_net_revenue_af)"
    rev_arpu_total_vas_net_revenue: "sum(total_sms_net_revenue_af+
                                     total_mms_net_revenue_af+
                                     total_gprs_net_revenue_af+
                                     total_kkbox_net_revenue_af+
                                     total_VDO_net_revenue_af+
                                     total_others_net_revenue_af)"
    rev_arpu_total_sms_net_revenue: "sum(total_sms_net_revenue_af)"
    rev_arpu_total_others_net_revenue: "sum(total_others_net_revenue_af)"
    rev_arpu_total_voice_net_revenue: "sum(total_voice_net_revenue_af)"
    rev_arpu_total_mms_net_revenue: "sum(total_mms_net_revenue_af)"
    rev_arpu_total_ir_net_revenue: "sum(total_ir_net_revenue_af)"
    rev_arpu_total_idd_net_revenue: "sum(total_idd_net_revenue_af)"
    rev_arpu_total_voice_net_tariff_rev_mth: "sum(total_voice_net_tariff_rev_mth_af)"
    rev_arpu_total_gprs_net_tariff_rev_mth: "sum(total_gprs_net_tariff_rev_mth_af)"
    rev_arpu_total_sms_net_tariff_rev_mth: "sum(total_sms_net_tariff_rev_mth_af)"
    rev_arpu_total_mms_net_tariff_rev_mth: "sum(total_mms_net_tariff_rev_mth_af)"
    rev_arpu_total_others_net_tariff_rev_mth: "sum(total_others_net_tariff_rev_mth_af)"
    rev_arpu_total_voice_net_tariff_rev_ppu: "sum(total_voice_net_tariff_rev_ppu_af)"
    rev_arpu_total_gprs_net_tariff_rev_ppu: "sum(total_gprs_net_tariff_rev_ppu_af)"
    rev_arpu_total_sms_net_tariff_rev_ppu: "sum(total_sms_net_tariff_rev_ppu_af)"
    rev_arpu_total_mms_net_tariff_rev_ppu: "sum(total_mms_net_tariff_rev_ppu_af)"
    rev_arpu_total_others_net_tariff_rev_ppu: "sum(total_others_net_tariff_rev_ppu_af)"
    rev_arpu_total_ir_net_tariff_rev_ppu: "sum(total_ir_net_revenue_af)"
    rev_arpu_total_idd_net_tariff_rev_ppu: "sum(total_idd_net_revenue_af)"
  granularity: "c360_subscription_identifier, month_id"
  event_date_column: "date(month_id)"

################################ feature add norm ################################ 2021-05-17
l3_revenue_features_postpaid_ru_f_sum_revenue_by_service_monthly_revenue:
  where_clause: ""
  feature_list:
    total_net_revenue: "sum(total_net_revenue)"
    total_net_revenue_voice: "sum(total_voice_net_revenue)"
    total_net_revenue_data: "sum(total_gprs_net_revenue)"
    total_net_revenue_sms: "sum(total_sms_net_revenue)"
    total_net_revenue_mms: "sum(total_mms_net_revenue)"
    total_net_revenue_others: "sum(total_others_net_revenue)"
    total_net_revenue_vas: "sum(total_vas_net_revenue)"
    total_net_revenue_ir: "sum(total_ir_net_revenue)"
    total_net_revenue_idd: "sum(total_idd_net_revenue)"
    total_revenue_voice_package: "sum(total_voice_net_tariff_rev_mth)"
    total_revenue_data_package: "sum(total_gprs_net_tariff_rev_mth)"
    total_revenue_sms_package: "sum(total_sms_net_tariff_rev_mth)"
    total_revenue_mms_package: "sum(total_mms_net_tariff_rev_mth)"
    total_revenue_others_package: "sum(total_others_net_tariff_rev_mth)"
    total_revenue_vas_package: "sum(total_vas_net_tariff_rev_mth)"
    total_revenue_voice_ppu: "sum(total_voice_net_tariff_rev_ppu)"
    total_revenue_data_ppu: "sum(total_gprs_net_tariff_rev_ppu)"
    total_revenue_sms_ppu: "sum(total_sms_net_tariff_rev_ppu)"
    total_revenue_mms_ppu: "sum(total_mms_net_tariff_rev_ppu)"
    total_revenue_others_ppu: "sum(total_others_net_tariff_rev_ppu)"
    total_revenue_vas_ppu: "sum(total_vas_net_tariff_rev_ppu)"
    norms_net_revenue: "sum(norms_total_net_revenue)"
    norms_net_revenue_voice: "sum(norms_voice_net_revenue)"
    norms_net_revenue_data: "sum(norms_gprs_net_revenue)"
    norms_net_revenue_sms: "sum(norms_sms_net_revenue)"
    norms_net_revenue_mms: "sum(norms_mms_net_revenue)"
    norms_net_revenue_others: "sum(norms_others_net_revenue)"
    norms_net_revenue_vas: "sum(norms_vas_net_revenue)"
    norms_revenue_voice_ppu: "sum(norms_voice_net_tariff_rev_ppu)"
    norms_revenue_data_ppu: "sum(norms_gprs_net_tariff_rev_ppu)"
    norms_revenue_sms_ppu: "sum(norms_sms_net_tariff_rev_ppu)"
    norms_revenue_mms_ppu: "sum(norms_mms_net_tariff_rev_ppu)"
    norms_revenue_others_ppu: "sum(norms_others_net_tariff_rev_ppu)"
    norms_revenue_vas_ppu: "sum(norms_vas_net_tariff_rev_ppu)"
    service_type: "'POSTPAID'"
  granularity: "mgt_mth_id, sub_id"
  event_date_column: "date(mgt_mth_id)"


l3_revenue_features_prepaid_pru_f_revenue_allocate_usage_monthly_revenue:
  where_clause: ""
  feature_list:
    total_revenue_voice_package: "sum(coalesce(total_voice_net_tariff_rev_mth_af,0)/1.07)"
    total_revenue_data_package: "sum(coalesce(total_gprs_net_tariff_rev_mth_af,0)/1.07)"
    total_revenue_sms_package: "sum(coalesce(total_sms_net_tariff_rev_mth_af,0)/1.07)"
    total_revenue_mms_package: "sum(coalesce(total_mms_net_tariff_rev_mth_af,0)/1.07)"
    total_revenue_others_package: "sum((coalesce(total_others_net_tariff_rev_mth_af,0) +
                                    coalesce(total_kkbox_net_tariff_rev_mth_af,0) +
                                    coalesce(total_vdo_net_tariff_rev_mth_af,0))/1.07)"
    total_revenue_vas_package: "sum((coalesce(total_gprs_net_tariff_rev_mth_af,0) +
                                coalesce(total_sms_net_tariff_rev_mth_af,0) +
                                coalesce(total_mms_net_tariff_rev_mth_af,0) +
                                coalesce(total_others_net_tariff_rev_mth_af,0) +
                                coalesce(total_kkbox_net_tariff_rev_mth_af,0) +
                                coalesce(total_vdo_net_tariff_rev_mth_af,0))/1.07)"
    total_revenue_voice_ppu: "sum(coalesce(total_voice_net_tariff_rev_ppu_af,0)/1.07)"
    total_revenue_data_ppu: "sum(coalesce(total_gprs_net_tariff_rev_ppu_af,0)/1.07)"
    total_revenue_sms_ppu: "sum(coalesce(total_sms_net_tariff_rev_ppu_af,0)/1.07)"
    total_revenue_mms_ppu: "sum(coalesce(total_mms_net_tariff_rev_ppu_af,0)/1.07)"
    total_revenue_others_ppu: "sum(coalesce(total_others_net_tariff_rev_ppu_af,0)/1.07)"
    total_revenue_vas_ppu: "sum((coalesce(total_gprs_net_tariff_rev_ppu_af,0) +
                            coalesce(total_sms_net_tariff_rev_ppu_af,0) +
                            coalesce(total_mms_net_tariff_rev_ppu_af,0) +
                            coalesce(total_others_net_tariff_rev_ppu_af,0))/1.07)"
    norms_net_revenue: "sum(coalesce(norms_total_net_revenue_af,0)/1.07)"
    norms_net_revenue_voice: "sum(coalesce(norms_voice_net_revenue_af,0)/1.07)"
    norms_net_revenue_data: "sum(coalesce(norms_gprs_net_revenue_af,0)/1.07)"
    norms_net_revenue_sms: "sum(coalesce(norms_sms_net_revenue_af,0)/1.07)"
    norms_net_revenue_mms: "sum(coalesce(norms_mms_net_revenue_af,0)/1.07)"
    norms_net_revenue_others: "sum((coalesce(norms_others_net_revenue_af,0) +
                               coalesce(norms_kkbox_net_revenue_af,0) +
                               coalesce(norms_vdo_net_revenue_af,0))/1.07)"
    norms_net_revenue_vas: "sum((coalesce(norms_gprs_net_revenue_af,0) +
                            coalesce(norms_sms_net_revenue_af,0) +
                            coalesce(norms_mms_net_revenue_af,0) +
                            coalesce(norms_others_net_revenue_af,0) +
                            coalesce(norms_kkbox_net_revenue_af,0) +
                            coalesce(norms_vdo_net_revenue_af,0))/1.07)"
    norms_revenue_voice_ppu: "sum(coalesce(norms_voice_net_tariff_rev_ppu_af,0)/1.07)"
    norms_revenue_data_ppu: "sum(coalesce(norms_gprs_net_tariff_rev_ppu_af,0)/1.07)"
    norms_revenue_sms_ppu: "sum(coalesce(norms_sms_net_tariff_rev_ppu_af,0)/1.07)"
    norms_revenue_mms_ppu: "sum(coalesce(norms_mms_net_tariff_rev_ppu_af,0)/1.07)"
    norms_revenue_others_ppu: "sum(coalesce(norms_others_net_tariff_rev_ppu_af,0)/1.07)"
    norms_revenue_vas_ppu: "sum((coalesce(norms_gprs_net_tariff_rev_ppu_af,0) +
                            coalesce(norms_sms_net_tariff_rev_ppu_af,0) +
                            coalesce(norms_mms_net_tariff_rev_ppu_af,0) +
                            coalesce(norms_others_net_tariff_rev_ppu_af,0))/1.07)"
    service_type: "'PREPAID'"
    #total_revenue_data_main_package: "sum(coalesce(total_data_net_tariff_revenue_mth_main_af,0)/vat)"
    #total_revenue_data_ontop_package: "sum(coalesce(total_data_net_tariff_revenue_mth_ontop_af,0)/vat)"
  granularity: "month_id, c360_subscription_identifier"
  event_date_column: "date(month_id)"

l3_revenue_features_postpaid_ru_f_sum_rev_mth_by_promo_class_monthly_package:
   where_clause: ""
   feature_list:
     total_revenue_main_package: "sum(main)"
     total_revenue_voice_main_package: "sum(voice_main)"
     total_revenue_data_main_package: "sum(gprs_main)"
     total_revenue_sms_main_package: "sum(sms_main)"
     total_revenue_mms_main_package: "sum(mms_main)"
     total_revenue_ontop_package: "sum(ontop)"
     total_revenue_voice_ontop_package: "sum(voice_ontop)"
     total_revenue_data_ontop_package: "sum(gprs_ontop)"
     total_revenue_sms_ontop_package: "sum(sms_ontop)"
     total_revenue_mms_ontop_package: "sum(mms_ontop)"
     service_type: "'POSTPAID'"
   granularity: "mgt_mth_id, sub_id"
   event_date_column: "date(mgt_mth_id)"

l3_revenue_features_prepaid_pru_f_active_sub_cross_mao_mao_monthly_usage_ontop:
   where_clause: ""
   feature_list:
     total_revenue_voice_ontop_package: "sum(coalesce(total_amount_mao_mao_voice,0)/vat)"
     service_type: "'PREPAID'"
   granularity: "month_id, register_date, access_method_num, c360_subscription_identifier"
   event_date_column: "date(month_id)"

l3_revenue_features_prepaid_pru_f_active_sub_cross_mao_mao_cross_rev_allocate_usg_monthly:
  where_clause: ""
  feature_list:
    total_revenue_voice_main_package: "sum((coalesce(total_voice_net_tariff_rev_mth_af,0)-coalesce(total_amount_mao_mao_voice,0))/1.07)"
    service_type: "'PREPAID'"
  granularity: "month_id, register_date, access_method_num, subscription_identifier"
  event_date_column: "date(month_id)"

l3_revenue_features_for_prepaid_postpaid_revenue:
  where_clause: ""
  feature_list:
    total_net_revenue: "sum(total_net_revenue)"
    total_net_revenue_voice: "sum(total_net_revenue_voice)"
    total_net_revenue_data: "sum(total_net_revenue_data)"
    total_net_revenue_sms: "sum(total_net_revenue_sms)"
    total_net_revenue_mms: "sum(total_net_revenue_mms)"
    total_net_revenue_others: "sum(total_net_revenue_others)"
    total_net_revenue_vas: "sum(total_net_revenue_vas)"
    total_net_revenue_ir: "sum(total_net_revenue_ir)"
    total_net_revenue_idd: "sum(total_net_revenue_idd)"
    total_revenue_voice_package: "sum(total_revenue_voice_package)"
    total_revenue_data_package: "sum(total_revenue_data_package)"
    total_revenue_sms_package: "sum(total_revenue_sms_package)"
    total_revenue_mms_package: "sum(total_revenue_mms_package)"
    total_revenue_others_package: "sum(total_revenue_others_package)"
    total_revenue_vas_package: "sum(total_revenue_vas_package)"
    total_revenue_voice_ppu: "sum(total_revenue_voice_ppu)"
    total_revenue_data_ppu: "sum(total_revenue_data_ppu)"
    total_revenue_sms_ppu: "sum(total_revenue_sms_ppu)"
    total_revenue_mms_ppu: "sum(total_revenue_mms_ppu)"
    total_revenue_others_ppu: "sum(total_revenue_others_ppu)"
    total_revenue_vas_ppu: "sum(total_revenue_vas_ppu)"
    norms_net_revenue: "sum(norms_net_revenue)"
    norms_net_revenue_voice: "sum(norms_net_revenue_voice)"
    norms_net_revenue_data: "sum(norms_net_revenue_data)"
    norms_net_revenue_sms: "sum(norms_net_revenue_sms)"
    norms_net_revenue_mms: "sum(norms_net_revenue_mms)"
    norms_net_revenue_others: "sum(norms_net_revenue_others)"
    norms_net_revenue_vas: "sum(norms_net_revenue_vas)"
    norms_revenue_voice_ppu: "sum(norms_revenue_voice_ppu)"
    norms_revenue_data_ppu: "sum(norms_revenue_data_ppu)"
    norms_revenue_sms_ppu: "sum(norms_revenue_sms_ppu)"
    norms_revenue_mms_ppu: "sum(norms_revenue_mms_ppu)"
    norms_revenue_others_ppu: "sum(norms_revenue_others_ppu)"
    norms_revenue_vas_ppu: "sum(norms_revenue_vas_ppu)"
  granularity: "month_id, subscription_identifier,service_type"
  event_date_column: "date(month_id)"

l3_revenue_features_prepaid_pru_f_revenue_allocate_usage_monthly_package_main_ontop:
  where_clause: ""
  feature_list:
    total_revenue_data_main_package: "sum(coalesce(total_data_net_tariff_revenue_mth_main_af,0)/1.07)"
    total_revenue_data_ontop_package: "sum(coalesce(total_data_net_tariff_revenue_mth_ontop_af,0)/1.07)"
    service_type: "'PREPAID'"
  granularity: "month_id, c360_subscription_identifier"
  event_date_column: "date(month_id)"

l3_merge_postpaid_revenue_and_prepaid_revenue_pacakage:
  where_clause: ""
  feature_list:
    total_revenue_data_main_package: "sum(coalesce(total_data_net_tariff_revenue_mth_main_af,0)/1.07)"
    total_revenue_data_ontop_package: "sum(coalesce(total_data_net_tariff_revenue_mth_ontop_af,0)/1.07)"
    service_type: "'PREPAID'"
  granularity: "month_id, subscription_identifier,service_type"
  event_date_column: "date(month_id)"

