l3_device_handset_summary_with_configuration:
  where_clause: ""
  feature_list:
    start_of_month: "start_of_month"
    access_method_num: "access_method_num"
    register_date: "register_date"
    subscription_identifier: "subscription_identifier"
    device_last_use_time: "first_value(device_last_use_time) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
      order by start_of_week desc)"
    device_brand_code: "first_value(device_brand_code) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                               order by start_of_week desc)"
    device_model_code: "first_value(device_model_code) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                        order by start_of_week desc)"
    device_brand_name: "first_value(device_brand_name) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                        order by start_of_week desc)"
    device_model_name: "first_value(device_model_name) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                        order by start_of_week desc)"
    device_imei: "first_value(device_imei) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                  order by start_of_week desc)"
    device_type: "first_value(device_type) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                  order by start_of_week desc)"
    device_time_with_current_device_days: "first_value(device_time_with_current_device_days) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                                           order by start_of_week desc)"
    device_SmartPhone: "first_value(device_SmartPhone) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                        order by start_of_week desc)"
    device_StandardPhone: "first_value(device_StandardPhone) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                                                    order by start_of_week desc)"
    device_LegacyPhone: "first_value(device_LegacyPhone) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                         order by start_of_week desc)"
    device_NetBook: "first_value(device_NetBook) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                     order by start_of_week desc)"
    device_Tablet: "first_value(device_Tablet) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                    order by start_of_week desc)"
    device_Phablet: "first_value(device_Phablet) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                            order by start_of_week desc)"
    device_Module: "first_value(device_Module) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                    order by start_of_week desc)"
    device_Handheld: "first_value(device_Handheld) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                             order by start_of_week desc)"
    device_Vehicle: "first_value(device_Vehicle) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                            order by start_of_week desc)"
    device_Air_card_or_dongle: "first_value(device_Air_card_or_dongle) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                             order by start_of_week desc)"
    device_Modem: "first_value(device_Modem) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                order by start_of_week desc)"
    device_WirelessRouter: "first_value(device_WirelessRouter) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                         order by start_of_week desc)"
    device_SmartWatch: "first_value(device_SmartWatch) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                     order by start_of_week desc)"
    device_WatchPhone: "first_value(device_WatchPhone) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                     order by start_of_week desc)"
    device_IotVehicle: "first_value(device_IotVehicle) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                     order by start_of_week desc)"
    device_Unknown: "first_value(device_Unknown) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                  order by start_of_week desc)"
    device_high_range: "first_value(device_high_range) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                                           order by start_of_week desc)"
    device_mid_range: "first_value(device_mid_range) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                                                                   order by start_of_week desc)"
    device_low_range: "first_value(device_low_range) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                                                                                   order by start_of_week desc)"
    device_launch_price: "first_value(device_launch_price) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                 order by start_of_week desc)"
    device_sale_price: "first_value(device_sale_price) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                               order by start_of_week desc)"
    device_supports_umts: "first_value(device_supports_umts) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                  order by start_of_week desc)"
    device_supports_wds: "first_value(device_supports_wds) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                 order by start_of_week desc)"
    is_ais_customer: "first_value(is_ais_customer) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                             order by start_of_week desc)"
    device_supports_dual_sim: "first_value(device_supports_dual_sim) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                      order by start_of_week desc)"
    device_supports_lte: "first_value(device_supports_lte) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                 order by start_of_week desc)"
    devices_uses_both_sim_slot: "first_value(devices_uses_both_sim_slot) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                        order by start_of_week desc)"
    device_supports_hsdpa: "first_value(device_supports_hsdpa) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                   order by start_of_week desc)"
    device_supports_video_call: "first_value(device_supports_video_call) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                        order by start_of_week desc)"
    device_operating_system: "first_value(device_operating_system) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                     order by start_of_week desc)"
    device_supports_gprs: "first_value(device_supports_gprs) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                  order by start_of_week desc)"
    device_supports_google_map: "first_value(device_supports_google_map) over(partition by start_of_month,access_method_num,register_date,subscription_identifier
                                        order by start_of_week desc)"
  granularity: ""

l3_device_number_of_phone_updates:
  where_clause: ""
  feature_list:
    device_number_of_phone_updates: "sum(device_number_of_phone_updates)"
  granularity: "start_of_month,access_method_num,register_date,subscription_identifier"

l3_device_most_used:
  where_clause: ""
  feature_list:
    device_used_days: "count(distinct date_id)"
    device_most_used_handset_samsung: "case when handset_brand_name='SAMSUNG' then 'Y' else 'N' end"
    device_most_used_handset_huawei: "case when handset_brand_name='HUAWEI' then 'Y' else 'N' end"
    device_most_used_handset_oppo: "case when handset_brand_name='OPPO' then 'Y' else 'N' end"
    device_most_used_handset_apple: "case when handset_brand_name='APPLE' then 'Y' else 'N' end"
    device_most_used_handset_xiaomi: "case when handset_brand_name='XIAOMI' then 'Y' else 'N' end"
    device_most_used_handset_others: "case when handset_brand_name not in ('SAMSUNG','HUAWEI','OPPO','APPLE','XIAOMI') then 'Y' else 'N' end"
    rank: "row_number() over(partition by start_of_month,mobile_no,register_date
               order by count(distinct date_id) desc)"
  granularity: "start_of_month,mobile_no,register_date,handset_brand_name"

l3_previous_device_features_with_config_ranked:
  where_clause: ""
  feature_list:
    device_last_use_time: "max(handset_last_use_time)"
    rank: "row_number() over( partition by start_of_month,mobile_no,register_date
                                  order by max(handset_last_use_time) desc)"
  granularity: "start_of_month,mobile_no,register_date,handset_imei,
    handset_brand_code,handset_model_code,handset_brand_name,handset_model_name"

l3_previous_device_features_with_config:
  where_clause: "where rank<=2"
  feature_list:
    start_of_month: "start_of_month"
    mobile_no: "mobile_no"
    register_date: "register_date"
    device_previous_imei: "last_value(handset_imei) over( partition by start_of_month,mobile_no,register_date
                                                              order by rank)"
    device_previous_brand_code: "last_value(handset_brand_code) over( partition by start_of_month,mobile_no,register_date
                                                                          order by rank)"
    device_previous_brand_name: "last_value(handset_brand_name) over( partition by start_of_month,mobile_no,register_date
                                                                    order by rank)"
    device_previous_model_name: "last_value(handset_model_name) over( partition by start_of_month,mobile_no,register_date
                                                                    order by rank)"
  granularity: ""




