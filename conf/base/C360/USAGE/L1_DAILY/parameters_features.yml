# Config file for query generator
l1_usage_outgoing_call_relation_sum_daily:
  where_clause: "where call_type IN ('MO')"
  feature_list:
    access_method_num: "max(caller_no)"

    usg_outgoing_favourite_numbers_call_duration: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_durations else 0 end)"

    usg_outgoing_favourite_numbers_local_call_duration: "sum(case when service_type IN ('VOICE')  AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_durations else 0 end)"

    usg_outgoing_favourite_numbers_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_successful_call else 0 end)"

    usg_outgoing_favourite_numbers_local_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_outgoing_relative_favourite_numbers_call_duration: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_durations else 0 end) / sum(case when service_type IN ('VOICE') THEN total_durations else 0 end)"

    usg_outgoing_relative_favourite_numbers_local_call_duration: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_durations else 0 end) / sum(case when service_type IN ('VOICE') AND idd_flag = 'N' THEN total_durations else 0 end)"

    usg_outgoing_relative_favourite_numbers_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_successful_call else 0 end) / sum(case when service_type IN ('VOICE') THEN total_successful_call else 0 end)"

    usg_outgoing_relative_favourite_numbers_local_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_successful_call else 0 end) / sum(case when service_type IN ('VOICE') AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_outgoing_favourite_numbers_sms_number: "sum(case when service_type IN ('SMS') AND favourite_flag = 'Y' THEN total_successful_call else 0 end)"

    usg_outgoing_favourite_numbers_local_sms_number: "sum(case when service_type IN ('SMS') AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_outgoing_relative_favourite_numbers_sms_number: "sum(case when service_type IN ('SMS') AND favourite_flag = 'Y' THEN total_successful_call else 0 end) / sum(case when service_type IN ('SMS')  THEN total_successful_call else 0 end)"

    usg_outgoing_relative_favourite_numbers_local_sms_number: "sum(case when service_type IN ('SMS') AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_successful_call else 0 end) / sum(case when service_type IN ('SMS') AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_outgoing_total_call_duration: "sum(case when service_type IN ('VOICE') THEN total_durations else 0 end)"

    usg_outgoing_local_call_duration: "sum(case when service_type IN ('VOICE')
                                           AND idd_flag = 'N' THEN total_durations else 0 end)"

    usg_outgoing_number_calls: "sum(case when service_type IN ('VOICE') THEN total_successful_call else 0 end)"

    usg_outgoing_local_number_calls: "sum(case when service_type IN ('VOICE')
                                        AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_outgoing_ais_local_calls_duration: "sum(case when service_type IN ('VOICE')
                                                AND called_network_type  IN ('3GPost-paid', '3GPre-paid', 'AIS', 'InternalAWN', 'AWN', 'Fixed Line-AWN', 'AIS Local', 'AWNFIX', '3GHybrid-Post', 'AWNINT', 'PPS', 'SBN', 'DPC', 'GSM')
                                                THEN total_durations else 0 end)"

    usg_outgoing_ais_local_number_calls: "sum(case when service_type IN ('VOICE')
                                                AND called_network_type  IN ('3GPost-paid', '3GPre-paid', 'AIS', 'InternalAWN', 'AWN', 'Fixed Line-AWN', 'AIS Local', 'AWNFIX', '3GHybrid-Post', 'AWNINT', 'PPS', 'SBN', 'DPC', 'GSM')
                                                THEN total_successful_call else 0 end)"

    usg_outgoing_offnet_local_calls_duration: "sum(case when service_type IN ('VOICE')
                                                   AND called_network_type  IN ('3GPost-paid', '3GPre-paid', 'AIS', 'InternalAWN', 'AWN', 'Fixed Line-AWN', 'AIS Local', 'AWNFIX', '3GHybrid-Post', 'AWNINT', 'PPS', 'SBN', 'DPC', 'GSM')
                                                   THEN total_durations else 0 end)"

    usg_outgoing_offnet_local_number_calls: "sum(case when service_type IN ('VOICE')
                                                 AND called_network_type  IN ('3GPost-paid', '3GPre-paid', 'AIS', 'InternalAWN', 'AWN', 'Fixed Line-AWN', 'AIS Local', 'AWNFIX', '3GHybrid-Post', 'AWNINT', 'PPS', 'SBN', 'DPC', 'GSM')
                                                 THEN total_successful_call else 0 end)"

    usg_outgoing_total_sms: "sum(case when service_type IN ('SMS') THEN total_durations else 0 end)"

    usg_outgoing_local_sms: "sum(case when service_type IN ('SMS')
                                AND idd_flag = 'N' THEN total_durations else 0 end)"

    usg_outgoing_local_ais_sms: "sum(case when service_type IN ('SMS')
                                     AND called_network_type  IN ('3GPost-paid', '3GPre-paid', 'AIS', 'InternalAWN', 'AWN', 'Fixed Line-AWN', 'AIS Local', 'AWNFIX', '3GHybrid-Post', 'AWNINT', 'PPS', 'SBN', 'DPC', 'GSM')
                                     AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_outgoing_number_calls_upto_5_mins: "sum(case when service_type IN ('VOICE')
                                                AND total_durations <= 300 THEN total_successful_call else 0 end)"

    usg_outgoing_number_calls_upto_10_mins: "sum(case when service_type IN ('VOICE')
                                                AND total_durations <= 600 THEN total_successful_call else 0 end)"

    usg_outgoing_number_calls_upto_15_mins: "sum(case when service_type IN ('VOICE')
                                                AND total_durations <= 900 THEN total_successful_call else 0 end)"

    usg_outgoing_number_calls_upto_20_mins: "sum(case when service_type IN ('VOICE')
                                                AND total_durations <= 1200 THEN total_successful_call else 0 end)"

    usg_outgoing_number_calls_upto_30_mins: "sum(case when service_type IN ('VOICE')
                                                AND total_durations <= 1800 THEN total_successful_call else 0 end)"

    usg_outgoing_number_calls_over_30_mins: "sum(case when service_type IN ('VOICE')
                                                AND total_durations > 1800 THEN total_successful_call else 0 end)"

    usg_outgoing_last_call_date: "max(case when service_type IN ('VOICE') THEN date(day_id) else null end)"

    usg_last_call_date: "max(case when service_type IN ('VOICE') THEN date(day_id) else null end)"

    usg_outgoing_last_sms_date: "max(case when service_type IN ('SMS') THEN date(day_id) else null end)"

    usg_last_sms_date: "max(case when service_type IN ('SMS') THEN date(day_id) else null end)"

    usg_last_action_date: "max(date(day_id))"

    usg_outgoing_night_time_number_calls: "sum(case when service_type IN ('VOICE')
                                            AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_successful_call else 0 end)"

    usg_outgoing_night_time_calls_duration: "sum(case when service_type IN ('VOICE')
                                            AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_outgoing_morning_time_number_calls: "sum(case when service_type IN ('VOICE')
                                         AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_successful_call else 0 end)"
    usg_outgoing_morning_time_calls_duration: "sum(case when service_type IN ('VOICE')
                                         AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_outgoing_afternoon_number_calls: "sum(case when service_type IN ('VOICE')
                                         AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_successful_call else 0 end)"

    usg_outgoing_evening_number_calls: "sum(case when service_type IN ('VOICE')
                                        AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_successful_call else 0 end)"

    usg_outgoing_weekday_number_calls: "sum(case when service_type IN ('VOICE')
                                        AND date_format(day_id, 'EEEE') NOT IN ('Saturday', 'Sunday')
                                        THEN total_successful_call else 0 end)"

    usg_outgoing_weekend_number_calls: "sum(case when service_type IN ('VOICE')
                                        AND date_format(day_id, 'EEEE') IN ('Saturday', 'Sunday')
                                        THEN total_successful_call else 0 end)"

    usg_outgoing_weekday_calls_duration: "sum(case when service_type IN ('VOICE')
                                        AND date_format(day_id, 'EEEE') NOT IN ('Saturday', 'Sunday')
                                        THEN total_durations else 0 end)"

    usg_outgoing_weekend_calls_duration: "sum(case when service_type IN ('VOICE')
                                            AND date_format(day_id, 'EEEE') IN ('Saturday', 'Sunday')
                                            THEN total_durations else 0 end)"

    usg_outgoing_night_time_number_sms: "sum(case when service_type IN ('SMS')
                                            AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_successful_call else 0 end)"

    usg_outgoing_morning_time_number_sms: "sum(case when service_type IN ('SMS')
                                         AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_successful_call else 0 end)"

    usg_outgoing_afternoon_number_sms: "sum(case when service_type IN ('SMS')
                                         AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_successful_call else 0 end)"

    usg_outgoing_evening_number_sms: "sum(case when service_type IN ('SMS')
                                        AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_successful_call else 0 end)"

    usg_outgoing_weekday_number_sms: "sum(case when service_type IN ('SMS')
                                        AND date_format(day_id, 'EEEE') NOT IN ('Saturday', 'Sunday')
                                        THEN total_successful_call else 0 end)"

    usg_outgoing_weekend_number_sms: "sum(case when service_type IN ('SMS')
                                        AND date_format(day_id, 'EEEE') IN ('Saturday', 'Sunday')
                                        THEN total_successful_call else 0 end)"

    usg_outgoing_monday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Monday') THEN total_durations else 0 end)"

    usg_outgoing_monday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Monday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_outgoing_monday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Monday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_outgoing_afternoon_time_call_duration: "sum(case when service_type IN ('VOICE') AND hour_id IN
    (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_outgoing_monday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Monday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_outgoing_monday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Monday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_outgoing_tuesday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Tuesday') THEN total_durations else 0 end)"

    usg_outgoing_tuesday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Tuesday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_outgoing_tuesday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Tuesday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_outgoing_tuesday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Tuesday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_outgoing_evening_time_call_duration: "sum(case when service_type IN ('VOICE') AND hour_id IN (19, 20, 21, 22, 23, 0) THEN
     total_durations else 0 end)"

    usg_outgoing_tuesday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Tuesday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_outgoing_wednesday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Wednesday') THEN total_durations else 0 end)"

    usg_outgoing_wednesday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Wednesday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_outgoing_wednesday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Wednesday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_outgoing_wednesday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Wednesday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_outgoing_wednesday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Wednesday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_outgoing_thursday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Thursday') THEN total_durations else 0 end)"

    usg_outgoing_thursday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Thursday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_outgoing_thursday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Thursday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_outgoing_thursday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Thursday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_outgoing_thursday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Thursday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_outgoing_friday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Friday') THEN total_durations else 0 end)"

    usg_outgoing_friday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Friday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_outgoing_friday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Friday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_outgoing_friday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Friday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_outgoing_friday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Friday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_outgoing_saturday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Saturday') THEN total_durations else 0 end)"

    usg_outgoing_saturday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Saturday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_outgoing_saturday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Saturday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_outgoing_saturday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Saturday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_outgoing_saturday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Saturday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_outgoing_sunday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Sunday') THEN total_durations else 0 end)"

    usg_outgoing_sunday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Sunday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_outgoing_sunday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Sunday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_outgoing_sunday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Sunday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_outgoing_sunday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Sunday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    # check called_network_type DTAC/true value
    usg_outgoing_dtac_number_calls: "sum(case when service_type IN ('VOICE')
    AND called_network_type  IN ('DTAC', 'DTN', 'DTNFIX', 'W80', 'P80') THEN total_successful_call else 0 end)"

    usg_outgoing_dtac_call_duration: "sum(case when service_type IN ('VOICE')
    AND called_network_type  IN ('DTAC', 'DTN', 'DTNFIX', 'W80', 'P80') THEN total_durations else 0 end)"

    usg_outgoing_true_number_calls: "sum(case when service_type IN ('VOICE')
    AND called_network_type  IN ('TRUE' , 'TUC'  , 'RFT', 'TIC', 'CATINT', 'TMV', 'HUTCH', 'CATCDA') THEN total_successful_call else 0 end)"

    usg_outgoing_true_call_duration: "sum(case when service_type IN ('VOICE')
    AND called_network_type  IN ('TRUE' , 'TUC'  , 'RFT', 'TIC', 'CATINT', 'TMV', 'HUTCH', 'CATCDA') THEN total_durations else 0 end)"

    usg_outgoing_dtac_number_sms: "sum(case when service_type IN ('SMS')
    AND called_network_type  IN ('DTAC', 'DTN', 'DTNFIX', 'W80', 'P80') THEN total_successful_call else 0 end)"

    usg_outgoing_true_number_sms: "sum(case when service_type IN ('SMS')
    AND called_network_type  IN ('TRUE' , 'TUC'  , 'RFT', 'TIC', 'CATINT', 'TMV', 'HUTCH', 'CATCDA') THEN total_successful_call else 0 end)"
  granularity: "caller_no, day_id"
  event_date_column: "date(day_id)"

l1_usage_incoming_call_relation_sum_daily:
  where_clause: "where call_type IN ('MT')"
  feature_list:
    access_method_num: "max(called_no)"

    usg_incoming_favourite_numbers_call_duration: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_durations else 0 end)"

    usg_incoming_favourite_numbers_local_call_duration: "sum(case when service_type IN ('VOICE')  AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_durations else 0 end)"

    usg_incoming_favourite_numbers_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_successful_call else 0 end)"

    usg_incoming_favourite_numbers_local_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_incoming_relative_favourite_numbers_call_duration: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_durations else 0 end) / sum(case when service_type IN ('VOICE') THEN total_durations else 0 end)"

    usg_incoming_relative_favourite_numbers_local_call_duration: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_durations else 0 end) / sum(case when service_type IN ('VOICE') AND idd_flag = 'N' THEN total_durations else 0 end)"

    usg_incoming_relative_favourite_numbers_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_successful_call else 0 end) / sum(case when service_type IN ('VOICE') THEN total_successful_call else 0 end)"

    usg_incoming_relative_favourite_numbers_local_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_successful_call else 0 end) / sum(case when service_type IN ('VOICE') AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_incoming_favourite_numbers_sms_number: "sum(case when service_type IN ('SMS') AND favourite_flag = 'Y' THEN total_successful_call else 0 end)"

    usg_incoming_favourite_numbers_local_sms_number: "sum(case when service_type IN ('SMS') AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_incoming_relative_favourite_numbers_sms_number: "sum(case when service_type IN ('SMS') AND favourite_flag = 'Y' THEN total_successful_call else 0 end) / sum(case when service_type IN ('SMS')  THEN total_successful_call else 0 end)"

    usg_incoming_relative_favourite_numbers_local_sms_number: "sum(case when service_type IN ('SMS') AND favourite_flag = 'Y' AND idd_flag = 'N' THEN total_successful_call else 0 end) / sum(case when service_type IN ('SMS') AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_incoming_total_call_duration: "sum(case when service_type IN ('VOICE') THEN total_durations else 0 end)"

    usg_incoming_local_call_duration: "sum(case when service_type IN ('VOICE')
                                           AND idd_flag = 'N' THEN total_durations else 0 end)"

    usg_incoming_number_calls: "sum(case when service_type IN ('VOICE')
                                     THEN total_successful_call else 0 end)"

    usg_incoming_local_number_calls: "sum(case when service_type IN ('VOICE')
                                        AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_incoming_ais_local_calls_duration: "sum(case when service_type IN ('VOICE')
                                                AND caller_network_type IN ('3GPost-paid', '3GPre-paid', 'AIS', 'InternalAWN', 'AWN', 'Fixed Line-AWN', 'AIS Local', 'AWNFIX', '3GHybrid-Post', 'AWNINT', 'PPS', 'SBN', 'DPC', 'GSM')
                                                THEN total_durations else 0 end)"

    usg_incoming_ais_local_number_calls: "sum(case when service_type IN ('VOICE')
                                                AND caller_network_type IN ('3GPost-paid', '3GPre-paid', 'AIS', 'InternalAWN', 'AWN', 'Fixed Line-AWN', 'AIS Local', 'AWNFIX', '3GHybrid-Post', 'AWNINT', 'PPS', 'SBN', 'DPC', 'GSM')
                                                THEN total_successful_call else 0 end)"

    usg_incoming_offnet_local_calls_duration: "sum(case when service_type IN ('VOICE')
                                                AND caller_network_type IN ('3GPost-paid', '3GPre-paid', 'AIS', 'InternalAWN', 'AWN', 'Fixed Line-AWN', 'AIS Local', 'AWNFIX', '3GHybrid-Post', 'AWNINT', 'PPS', 'SBN', 'DPC', 'GSM')
                                                THEN total_durations else 0 end)"

    usg_incoming_offnet_local_number_calls: "sum(case when service_type IN ('VOICE')
                                                AND caller_network_type IN ('3GPost-paid', '3GPre-paid', 'AIS', 'InternalAWN', 'AWN', 'Fixed Line-AWN', 'AIS Local', 'AWNFIX', '3GHybrid-Post', 'AWNINT', 'PPS', 'SBN', 'DPC', 'GSM')
                                                THEN total_successful_call else 0 end)"

    usg_incoming_total_sms: "sum(case when service_type IN ('SMS') THEN total_successful_call else 0 end)"

    usg_incoming_local_sms: "sum(case when service_type IN ('SMS')
                                 AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_incoming_local_ais_sms: "sum(case when service_type IN ('SMS')
                                     AND caller_network_type IN ('3GPost-paid', '3GPre-paid', 'AIS', 'InternalAWN', 'AWN', 'Fixed Line-AWN', 'AIS Local', 'AWNFIX', '3GHybrid-Post', 'AWNINT', 'PPS', 'SBN', 'DPC', 'GSM')
                                     AND idd_flag = 'N' THEN total_successful_call else 0 end)"

    usg_incoming_number_calls_upto_5_mins: "sum(case when service_type IN ('VOICE')
                                                AND total_durations <= 300 THEN total_successful_call else 0 end)"

    usg_incoming_number_calls_upto_10_mins: "sum(case when service_type IN ('VOICE')
                                                AND total_durations <= 600 THEN total_successful_call else 0 end)"

    usg_incoming_number_calls_upto_15_mins: "sum(case when service_type IN ('VOICE')
                                                AND total_durations <= 900 THEN total_successful_call else 0 end)"

    usg_incoming_number_calls_upto_20_mins: "sum(case when service_type IN ('VOICE')
                                                AND total_durations <= 1200 THEN total_successful_call else 0 end)"

    usg_incoming_number_calls_upto_30_mins: "sum(case when service_type IN ('VOICE')
                                                 AND total_durations <= 1800 THEN total_successful_call else 0 end)"

    usg_incoming_number_calls_over_30_mins: "sum(case when service_type IN ('VOICE')
                                                 AND total_durations > 1800 THEN total_successful_call else 0 end)"

    usg_incoming_last_call_date: "max(case when service_type IN ('VOICE') THEN date(day_id) else null end)"

    usg_last_call_date: "max(case when service_type IN ('VOICE') THEN date(day_id) else null end)"

    usg_last_action_date: "max(date(day_id))"

    usg_incoming_last_sms_date: "max(case when service_type IN ('SMS') THEN date(day_id) else null end)"

    usg_last_sms_date: "max(case when service_type IN ('SMS') THEN date(day_id) else null end)"

    usg_incoming_night_time_call: "sum(case when service_type IN ('VOICE')
                                       AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_successful_call else 0 end)"

    usg_incoming_night_time_call_duration: "sum(case when service_type IN ('VOICE')
                                       AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_incoming_morning_time_call: "sum(case when service_type IN ('VOICE')
                                       AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_successful_call else 0 end)"

    usg_incoming_morning_time_call_duration: "sum(case when service_type IN ('VOICE')
                                       AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_incoming_afternoon_time_call: "sum(case when service_type IN ('VOICE')
                                       AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_successful_call else 0 end)"

    usg_incoming_evening_time_call: "sum(case when service_type IN ('VOICE')
                                       AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_successful_call else 0 end)"

    usg_incoming_evening_time_call_duration: "sum(case when service_type IN ('VOICE') AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_incoming_weekday_number_calls: "sum(case when service_type IN ('VOICE')
                                        AND date_format(day_id, 'EEEE') NOT IN ('Saturday', 'Sunday')
                                        THEN total_successful_call else 0 end)"

    usg_incoming_weekend_number_calls: "sum(case when service_type IN ('VOICE')
                                            AND date_format(day_id, 'EEEE') IN ('Saturday', 'Sunday')
                                            THEN total_successful_call else 0 end)"

    usg_incoming_weekday_calls_duration: "sum(case when service_type IN ('VOICE')
                                        AND date_format(day_id, 'EEEE') NOT IN ('Saturday', 'Sunday')
                                        THEN total_durations else 0 end)"

    usg_incoming_weekend_calls_duration: "sum(case when service_type IN ('VOICE')
                                            AND date_format(day_id, 'EEEE') IN ('Saturday', 'Sunday')
                                            THEN total_durations else 0 end)"

    usg_incoming_night_time_number_sms: "sum(case when service_type IN ('SMS')
                                            AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_successful_call else 0 end)"

    usg_incoming_morning_time_number_sms: "sum(case when service_type IN ('SMS')
                                         AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_successful_call else 0 end)"

    usg_incoming_afternoon_number_sms: "sum(case when service_type IN ('SMS')
                                         AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_successful_call else 0 end)"

    usg_incoming_evening_number_sms: "sum(case when service_type IN ('SMS')
                                        AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_successful_call else 0 end)"

    usg_incoming_weekday_number_sms: "sum(case when service_type IN ('SMS')
                                        AND date_format(day_id, 'EEEE') NOT IN ('Saturday', 'Sunday') THEN total_successful_call else 0 end)"

    usg_incoming_weekend_number_sms: "sum(case when service_type IN ('SMS')
                                        AND date_format(day_id, 'EEEE') IN ('Saturday', 'Sunday') THEN total_successful_call else 0 end)"

    usg_incoming_monday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Monday') THEN total_durations else 0 end)"

    usg_incoming_monday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Monday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_incoming_afternoon_time_call_duration: "sum(case when service_type IN ('VOICE') AND hour_id IN
    (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_incoming_monday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Monday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_incoming_monday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Monday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_incoming_monday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Monday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_incoming_tuesday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Tuesday') THEN total_durations else 0 end)"

    usg_incoming_tuesday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Tuesday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_incoming_tuesday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Tuesday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_incoming_tuesday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Tuesday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_incoming_tuesday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Tuesday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_incoming_wednesday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Wednesday') THEN total_durations else 0 end)"

    usg_incoming_wednesday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Wednesday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_incoming_wednesday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Wednesday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_incoming_wednesday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Wednesday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_incoming_wednesday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Wednesday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_incoming_thursday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Thursday') THEN total_durations else 0 end)"

    usg_incoming_thursday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Thursday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_incoming_thursday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Thursday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_incoming_thursday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Thursday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_incoming_thursday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Thursday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_incoming_friday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Friday') THEN total_durations else 0 end)"

    usg_incoming_friday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Friday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_incoming_friday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Friday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_incoming_friday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Friday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_incoming_friday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Friday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_incoming_saturday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Saturday') THEN total_durations else 0 end)"

    usg_incoming_saturday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Saturday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_incoming_saturday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Saturday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_incoming_saturday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Saturday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_incoming_saturday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Saturday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    usg_incoming_sunday_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Sunday') THEN total_durations else 0 end)"

    usg_incoming_sunday_morning_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Sunday')
                                          AND hour_id IN (7, 8, 9, 10, 11, 12) THEN total_durations else 0 end)"

    usg_incoming_sunday_afternoon_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Sunday')
                                          AND hour_id IN (13, 14, 15, 16, 17, 18) THEN total_durations else 0 end)"

    usg_incoming_sunday_evening_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Sunday')
                                          AND hour_id IN (19, 20, 21, 22, 23, 0) THEN total_durations else 0 end)"

    usg_incoming_sunday_night_voice_usage: "sum(case when service_type IN ('VOICE')
                                          AND date_format(day_id, 'EEEE') IN ('Sunday')
                                          AND hour_id IN (1, 2, 3, 4, 5, 6) THEN total_durations else 0 end)"

    # check called_network_type DTAC/true value
    usg_incoming_dtac_number_calls: "sum(case when service_type IN ('VOICE')
    AND caller_network_type IN ('DTAC', 'DTN', 'DTNFIX', 'W80', 'P80') THEN total_successful_call else 0 end)"

    usg_incoming_dtac_call_duration: "sum(case when service_type IN ('VOICE')
    AND caller_network_type IN ('DTAC', 'DTN', 'DTNFIX', 'W80', 'P80') THEN total_durations else 0 end)"

    usg_incoming_true_number_calls: "sum(case when service_type IN ('VOICE')
    AND caller_network_type IN ('TRUE' , 'TUC'  , 'RFT', 'TIC', 'CATINT', 'TMV', 'HUTCH', 'CATCDA') THEN total_successful_call else 0 end)"

    usg_incoming_true_call_duration: "sum(case when service_type IN ('VOICE')
    AND caller_network_type IN ('TRUE' , 'TUC'  , 'RFT', 'TIC', 'CATINT', 'TMV', 'HUTCH', 'CATCDA') THEN total_durations else 0 end)"

    usg_incoming_dtac_number_sms: "sum(case when service_type IN ('SMS')
    AND caller_network_type IN ('DTAC', 'DTN', 'DTNFIX', 'W80', 'P80') THEN total_successful_call else 0 end)"

    usg_incoming_true_number_sms: "sum(case when service_type IN ('SMS')
    AND caller_network_type IN ('TRUE' , 'TUC'  , 'RFT', 'TIC', 'CATINT', 'TMV', 'HUTCH', 'CATCDA') THEN total_successful_call else 0 end)"

  granularity: "called_no, day_id"
  event_date_column: "date(day_id)"

l1_usage_ru_a_gprs_cbs_usage_daily:
  where_clause: ""
  feature_list:
    usg_outgoing_data_volume: "sum(data_upload_amt)"

    usg_outgoing_data_volume_4G: "sum(case when rat_type = '4G' then data_upload_amt else 0 end)"

    usg_outgoing_data_volume_2G_3G: "sum(case when rat_type IN ('2G', '3G') then data_upload_amt else 0 end)"

    usg_outgoing_roaming_data_volume: "sum(case when cdr_subtype_cd = 'ROAMING' then data_upload_amt else 0 end)"
    usg_outgoing_roaming_data_volume_4G: "sum(case when cdr_subtype_cd = 'ROAMING' AND rat_type = '4G'
                                                then data_upload_amt else 0 end)"

    usg_outgoing_roaming_data_volume_2G_3G: "sum(case when cdr_subtype_cd = 'ROAMING' AND rat_type IN ('2G', '3G')
                                                then data_upload_amt else 0 end)"

    usg_outgoing_local_data_volume: "sum(case when cdr_subtype_cd = 'DOMESTIC' then data_upload_amt else 0 end)"

    usg_outgoing_local_data_volume_4G: "sum(case when cdr_subtype_cd = 'DOMESTIC' AND rat_type = '4G'
                                                then data_upload_amt else 0 end)"

    usg_outgoing_local_data_volume_2G_3G: "sum(case when cdr_subtype_cd = 'DOMESTIC' AND rat_type IN ('2G', '3G')
                                                then data_upload_amt else 0 end)"

    usg_incoming_data_volume: "sum(data_download_amt)"

    usg_incoming_data_volume_4G: "sum(case when rat_type = '4G' then data_download_amt else 0 end)"

    usg_incoming_data_volume_2G_3G: "sum(case when rat_type IN ('2G', '3G') then data_download_amt else 0 end)"

    usg_incoming_roaming_data_volume: "sum(case when cdr_subtype_cd = 'ROAMING' then data_download_amt else 0 end)"

    usg_incoming_roaming_data_volume_4G: "sum(case when rat_type = '4G' and cdr_subtype_cd = 'ROAMING'
                                              then data_download_amt else 0 end)"

    usg_incoming_roaming_data_volume_2G_3G: "sum(case when rat_type IN ('2G', '3G') and cdr_subtype_cd = 'ROAMING'
                                              then data_download_amt else 0 end)"

    usg_incoming_local_data_volume: "sum(case when cdr_subtype_cd = 'DOMESTIC' then data_download_amt else 0 end)"

    usg_incoming_local_data_volume_4G: "sum(case when rat_type = '4G' and cdr_subtype_cd = 'DOMESTIC'
                                              then data_download_amt else 0 end)"

    usg_incoming_local_data_volume_2G_3G: "sum(case when rat_type IN ('2G', '3G') and cdr_subtype_cd = 'DOMESTIC'
                                              then data_download_amt else 0 end)"

    usg_data_last_action_date: "max(date(call_start_dt))"

    usg_last_action_date: "max(date(call_start_dt))"

    usg_data_weekend_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Saturday', 'Sunday')
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"
    usg_data_weekday_usage: "sum(case when date_format(call_start_dt, 'EEEE') NOT IN ('Saturday', 'Sunday')
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_monday_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Monday')
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_monday_morning_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Monday')
                                        AND call_start_hr IN (7, 8, 9, 10, 11, 12)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_monday_afternoon_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Monday')
                                        AND call_start_hr IN (13, 14, 15, 16, 17, 18)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_monday_evening_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Monday')
                                        AND call_start_hr IN (19, 20, 21, 22, 23, 0)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_monday_night_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Monday')
                                        AND call_start_hr IN (1, 2, 3, 4, 5, 6)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_tuesday_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Tuesday')
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_tuesday_morning_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Tuesday')
                                        AND call_start_hr IN (7, 8, 9, 10, 11, 12)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_tuesday_afternoon_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Tuesday')
                                        AND call_start_hr IN (13, 14, 15, 16, 17, 18)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_tuesday_evening_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Tuesday')
                                        AND call_start_hr IN (19, 20, 21, 22, 23, 0)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_tuesday_night_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Tuesday')
                                        AND call_start_hr IN (1, 2, 3, 4, 5, 6)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_wednesday_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Wednesday')
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_wednesday_morning_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Wednesday')
                                            AND call_start_hr IN (7, 8, 9, 10, 11, 12)
                                            THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_wednesday_afternoon_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Wednesday')
                                        AND call_start_hr IN (13, 14, 15, 16, 17, 18)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_wednesday_evening_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Wednesday')
                                        AND call_start_hr IN (19, 20, 21, 22, 23, 0)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_wednesday_night_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Wednesday')
                                        AND call_start_hr IN (1, 2, 3, 4, 5, 6)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_thursday_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Thursday')
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_thursday_morning_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Thursday')
                                      AND call_start_hr IN (7, 8, 9, 10, 11, 12)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_thursday_afternoon_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Thursday')
                                        AND call_start_hr IN (13, 14, 15, 16, 17, 18)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_thursday_evening_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Thursday')
                                        AND call_start_hr IN (19, 20, 21, 22, 23, 0)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_thursday_night_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Thursday')
                                        AND call_start_hr IN (1, 2, 3, 4, 5, 6)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_friday_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Friday')
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_friday_morning_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Friday')
                                        AND call_start_hr IN (7, 8, 9, 10, 11, 12)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_friday_afternoon_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Friday')
                                        AND call_start_hr IN (13, 14, 15, 16, 17, 18)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_friday_evening_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Friday')
                                        AND call_start_hr IN (19, 20, 21, 22, 23, 0)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_friday_night_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Friday')
                                        AND call_start_hr IN (1, 2, 3, 4, 5, 6)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_saturday_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Saturday')
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_saturday_morning_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Saturday')
                                        AND call_start_hr IN (7, 8, 9, 10, 11, 12)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_saturday_afternoon_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Saturday')
                                        AND call_start_hr IN (13, 14, 15, 16, 17, 18)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_saturday_evening_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Saturday')
                                        AND call_start_hr IN (19, 20, 21, 22, 23, 0)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_saturday_night_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Saturday')
                                        AND call_start_hr IN (1, 2, 3, 4, 5, 6)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_sunday_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Sunday')
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_sunday_morning_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Sunday')
                                        AND call_start_hr IN (7, 8, 9, 10, 11, 12)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_sunday_afternoon_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Sunday')
                                        AND call_start_hr IN (13, 14, 15, 16, 17, 18)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_sunday_evening_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Sunday')
                                        AND call_start_hr IN (19, 20, 21, 22, 23, 0)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_data_sunday_night_usage: "sum(case when date_format(call_start_dt, 'EEEE') IN ('Sunday')
                                        AND call_start_hr IN (1, 2, 3, 4, 5, 6)
                                        THEN (data_upload_amt + data_download_amt) else 0 end)"

    usg_total_data_volume: "sum(data_upload_amt + data_download_amt)"

    usg_total_data_last_action_date: "max(date(call_start_dt))"

  granularity: "access_method_num, call_start_dt"
  event_date_column: "date(call_start_dt)"

l1_usage_data_postpaid_roaming:
  where_clause: "where call_type_code = 16"
  feature_list:
    usg_outgoing_roaming_data_volume: "sum(ir_gprs_call_uplink_vol)"
    usg_outgoing_roaming_data_volume_4G: "sum(case when ir_call_type_group_code = '4G'
    then ir_gprs_call_uplink_vol else 0 end)"

    usg_outgoing_roaming_data_volume_2G_3G: "sum(case when ir_call_type_group_code = '3G'
    then ir_gprs_call_uplink_vol else 0 end)"

    usg_incoming_roaming_data_volume: "sum(ir_gprs_call_downlink_vol)"

    usg_incoming_roaming_data_volume_4G: "sum(case when ir_call_type_group_code = '4G'
    then ir_gprs_call_downlink_vol else 0 end)"

    usg_incoming_roaming_data_volume_2G_3G: "sum(case when ir_call_type_group_code = '3G'
    then ir_gprs_call_downlink_vol else 0 end)"

  granularity: "access_method_number, date_id"
  event_date_column: "date(date_id)"



l1_usage_ru_a_vas_postpaid_usg_daily:
  where_clause: "where call_type_cd IN (3, 64)"
  feature_list:
    usg_outgoing_data_volume: "sum(uplink_volume_kb)"

    usg_outgoing_data_volume_4G: "sum(case when rat_type = '4G' then uplink_volume_kb else 0 end)"

    usg_outgoing_data_volume_2G_3G: "sum(case when rat_type IN ('2G', '3G') then uplink_volume_kb else 0 end)"

    usg_incoming_data_volume: "sum(downlink_volume_kb)"

    usg_incoming_data_volume_4G: "sum(case when rat_type = '4G' then downlink_volume_kb else 0 end)"

    usg_incoming_data_volume_2G_3G: "sum(case when rat_type IN ('2G', '3G') then downlink_volume_kb else 0 end)"

    usg_data_last_action_date: "max(date(day_id))"

    usg_last_action_date: "max(date(day_id))"

    usg_data_weekend_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Saturday', 'Sunday')
                                THEN (charge_download_vol_kb) else 0 end)"

    usg_data_weekday_usage: "sum(case when date_format(day_id, 'EEEE') NOT IN ('Saturday', 'Sunday')
                                    THEN (charge_download_vol_kb) else 0 end)"

    usg_data_monday_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Monday') THEN (charge_download_vol_kb) else 0 end)"

    usg_data_monday_morning_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Monday') AND hour_id IN (7, 8, 9, 10, 11, 12)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_monday_afternoon_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Monday') AND hour_id IN (13, 14, 15, 16, 17, 18)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_monday_evening_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Monday') AND hour_id IN (19, 20, 21, 22, 23, 0)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_monday_night_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Monday')
                                        AND hour_id IN (1, 2, 3, 4, 5, 6)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_tuesday_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Tuesday')
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_tuesday_morning_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Tuesday')
                                        AND hour_id IN (7, 8, 9, 10, 11, 12)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_tuesday_afternoon_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Tuesday')
                                        AND hour_id IN (13, 14, 15, 16, 17, 18)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_tuesday_evening_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Tuesday')
                                        AND hour_id IN (19, 20, 21, 22, 23, 0)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_tuesday_night_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Tuesday')
                                        AND hour_id IN (1, 2, 3, 4, 5, 6)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_wednesday_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Wednesday')
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_wednesday_morning_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Wednesday')
                                        AND hour_id IN (7, 8, 9, 10, 11, 12)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_wednesday_afternoon_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Wednesday')
                                        AND hour_id IN (13, 14, 15, 16, 17, 18)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_wednesday_evening_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Wednesday')
                                        AND hour_id IN (19, 20, 21, 22, 23, 0)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_wednesday_night_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Wednesday')
                                        AND hour_id IN (1, 2, 3, 4, 5, 6)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_thursday_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Thursday')
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_thursday_morning_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Thursday')
                                        AND hour_id IN (7, 8, 9, 10, 11, 12)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_thursday_afternoon_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Thursday')
                                        AND hour_id IN (13, 14, 15, 16, 17, 18)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_thursday_evening_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Thursday')
                                        AND hour_id IN (19, 20, 21, 22, 23, 0)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_thursday_night_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Thursday')
                                        AND hour_id IN (1, 2, 3, 4, 5, 6)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_friday_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Friday')
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_friday_morning_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Friday')
                                        AND hour_id IN (7, 8, 9, 10, 11, 12)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_friday_afternoon_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Friday')
                                        AND hour_id IN (13, 14, 15, 16, 17, 18)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_friday_evening_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Friday')
                                        AND hour_id IN (19, 20, 21, 22, 23, 0)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_friday_night_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Friday')
                                        AND hour_id IN (1, 2, 3, 4, 5, 6)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_saturday_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Saturday')
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_saturday_morning_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Saturday')
                                        AND hour_id IN (7, 8, 9, 10, 11, 12)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_saturday_afternoon_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Saturday')
                                        AND hour_id IN (13, 14, 15, 16, 17, 18)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_saturday_evening_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Saturday')
                                        AND hour_id IN (19, 20, 21, 22, 23, 0)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_saturday_night_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Saturday')
                                        AND hour_id IN (1, 2, 3, 4, 5, 6)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_sunday_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Sunday')
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_sunday_morning_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Sunday')
                                        AND hour_id IN (7, 8, 9, 10, 11, 12)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_sunday_afternoon_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Sunday')
                                        AND hour_id IN (13, 14, 15, 16, 17, 18)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_sunday_evening_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Sunday')
                                        AND hour_id IN (19, 20, 21, 22, 23, 0)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_data_sunday_night_usage: "sum(case when date_format(day_id, 'EEEE') IN ('Sunday')
                                        AND hour_id IN (1, 2, 3, 4, 5, 6)
                                        THEN (charge_download_vol_kb) else 0 end)"

    usg_total_data_volume: "sum(charge_download_vol_kb)"

    usg_total_data_last_action_date: "max(date(day_id))"
  granularity: "access_method_num, day_id"
  event_date_column: "date(day_id)"


l1_usage_outgoing_call_relation_sum_ir_daily:
  where_clause: "where call_type IN ('MO')"
  feature_list:
    access_method_num: "max(caller_no)"
    usg_outgoing_favourite_numbers_roaming_call_duration: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_durations else 0 end)"
    usg_outgoing_favourite_numbers_roaming_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_successful_call else 0 end)"
    usg_outgoing_relative_numbers_roaming_call_duration: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_durations else 0 end) / sum(case when service_type IN ('VOICE') THEN total_durations else 0 end)"
    usg_outgoing_relative_numbers_roaming_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_successful_call else 0 end) / sum(case when service_type IN ('VOICE') THEN total_successful_call else 0 end)"
    usg_outgoing_favourite_numbers_roaming_sms_number: "sum(case when service_type IN ('SMS', 'IR_SMS') AND favourite_flag = 'Y' THEN total_successful_call else 0 end)"
    usg_outgoing_relative_favourite_numbers_roaming_sms_number: "sum(case when service_type IN ('SMS', 'IR_SMS') AND favourite_flag = 'Y' THEN total_successful_call else 0 end) / sum(case when service_type IN ('SMS', 'IR_SMS') THEN total_successful_call else 0 end)"
    usg_outgoing_roaming_call_duration: "sum(case when service_type IN ('VOICE') THEN total_durations else 0 end)"
    usg_outgoing_roaming_number_calls: "sum(case when service_type IN ('VOICE') THEN total_successful_call else 0 end)"
    usg_outgoing_roaming_total_sms: "sum(case when service_type IN ('SMS', 'IR_SMS') THEN total_successful_call else 0 end)"
    usg_outgoing_roaming_last_sms_date: "max(case when service_type IN ('SMS', 'IR_SMS') THEN date(day_id) else null end)"
    usg_last_sms_date: "max(case when service_type IN ('SMS', 'IR_SMS') THEN date(day_id) else null end)"
    usg_last_action_date: "max(date(day_id))"
    usg_last_call_date: "max(case when service_type IN ('VOICE') THEN date(day_id) else null end)"
    usg_outgoing_last_call_date: "max(case when service_type IN ('VOICE') THEN date(day_id) else null end)"

  granularity: "caller_no, day_id"
  event_date_column: "date(day_id)"

l1_usage_incoming_call_relation_sum_ir_daily:
  where_clause: "where call_type IN ('MT')"
  feature_list:
    access_method_num: "max(called_no)"
    usg_incoming_favourite_numbers_roaming_call_duration: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_durations else 0 end)"
    usg_incoming_favourite_numbers_roaming_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_successful_call else 0 end)"
    usg_incoming_relative_numbers_roaming_call_duration: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_durations else 0 end) / sum(case when service_type IN ('VOICE') THEN total_durations else 0 end)"
    usg_incoming_relative_numbers_roaming_number_of_calls: "sum(case when service_type IN ('VOICE') AND favourite_flag = 'Y' THEN total_successful_call else 0 end) / sum(case when service_type IN ('VOICE') THEN total_successful_call else 0 end)"
    usg_incoming_favourite_numbers_roaming_sms_number: "sum(case when service_type IN ('SMS', 'IR_SMS') AND favourite_flag = 'Y' THEN total_successful_call else 0 end)"
    usg_incoming_relative_favourite_numbers_roaming_sms_number: "sum(case when service_type IN ('SMS', 'IR_SMS') AND favourite_flag = 'Y' THEN total_successful_call else 0 end) / sum(case when service_type IN ('SMS', 'IR_SMS') THEN total_successful_call else 0 end)"
    usg_incoming_roaming_call_duration: "sum(case when service_type IN ('VOICE') THEN total_durations else 0 end)"
    usg_incoming_roaming_number_calls: "sum(case when service_type IN ('VOICE') THEN total_successful_call else 0 end)"
    usg_incoming_roaming_total_sms: "sum(case when service_type IN ('SMS', 'IR_SMS') THEN total_successful_call else 0 end)"
    usg_incoming_roaming_last_sms_date: "max(case when service_type IN ('SMS', 'IR_SMS') THEN date(day_id) else null end)"
    usg_last_sms_date: "max(case when service_type IN ('SMS', 'IR_SMS') THEN date(day_id) else null end)"
    usg_last_action_date: "max(date(day_id))"
    usg_last_call_date: "max(case when service_type IN ('VOICE') THEN date(day_id) else null end)"
    usg_incoming_last_call_date: "max(case when service_type IN ('VOICE') THEN date(day_id) else null end)"

  granularity: "called_no, day_id"
  event_date_column: "date(day_id)"

l1_usage_ru_a_vas_postpaid_prepaid_daily:
  where_clause: ""
  feature_list:
    usg_vas_total_number_of_call: "sum(number_of_call)"
    usg_vas_last_action_dt: "max(day_id)"
    usg_last_action_date: "max(date(day_id))"
  granularity: "access_method_num, day_id"
  event_date_column: "date(day_id)"

l1_usage_favourite_number_master:
  where_clause: "where call_type IN ('MO') AND service_type IN ('VOICE')"
  feature_list:
    cnt_call: "sum(total_successful_call)"
    sum_durations: "sum(total_durations)"
    end_period: "max(partition_date)"

  granularity: "caller_no, called_no"

l1_usage_last_idd_features:
  feature_list:
    total_successful_call: "sum(total_successful_call)"
    total_minutes: "sum(total_minutes)"
    total_durations: "sum(total_durations)"
    total_net_revenue: "sum(total_net_revenue)"
  where_clause: "where idd_flag = 'Y'"
  granularity: "day_id, hour_id, caller_no, called_network_type, idd_country"
  event_date_column: "date(day_id)"
  