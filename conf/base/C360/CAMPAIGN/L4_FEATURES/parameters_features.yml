l4_campaign_postpaid_prepaid_features_first_first:
  partition_by: ["subscription_identifier"]
  feature_list:
    min: [
      'campaign_overall_count_sum',
      'campaign_total_by_call_center_sum',
      'campaign_total_eligible_by_call_center_sum',
      'campaign_total_success_by_call_center_sum',
      'campaign_total_by_sms_sum',
      ]
    max: [
      'campaign_overall_count_sum',
      'campaign_total_by_call_center_sum',
      'campaign_total_eligible_by_call_center_sum',
      'campaign_total_success_by_call_center_sum',
      'campaign_total_by_sms_sum',
    ]
    sum: [
      'campaign_overall_count_sum',
      'campaign_total_by_call_center_sum',
      'campaign_total_eligible_by_call_center_sum',
      'campaign_total_success_by_call_center_sum',
      'campaign_total_by_sms_sum',
    ]
    avg: [
      'campaign_overall_count_sum',
      'campaign_total_by_call_center_sum',
      'campaign_total_eligible_by_call_center_sum',
      'campaign_total_success_by_call_center_sum',
      'campaign_total_by_sms_sum',
    ]
  read_from: "l2"

l4_campaign_postpaid_prepaid_features_first_second:
  partition_by: ["subscription_identifier"]
  feature_list:
    min: [
      'campaign_total_eligible_by_sms_sum',
      'campaign_total_success_by_sms_sum',
      'campaign_total_upsell_xsell_by_call_center_sum',
      'campaign_total_upsell_xsell_eligible_by_call_center_sum',
      'campaign_total_upsell_xsell_success_by_call_center_sum',
    ]
    max: [
      'campaign_total_eligible_by_sms_sum',
      'campaign_total_success_by_sms_sum',
      'campaign_total_upsell_xsell_by_call_center_sum',
      'campaign_total_upsell_xsell_eligible_by_call_center_sum',
      'campaign_total_upsell_xsell_success_by_call_center_sum',
    ]
    sum: [
      'campaign_total_eligible_by_sms_sum',
      'campaign_total_success_by_sms_sum',
      'campaign_total_upsell_xsell_by_call_center_sum',
      'campaign_total_upsell_xsell_eligible_by_call_center_sum',
      'campaign_total_upsell_xsell_success_by_call_center_sum',
    ]
    avg: [
      'campaign_total_eligible_by_sms_sum',
      'campaign_total_success_by_sms_sum',
      'campaign_total_upsell_xsell_by_call_center_sum',
      'campaign_total_upsell_xsell_eligible_by_call_center_sum',
      'campaign_total_upsell_xsell_success_by_call_center_sum',
    ]
  read_from: "l2"

l4_campaign_postpaid_prepaid_features_second_first:
  partition_by: ["subscription_identifier"]
  feature_list:
    max: [
        'campaign_last_communication_date_max',
        'campaign_total_others_by_call_center_sum',
        'campaign_total_others_eligible_by_call_center_sum',
        'campaign_total_others_success_by_call_center_sum',
        'campaign_total_retention_by_call_center_sum',
    ]
    min: [
        'campaign_total_others_by_call_center_sum',
        'campaign_total_others_eligible_by_call_center_sum',
        'campaign_total_others_success_by_call_center_sum',
        'campaign_total_retention_by_call_center_sum',
    ]
    sum: [
        'campaign_total_others_by_call_center_sum',
        'campaign_total_others_eligible_by_call_center_sum',
        'campaign_total_others_success_by_call_center_sum',
        'campaign_total_retention_by_call_center_sum',
    ]
    avg: [
        'campaign_total_others_by_call_center_sum',
        'campaign_total_others_eligible_by_call_center_sum',
        'campaign_total_others_success_by_call_center_sum',
        'campaign_total_retention_by_call_center_sum',
    ]
  read_from: "l2"

l4_campaign_postpaid_prepaid_features_second_second:
  partition_by: ["subscription_identifier"]
  feature_list:
    max: [
        'campaign_total_retention_eligible_by_call_center_sum',
        'campaign_total_retention_success_by_call_center_sum',
        'campaign_total_upsell_xsell_by_sms_sum',
        'campaign_total_upsell_xsell_eligible_by_sms_sum',
        'campaign_total_upsell_xsell_success_by_sms_sum',
        'campaign_total_others_by_sms_sum',
    ]
    min: [
        'campaign_total_retention_eligible_by_call_center_sum',
        'campaign_total_retention_success_by_call_center_sum',
        'campaign_total_upsell_xsell_by_sms_sum',
        'campaign_total_upsell_xsell_eligible_by_sms_sum',
        'campaign_total_upsell_xsell_success_by_sms_sum',
        'campaign_total_others_by_sms_sum',
    ]
    sum: [
        'campaign_total_retention_eligible_by_call_center_sum',
        'campaign_total_retention_success_by_call_center_sum',
        'campaign_total_upsell_xsell_by_sms_sum',
        'campaign_total_upsell_xsell_eligible_by_sms_sum',
        'campaign_total_upsell_xsell_success_by_sms_sum',
        'campaign_total_others_by_sms_sum',
    ]
    avg: [
        'campaign_total_retention_eligible_by_call_center_sum',
        'campaign_total_retention_success_by_call_center_sum',
        'campaign_total_upsell_xsell_by_sms_sum',
        'campaign_total_upsell_xsell_eligible_by_sms_sum',
        'campaign_total_upsell_xsell_success_by_sms_sum',
        'campaign_total_others_by_sms_sum',
    ]
  read_from: "l2"

l4_campaign_postpaid_prepaid_features_third_first:
  partition_by: ["subscription_identifier"]
  feature_list:
    sum: [
        'campaign_total_others_eligible_by_sms_sum',
        'campaign_total_others_success_by_sms_sum',
        'campaign_total_retention_by_sms_sum',
        'campaign_total_retention_eligible_by_sms_sum',
        'campaign_total_retention_success_by_sms_sum',
    ]
    min: [
        'campaign_total_others_eligible_by_sms_sum',
        'campaign_total_others_success_by_sms_sum',
        'campaign_total_retention_by_sms_sum',
        'campaign_total_retention_eligible_by_sms_sum',
        'campaign_total_retention_success_by_sms_sum',
    ]
    max: [
        'campaign_total_others_eligible_by_sms_sum',
        'campaign_total_others_success_by_sms_sum',
        'campaign_total_retention_by_sms_sum',
        'campaign_total_retention_eligible_by_sms_sum',
        'campaign_total_retention_success_by_sms_sum',
    ]
    avg: [
        'campaign_total_others_eligible_by_sms_sum',
        'campaign_total_others_success_by_sms_sum',
        'campaign_total_retention_by_sms_sum',
        'campaign_total_retention_eligible_by_sms_sum',
        'campaign_total_retention_success_by_sms_sum',
    ]
  read_from: "l2"

l4_campaign_postpaid_prepaid_features_third_second:
  partition_by: ["subscription_identifier"]
  feature_list:
    sum: [
        'campaign_total_upsell_xsell_by_ussd_sum',
        'campaign_total_upsell_xsell_eligible_by_ussd_sum',
        'campaign_total_upsell_xsell_success_by_ussd_sum',
        'campaign_total_others_by_ussd_sum',
        'campaign_total_others_eligible_by_ussd_sum',
    ]
    min: [
        'campaign_total_upsell_xsell_by_ussd_sum',
        'campaign_total_upsell_xsell_eligible_by_ussd_sum',
        'campaign_total_upsell_xsell_success_by_ussd_sum',
        'campaign_total_others_by_ussd_sum',
        'campaign_total_others_eligible_by_ussd_sum',
    ]
    max: [
        'campaign_total_upsell_xsell_by_ussd_sum',
        'campaign_total_upsell_xsell_eligible_by_ussd_sum',
        'campaign_total_upsell_xsell_success_by_ussd_sum',
        'campaign_total_others_by_ussd_sum',
        'campaign_total_others_eligible_by_ussd_sum',
    ]
    avg: [
        'campaign_total_upsell_xsell_by_ussd_sum',
        'campaign_total_upsell_xsell_eligible_by_ussd_sum',
        'campaign_total_upsell_xsell_success_by_ussd_sum',
        'campaign_total_others_by_ussd_sum',
        'campaign_total_others_eligible_by_ussd_sum',
    ]
  read_from: "l2"

l4_campaign_postpaid_prepaid_features_fourth_first:
  partition_by: ["subscription_identifier"]
  feature_list:
    min: [
       'campaign_total_others_success_by_ussd_sum',
       'campaign_total_retention_by_ussd_sum',
       'campaign_total_retention_eligible_by_ussd_sum',
       'campaign_total_retention_success_by_ussd_sum',
       'campaign_total_upsell_xsell_by_myais_app_sum',
       'campaign_total_upsell_xsell_eligible_by_myais_app_sum',
    ]
    max: [
      'campaign_total_others_success_by_ussd_sum',
      'campaign_total_retention_by_ussd_sum',
      'campaign_total_retention_eligible_by_ussd_sum',
      'campaign_total_retention_success_by_ussd_sum',
      'campaign_total_upsell_xsell_by_myais_app_sum',
      'campaign_total_upsell_xsell_eligible_by_myais_app_sum',
    ]
    sum: [
      'campaign_total_others_success_by_ussd_sum',
      'campaign_total_retention_by_ussd_sum',
      'campaign_total_retention_eligible_by_ussd_sum',
      'campaign_total_retention_success_by_ussd_sum',
      'campaign_total_upsell_xsell_by_myais_app_sum',
      'campaign_total_upsell_xsell_eligible_by_myais_app_sum',
    ]
    avg: [
      'campaign_total_others_success_by_ussd_sum',
      'campaign_total_retention_by_ussd_sum',
      'campaign_total_retention_eligible_by_ussd_sum',
      'campaign_total_retention_success_by_ussd_sum',
      'campaign_total_upsell_xsell_by_myais_app_sum',
      'campaign_total_upsell_xsell_eligible_by_myais_app_sum',
    ]
  read_from: "l2"

l4_campaign_postpaid_prepaid_features_fourth_second:
  partition_by: ["subscription_identifier"]
  feature_list:
    min: [
      'campaign_total_upsell_xsell_success_by_myais_app_sum',
      'campaign_total_others_by_myais_app_sum',
      'campaign_total_others_eligible_by_myais_app_sum',
      'campaign_total_others_success_by_myais_app_sum',
      'campaign_total_retention_by_myais_app_sum',
      'campaign_total_retention_eligible_by_myais_app_sum',
      'campaign_total_retention_success_by_myais_app_sum',
    ]
    max: [
      'campaign_total_upsell_xsell_success_by_myais_app_sum',
      'campaign_total_others_by_myais_app_sum',
      'campaign_total_others_eligible_by_myais_app_sum',
      'campaign_total_others_success_by_myais_app_sum',
      'campaign_total_retention_by_myais_app_sum',
      'campaign_total_retention_eligible_by_myais_app_sum',
      'campaign_total_retention_success_by_myais_app_sum',
    ]
    sum: [
      'campaign_total_upsell_xsell_success_by_myais_app_sum',
      'campaign_total_others_by_myais_app_sum',
      'campaign_total_others_eligible_by_myais_app_sum',
      'campaign_total_others_success_by_myais_app_sum',
      'campaign_total_retention_by_myais_app_sum',
      'campaign_total_retention_eligible_by_myais_app_sum',
      'campaign_total_retention_success_by_myais_app_sum',
    ]
    avg: [
      'campaign_total_upsell_xsell_success_by_myais_app_sum',
      'campaign_total_others_by_myais_app_sum',
      'campaign_total_others_eligible_by_myais_app_sum',
      'campaign_total_others_success_by_myais_app_sum',
      'campaign_total_retention_by_myais_app_sum',
      'campaign_total_retention_eligible_by_myais_app_sum',
      'campaign_total_retention_success_by_myais_app_sum',
    ]
  read_from: "l2"

l4_campaign_postpaid_prepaid_features_fifth_first:
  partition_by: ["subscription_identifier"]
  feature_list:
    min: [
        'campaign_total_churn_by_ivr_push_sum',
        'campaign_total_churn_eligible_by_ivr_push_sum',
        'campaign_total_churn_success_by_ivr_push_sum',
        'campaign_total_others_by_ivr_push_sum',
        'campaign_total_others_eligible_by_ivr_push_sum',
        'campaign_total_others_success_by_ivr_push_sum',
        'campaign_total_retention_by_ivr_push_sum',
        'campaign_total_retention_eligible_by_ivr_push_sum',
        'campaign_total_retention_success_by_ivr_push_sum',
        'campaign_total_upsell_xsell_by_ivr_push_sum',
        'campaign_total_upsell_xsell_eligible_by_ivr_push_sum',
        'campaign_total_upsell_xsell_success_by_ivr_push_sum',
    ]
    max: [
        'campaign_total_churn_by_ivr_push_sum',
        'campaign_total_churn_eligible_by_ivr_push_sum',
        'campaign_total_churn_success_by_ivr_push_sum',
        'campaign_total_others_by_ivr_push_sum',
        'campaign_total_others_eligible_by_ivr_push_sum',
        'campaign_total_others_success_by_ivr_push_sum',
        'campaign_total_retention_by_ivr_push_sum',
        'campaign_total_retention_eligible_by_ivr_push_sum',
        'campaign_total_retention_success_by_ivr_push_sum',
        'campaign_total_upsell_xsell_by_ivr_push_sum',
        'campaign_total_upsell_xsell_eligible_by_ivr_push_sum',
        'campaign_total_upsell_xsell_success_by_ivr_push_sum',
    ]
    sum: [
        'campaign_total_churn_by_ivr_push_sum',
        'campaign_total_churn_eligible_by_ivr_push_sum',
        'campaign_total_churn_success_by_ivr_push_sum',
        'campaign_total_others_by_ivr_push_sum',
        'campaign_total_others_eligible_by_ivr_push_sum',
        'campaign_total_others_success_by_ivr_push_sum',
        'campaign_total_retention_by_ivr_push_sum',
        'campaign_total_retention_eligible_by_ivr_push_sum',
        'campaign_total_retention_success_by_ivr_push_sum',
        'campaign_total_upsell_xsell_by_ivr_push_sum',
        'campaign_total_upsell_xsell_eligible_by_ivr_push_sum',
        'campaign_total_upsell_xsell_success_by_ivr_push_sum',
    ]
    avg: [
        'campaign_total_churn_by_ivr_push_sum',
        'campaign_total_churn_eligible_by_ivr_push_sum',
        'campaign_total_churn_success_by_ivr_push_sum',
        'campaign_total_others_by_ivr_push_sum',
        'campaign_total_others_eligible_by_ivr_push_sum',
        'campaign_total_others_success_by_ivr_push_sum',
        'campaign_total_retention_by_ivr_push_sum',
        'campaign_total_retention_eligible_by_ivr_push_sum',
        'campaign_total_retention_success_by_ivr_push_sum',
        'campaign_total_upsell_xsell_by_ivr_push_sum',
        'campaign_total_upsell_xsell_eligible_by_ivr_push_sum',
        'campaign_total_upsell_xsell_success_by_ivr_push_sum',
    ]
  read_from: "l2"

l4_campaign_postpaid_prepaid_features_fifth_second:
  partition_by: ["subscription_identifier"]
  feature_list:
    min: [
        'campaign_total_churn_by_call_center_sum',
        'campaign_total_churn_by_myais_app_sum',
        'campaign_total_churn_by_sms_sum',
        'campaign_total_churn_by_ussd_sum',
        'campaign_total_churn_eligible_by_call_center_sum',
        'campaign_total_churn_eligible_by_myais_app_sum',
        'campaign_total_churn_eligible_by_sms_sum',
        'campaign_total_churn_eligible_by_ussd_sum',
        'campaign_total_churn_success_by_call_center_sum',
        'campaign_total_churn_success_by_myais_app_sum',
        'campaign_total_churn_success_by_sms_sum',
        'campaign_total_churn_success_by_ussd_sum',
    ]
    max: [
        'campaign_total_churn_by_call_center_sum',
        'campaign_total_churn_by_myais_app_sum',
        'campaign_total_churn_by_sms_sum',
        'campaign_total_churn_by_ussd_sum',
        'campaign_total_churn_eligible_by_call_center_sum',
        'campaign_total_churn_eligible_by_myais_app_sum',
        'campaign_total_churn_eligible_by_sms_sum',
        'campaign_total_churn_eligible_by_ussd_sum',
        'campaign_total_churn_success_by_call_center_sum',
        'campaign_total_churn_success_by_myais_app_sum',
        'campaign_total_churn_success_by_sms_sum',
        'campaign_total_churn_success_by_ussd_sum',
    ]
    sum: [
        'campaign_total_churn_by_call_center_sum',
        'campaign_total_churn_by_myais_app_sum',
        'campaign_total_churn_by_sms_sum',
        'campaign_total_churn_by_ussd_sum',
        'campaign_total_churn_eligible_by_call_center_sum',
        'campaign_total_churn_eligible_by_myais_app_sum',
        'campaign_total_churn_eligible_by_sms_sum',
        'campaign_total_churn_eligible_by_ussd_sum',
        'campaign_total_churn_success_by_call_center_sum',
        'campaign_total_churn_success_by_myais_app_sum',
        'campaign_total_churn_success_by_sms_sum',
        'campaign_total_churn_success_by_ussd_sum',
    ]
    avg: [
        'campaign_total_churn_by_call_center_sum',
        'campaign_total_churn_by_myais_app_sum',
        'campaign_total_churn_by_sms_sum',
        'campaign_total_churn_by_ussd_sum',
        'campaign_total_churn_eligible_by_call_center_sum',
        'campaign_total_churn_eligible_by_myais_app_sum',
        'campaign_total_churn_eligible_by_sms_sum',
        'campaign_total_churn_eligible_by_ussd_sum',
        'campaign_total_churn_success_by_call_center_sum',
        'campaign_total_churn_success_by_myais_app_sum',
        'campaign_total_churn_success_by_sms_sum',
        'campaign_total_churn_success_by_ussd_sum',
    ]
  read_from: "l2"

l4_campaign_postpaid_prepaid_features_sixth_first:
  partition_by: ["subscription_identifier"]
  feature_list:
    min: [
        'campaign_total_by_ivr_push_sum',
        'campaign_total_eligible_by_ivr_push_sum',
        'campaign_total_success_by_ivr_push_sum',
        'campaign_total_contact_success_by_call_center_sum',
        'campaign_total_retention_contact_success_by_call_center_sum',
        'campaign_total_upsell_xsell_contact_success_by_call_center_sum',
        'campaign_total_churn_contact_success_by_call_center_sum',
        'campaign_total_others_contact_success_by_call_center_sum',
    ]
    max: [
        'campaign_total_by_ivr_push_sum',
        'campaign_total_eligible_by_ivr_push_sum',
        'campaign_total_success_by_ivr_push_sum',
        'campaign_total_contact_success_by_call_center_sum',
        'campaign_total_retention_contact_success_by_call_center_sum',
        'campaign_total_upsell_xsell_contact_success_by_call_center_sum',
        'campaign_total_churn_contact_success_by_call_center_sum',
        'campaign_total_others_contact_success_by_call_center_sum',
    ]
    sum: [
        'campaign_total_by_ivr_push_sum',
        'campaign_total_eligible_by_ivr_push_sum',
        'campaign_total_success_by_ivr_push_sum',
        'campaign_total_contact_success_by_call_center_sum',
        'campaign_total_retention_contact_success_by_call_center_sum',
        'campaign_total_upsell_xsell_contact_success_by_call_center_sum',
        'campaign_total_churn_contact_success_by_call_center_sum',
        'campaign_total_others_contact_success_by_call_center_sum',
    ]
    avg: [
        'campaign_total_by_ivr_push_sum',
        'campaign_total_eligible_by_ivr_push_sum',
        'campaign_total_success_by_ivr_push_sum',
        'campaign_total_contact_success_by_call_center_sum',
        'campaign_total_retention_contact_success_by_call_center_sum',
        'campaign_total_upsell_xsell_contact_success_by_call_center_sum',
        'campaign_total_churn_contact_success_by_call_center_sum',
        'campaign_total_others_contact_success_by_call_center_sum',
    ]
  read_from: "l2"

l4_campaign_postpaid_prepaid_features_sixth_second:
  partition_by: ["subscription_identifier"]
  feature_list:
    min: [
        'campaign_total_by_ussd_sum',
        'campaign_total_by_myais_app_sum',
        'campaign_total_success_by_ussd_sum',
        'campaign_total_success_by_myais_app_sum',
        'campaign_total_eligible_by_ussd_sum',
        'campaign_total_eligible_by_myais_app_sum',
    ]
    max: [
        'campaign_total_by_ussd_sum',
        'campaign_total_by_myais_app_sum',
        'campaign_total_success_by_ussd_sum',
        'campaign_total_success_by_myais_app_sum',
        'campaign_total_eligible_by_ussd_sum',
        'campaign_total_eligible_by_myais_app_sum',
    ]
    sum: [
        'campaign_total_by_ussd_sum',
        'campaign_total_by_myais_app_sum',
        'campaign_total_success_by_ussd_sum',
        'campaign_total_success_by_myais_app_sum',
        'campaign_total_eligible_by_ussd_sum',
        'campaign_total_eligible_by_myais_app_sum',
    ]
    avg: [
        'campaign_total_by_ussd_sum',
        'campaign_total_by_myais_app_sum',
        'campaign_total_success_by_ussd_sum',
        'campaign_total_success_by_myais_app_sum',
        'campaign_total_eligible_by_ussd_sum',
        'campaign_total_eligible_by_myais_app_sum',
    ]
  read_from: "l2"

l4_campaign_top_channel_features_int:
  partition_by: ["subscription_identifier", "campaign_channel"]
  ranked_lookup_enable_flag: 'no'
  fix_dimension_cols: "subscription_identifier, start_of_week"
  target_dimension_col: "campaign_channel"
  feature_list:
    sum: ["campaign_channel_success_ratio_sum"]
  read_from: "l2"

l4_campaign_top_channel_features:
  where_clause: ""
  feature_column:
    fav_channel: "campaign_channel"
  partition_by: ["subscription_identifier", "start_of_week"]
  order_by_column_prefix: "sum_campaign_channel_success_ratio_sum"
  read_from: "l2"
  to_join: True


