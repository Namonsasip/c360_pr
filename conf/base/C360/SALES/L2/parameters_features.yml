
l2_sales_number_and_volume_on_top_transaction:
  feature_list:
    # ---------------- share -------------
    share_of_number_campaign_batch_pcm_other_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') then 1 else 0 end))/count(*)"
    share_of_volume_campaign_batch_pcm_other_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"


    share_of_number_ussd_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'ussd') then 1 else 0 end))/count(*)"
    share_of_volume_ussd_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'ussd') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"

    share_of_number_call_center_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc' )then 1 else 0 end))/count(*)"
    share_of_volume_call_center_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc' )then promotion_price_amount else 0 end))/sum(promotion_price_amount)"

    share_of_number_my_ais_app_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais' ) then 1 else 0 end))/count(*)"
    share_of_volume_my_ais_app_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais' ) then promotion_price_amount else 0 end))/sum(promotion_price_amount)"

    share_of_number_retail_stores_on_top_transaction: "(sum(case when ( lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
                                                    lower(cmd_channel_type) = 'asp shop' or
                                                    lower(cmd_channel_type) = 'corperate'  or
                                                    lower(cmd_channel_type) = 'dealer' or
                                                    lower(cmd_channel_type) = 'direct sale' or
                                                    lower(cmd_channel_type) = 'easy app' or
                                                    lower(cmd_channel_type) = 'it channel' or
                                                    lower(cmd_channel_type) = 'modern trade' or
                                                    lower(cmd_channel_type) = 'retail chain' or
                                                    lower(cmd_channel_type) = 'sales' or
                                                    lower(cmd_channel_type) = 'telecom' or
                                                    lower(cmd_channel_type) = 'telewiz shop') then 1 else 0 end))/count(*)"
    share_of_volume_retail_stores_on_top_transaction: "(sum(case when ( lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
                                                    lower(cmd_channel_type) = 'asp shop' or
                                                    lower(cmd_channel_type) = 'corperate'  or
                                                    lower(cmd_channel_type) = 'dealer' or
                                                    lower(cmd_channel_type) = 'direct sale' or
                                                    lower(cmd_channel_type) = 'easy app' or
                                                    lower(cmd_channel_type) = 'it channel' or
                                                    lower(cmd_channel_type) = 'modern trade' or
                                                    lower(cmd_channel_type) = 'retail chain' or
                                                    lower(cmd_channel_type) = 'sales' or
                                                    lower(cmd_channel_type) = 'telecom' or
                                                    lower(cmd_channel_type) = 'telewiz shop') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"

    share_of_number_web_portal_number_on_top_transaction: "(sum(case when ((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) then 1 else 0 end))/count(*)"
    share_of_volume_web_portal_number_on_top_transaction: "(sum(case when ((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) then promotion_price_amount else 0 end))/sum(promotion_price_amount)"

    share_of_number_rom_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'rom') then 1 else 0 end))/count(*)"
    share_of_volume_rom_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'rom') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"

    share_of_number_ais_shop_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'ais shop') then 1 else 0 end))/count(*)"  #-modified 01/11/2021-#
    share_of_volume_ais_shop_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'ais shop') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"  #-modified 01/11/2021-#

    share_of_number_mpay_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') then 1 else 0 end))/count(*)"
    share_of_volume_mpay_on_top_transaction: "(sum(case when (lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    # ---------------batch pcm other --------------------------
    campaign_batch_pcm_other_number_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') then 1 else 0 end)"
    campaign_batch_pcm_other_volume_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') then promotion_price_amount else 0 end)"
    campaign_batch_pcm_other_number_of_data_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(package_type) = 'data') then 1 else 0 end)"
    campaign_batch_pcm_other_volume_of_data_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    campaign_batch_pcm_other_number_of_voice_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(package_type) = 'voice') then 1 else 0 end)"
    campaign_batch_pcm_other_volume_of_voice_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    campaign_batch_pcm_other_number_of_sms_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(package_type) = 'sms') then 1 else 0 end)"
    campaign_batch_pcm_other_volume_of_sms_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    campaign_batch_pcm_other_number_of_vas_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') and lower(package_type) = 'vas' then 1 else 0 end)"
    campaign_batch_pcm_other_volume_of_vas_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') and lower(package_type) = 'vas' then promotion_price_amount else 0 end)"

    # --------------- ussd -----------
    ussd_number_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd') then 1 else 0 end)"
    ussd_volume_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd') then promotion_price_amount else 0 end)"
    ussd_number_of_data_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(package_type) = 'data') then 1 else 0 end)"
    ussd_volume_of_data_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    ussd_number_of_voice_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(package_type) = 'voice') then 1 else 0 end)"
    ussd_volume_of_voice_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    ussd_number_of_sms_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(package_type) = 'sms') then 1 else 0 end)"
    ussd_volume_of_sms_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    ussd_number_of_vas_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd') and lower(package_type) = 'vas' then 1 else 0 end)"
    ussd_volume_of_vas_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd') and lower(package_type) = 'vas' then promotion_price_amount else 0 end)"

    # -----------call center ------------------
    call_center_number_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') then 1 else 0 end)"
    call_center_volume_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc' )then promotion_price_amount else 0 end)"
    call_center_number_of_data_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(package_type) = 'data') then 1 else 0 end)"
    call_center_volume_of_data_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    call_center_number_of_voice_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(package_type) = 'voice') then 1 else 0 end)"
    call_center_volume_of_voice_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    call_center_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(package_type) = 'sms') then 1 else 0 end)"
    call_center_volume_of_sms_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    call_center_number_of_vas_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(package_type) = 'vas') then 1 else 0 end)"
    call_center_volume_of_vas_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(package_type) = 'vas') then promotion_price_amount else 0 end)"

    # --------------------- my ais app --------------------
    my_ais_app_number_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais' ) then 1 else 0 end)"
    my_ais_app_volume_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais' ) then promotion_price_amount else 0 end)"
    my_ais_app_number_of_data_activation_on_top_transaction:  "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(package_type) = 'data') then 1 else 0 end)"
    my_ais_app_volume_of_data_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    my_ais_app_number_of_voice_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(package_type) = 'voice') then 1 else 0 end)"
    my_ais_app_volume_of_voice_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    my_ais_app_number_of_sms_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(package_type) = 'sms') then 1 else 0 end)"
    my_ais_app_volume_of_sms_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    my_ais_app_number_of_vas_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais' ) and lower(package_type) = 'vas' then 1 else 0 end)"
    my_ais_app_volume_of_vas_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais' ) and lower(package_type) = 'vas' then promotion_price_amount else 0 end)"
    # -------------------- retail store -------------
    retail_stores_number_of_on_top_transaction: "sum(case when ( lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
                                                    lower(cmd_channel_type) = 'asp shop' or
                                                    lower(cmd_channel_type) = 'corperate'  or
                                                    lower(cmd_channel_type) = 'dealer' or
                                                    lower(cmd_channel_type) = 'direct sale' or
                                                    lower(cmd_channel_type) = 'easy app' or
                                                    lower(cmd_channel_type) = 'it channel' or
                                                    lower(cmd_channel_type) = 'modern trade' or
                                                    lower(cmd_channel_type) = 'retail chain' or
                                                    lower(cmd_channel_type) = 'sales' or
                                                    lower(cmd_channel_type) = 'telecom' or
                                                    lower(cmd_channel_type) = 'telewiz shop') then 1 else 0 end)"
    retail_stores_volume_of_on_top_transaction: "sum(case when ( lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
                                                    lower(cmd_channel_type) = 'asp shop' or
                                                    lower(cmd_channel_type) = 'corperate'  or
                                                    lower(cmd_channel_type) = 'dealer' or
                                                    lower(cmd_channel_type) = 'direct sale' or
                                                    lower(cmd_channel_type) = 'easy app' or
                                                    lower(cmd_channel_type) = 'it channel' or
                                                    lower(cmd_channel_type) = 'modern trade' or
                                                    lower(cmd_channel_type) = 'retail chain' or
                                                    lower(cmd_channel_type) = 'sales' or
                                                    lower(cmd_channel_type) = 'telecom' or
                                                    lower(cmd_channel_type) = 'telewiz shop') then promotion_price_amount else 0 end)"
    retail_stores_number_of_data_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
    lower(cmd_channel_type) = 'asp shop' or
    lower(cmd_channel_type) = 'corperate'  or
    lower(cmd_channel_type) = 'dealer' or
    lower(cmd_channel_type) = 'direct sale' or
    lower(cmd_channel_type) = 'easy app' or
    lower(cmd_channel_type) = 'it channel' or
    lower(cmd_channel_type) = 'modern trade' or
    lower(cmd_channel_type) = 'retail chain' or
    lower(cmd_channel_type) = 'sales' or
    lower(cmd_channel_type) = 'telecom' or
    lower(cmd_channel_type) = 'telewiz shop') and lower(package_type) = 'data') then 1 else 0 end)"
    retail_stores_volume_of_data_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
    lower(cmd_channel_type) = 'asp shop' or
    lower(cmd_channel_type) = 'corperate'  or
    lower(cmd_channel_type) = 'dealer' or
    lower(cmd_channel_type) = 'direct sale' or
    lower(cmd_channel_type) = 'easy app' or
    lower(cmd_channel_type) = 'it channel' or
    lower(cmd_channel_type) = 'modern trade' or
    lower(cmd_channel_type) = 'retail chain' or
    lower(cmd_channel_type) = 'sales' or
    lower(cmd_channel_type) = 'telecom' or
    lower(cmd_channel_type) = 'telewiz shop') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    retail_stores_number_of_voice_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
    lower(cmd_channel_type) = 'asp shop' or
    lower(cmd_channel_type) = 'corperate'  or
    lower(cmd_channel_type) = 'dealer' or
    lower(cmd_channel_type) = 'direct sale' or
    lower(cmd_channel_type) = 'easy app' or
    lower(cmd_channel_type) = 'it channel' or
    lower(cmd_channel_type) = 'modern trade' or
    lower(cmd_channel_type) = 'retail chain' or
    lower(cmd_channel_type) = 'sales' or
    lower(cmd_channel_type) = 'telecom' or
    lower(cmd_channel_type) = 'telewiz shop') and lower(package_type) = 'voice') then 1 else 0 end)"
    retail_stores_volume_of_voice_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
    lower(cmd_channel_type) = 'asp shop' or
    lower(cmd_channel_type) = 'corperate'  or
    lower(cmd_channel_type) = 'dealer' or
    lower(cmd_channel_type) = 'direct sale' or
    lower(cmd_channel_type) = 'easy app' or
    lower(cmd_channel_type) = 'it channel' or
    lower(cmd_channel_type) = 'modern trade' or
    lower(cmd_channel_type) = 'retail chain' or
    lower(cmd_channel_type) = 'sales' or
    lower(cmd_channel_type) = 'telecom' or
    lower(cmd_channel_type) = 'telewiz shop') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    retail_stores_number_of_sms_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
    lower(cmd_channel_type) = 'asp shop' or
    lower(cmd_channel_type) = 'corperate'  or
    lower(cmd_channel_type) = 'dealer' or
    lower(cmd_channel_type) = 'direct sale' or
    lower(cmd_channel_type) = 'easy app' or
    lower(cmd_channel_type) = 'it channel' or
    lower(cmd_channel_type) = 'modern trade' or
    lower(cmd_channel_type) = 'retail chain' or
    lower(cmd_channel_type) = 'sales' or
    lower(cmd_channel_type) = 'telecom' or
    lower(cmd_channel_type) = 'telewiz shop') and lower(package_type) = 'sms') then 1 else 0 end)"
    retail_stores_volume_of_sms_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
    lower(cmd_channel_type) = 'asp shop' or
    lower(cmd_channel_type) = 'corperate'  or
    lower(cmd_channel_type) = 'dealer' or
    lower(cmd_channel_type) = 'direct sale' or
    lower(cmd_channel_type) = 'easy app' or
    lower(cmd_channel_type) = 'it channel' or
    lower(cmd_channel_type) = 'modern trade' or
    lower(cmd_channel_type) = 'retail chain' or
    lower(cmd_channel_type) = 'sales' or
    lower(cmd_channel_type) = 'telecom' or
    lower(cmd_channel_type) = 'telewiz shop') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    retail_stores_number_of_vas_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
    lower(cmd_channel_type) = 'asp shop' or
    lower(cmd_channel_type) = 'corperate'  or
    lower(cmd_channel_type) = 'dealer' or
    lower(cmd_channel_type) = 'direct sale' or
    lower(cmd_channel_type) = 'easy app' or
    lower(cmd_channel_type) = 'it channel' or
    lower(cmd_channel_type) = 'modern trade' or
    lower(cmd_channel_type) = 'retail chain' or
    lower(cmd_channel_type) = 'sales' or
    lower(cmd_channel_type) = 'telecom' or
    lower(cmd_channel_type) = 'telewiz shop') and lower(package_type) = 'vas') then 1 else 0 end)"
    retail_stores_volume_of_vas_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
    lower(cmd_channel_type) = 'asp shop' or
    lower(cmd_channel_type) = 'corperate'  or
    lower(cmd_channel_type) = 'dealer' or
    lower(cmd_channel_type) = 'direct sale' or
    lower(cmd_channel_type) = 'easy app' or
    lower(cmd_channel_type) = 'it channel' or
    lower(cmd_channel_type) = 'modern trade' or
    lower(cmd_channel_type) = 'retail chain' or
    lower(cmd_channel_type) = 'sales' or
    lower(cmd_channel_type) = 'telecom' or
    lower(cmd_channel_type) = 'telewiz shop') and lower(package_type) = 'vas') then promotion_price_amount else 0 end)"
    # ---------------web portal -------------------
    web_portal_number_of_on_top_transaction:  "sum(case when ((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) then 1 else 0 end)"
    web_portal_volume_of_on_top_transaction:  "sum(case when ((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) then promotion_price_amount else 0 end)"

    web_portal_number_of_data_activation_on_top_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) and lower(package_type) = 'data') then 1 else 0 end)"
    web_portal_volume_of_data_activation_on_top_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    web_portal_number_of_voice_activation_on_top_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) and lower(package_type) = 'voice') then 1 else 0 end)"
    web_portal_volume_of_voice_activation_on_top_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    web_portal_number_of_sms_activation_on_top_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) and lower(package_type) = 'sms') then 1 else 0 end)"
    web_portal_volume_of_sms_activation_on_top_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    web_portal_number_of_vas_activation_on_top_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) and lower(package_type) = 'vas') then 1 else 0 end)"
    web_portal_volume_of_vas_activation_on_top_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) and lower(package_type) = 'vas') then promotion_price_amount else 0 end)"

    # -----------------ROM----------------
    rom_number_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'rom') then 1 else 0 end)"
    rom_volume_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'rom') then promotion_price_amount else 0 end)"
    rom_number_of_data_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(package_type) = 'data') then 1 else 0 end)"
    rom_volume_of_data_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    rom_number_of_voice_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(package_type) = 'voice') then 1 else 0 end)"
    rom_volume_of_voice_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    rom_number_of_sms_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(package_type) = 'sms') then 1 else 0 end)"
    rom_volume_of_sms_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    rom_number_of_vas_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'rom') and lower(package_type) = 'vas' then 1 else 0 end)"
    rom_volume_of_vas_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'rom') and lower(package_type) = 'vas' then promotion_price_amount else 0 end)"

    # ------------------ AIS SHOP *modified 01/11/2021*---------------
    ais_shop_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'ais shop' )then promotion_price_amount else 0 end)"
    ais_shop_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'ais shop' )then 1 else 0 end)"
    ais_shop_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais shop') and lower(package_type) = 'data') then 1 else 0 end)"
    ais_shop_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais shop') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    ais_shop_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais shop') and lower(package_type) = 'voice') then 1 else 0 end)"
    ais_shop_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais shop') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    ais_shop_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais shop') and lower(package_type) = 'sms') then 1 else 0 end)"
    ais_shop_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais shop') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    ais_shop_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais shop' and lower(package_type) = 'vas')) then 1 else 0 end)"
    ais_shop_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais shop' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    # ----------------- mpay --------------------
    mpay_number_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') then 1 else 0 end)"
    mpay_volume_of_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') then promotion_price_amount else 0 end)"
    mpay_number_of_data_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(package_type) = 'data') then 1 else 0 end)"
    mpay_volume_of_data_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    mpay_number_of_voice_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(package_type) = 'voice') then 1 else 0 end)"
    mpay_volume_of_voice_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    mpay_number_of_sms_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(package_type) = 'sms') then 1 else 0 end)"
    mpay_volume_of_sms_activation_on_top_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    mpay_number_of_vas_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(package_type) = 'vas' then 1 else 0 end)"
    mpay_volume_of_vas_activation_on_top_transaction: "sum(case when (lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(package_type) = 'vas' then promotion_price_amount else 0 end)"

    #-------------- ACC  *modified 01/11/2021*-----------------
    acc_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'acc' )then promotion_price_amount else 0 end)"
    acc_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group)= 'acc' )then 1 else 0 end)"
    acc_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'acc') and lower(package_type) = 'data') then 1 else 0 end)"
    acc_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'acc') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    acc_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'acc') and lower(package_type) = 'voice') then 1 else 0 end)"
    acc_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'acc') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    acc_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'acc') and lower(package_type) = 'sms') then 1 else 0 end)"
    acc_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'acc') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    acc_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'acc' and lower(package_type) = 'vas')) then 1 else 0 end)"
    acc_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'acc' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #----------------- AIS BUDDY *modified 01/11/2021* ------------
    ais_buddy_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'ais buddy' )then promotion_price_amount else 0 end)"
    ais_buddy_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'ais buddy' )then 1 else 0 end)"
    ais_buddy_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais buddy') and lower(package_type) = 'data') then 1 else 0 end)"
    ais_buddy_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais buddy') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    ais_buddy_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais buddy') and lower(package_type) = 'voice') then 1 else 0 end)"
    ais_buddy_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais buddy') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    ais_buddy_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais buddy') and lower(package_type) = 'sms') then 1 else 0 end)"
    ais_buddy_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais buddy') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    ais_buddy_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais buddy' and lower(package_type) = 'vas')) then 1 else 0 end)"
    ais_buddy_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais buddy' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #-------------- AIS DEALER  *modified 01/11/2021* -------------
    ais_dealer_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'ais dealer' )then promotion_price_amount else 0 end)"
    ais_dealer_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'ais dealer' )then 1 else 0 end)"
    ais_dealer_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais dealer') and lower(package_type) = 'data') then 1 else 0 end)"
    ais_dealer_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais dealer') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    ais_dealer_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais dealer') and lower(package_type) = 'voice') then 1 else 0 end)"
    ais_dealer_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais dealer') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    ais_dealer_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais dealer') and lower(package_type) = 'sms') then 1 else 0 end)"
    ais_dealer_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais dealer') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    ais_dealer_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais dealer' and lower(package_type) = 'vas')) then 1 else 0 end)"
    ais_dealer_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais dealer' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #------------- AIS OTHER *modified 01/11/2021*-----------------
    ais_other_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'ais other' )then promotion_price_amount else 0 end)"
    ais_other_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'ais other' )then 1 else 0 end)"
    ais_other_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais other') and lower(package_type) = 'data') then 1 else 0 end)"
    ais_other_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais other') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    ais_other_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais other') and lower(package_type) = 'voice') then 1 else 0 end)"
    ais_other_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais other') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    ais_other_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais other') and lower(package_type) = 'sms') then 1 else 0 end)"
    ais_other_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais other') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    ais_other_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais other' and lower(package_type) = 'vas')) then 1 else 0 end)"
    ais_other_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ais other' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #-------------  ARS *modified 01/11/2021*-----------------------
    ars_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'ars' )then promotion_price_amount else 0 end)"
    ars_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'ars' )then 1 else 0 end)"
    ars_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ars') and lower(package_type) = 'data') then 1 else 0 end)"
    ars_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ars') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    ars_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ars') and lower(package_type) = 'voice') then 1 else 0 end)"
    ars_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ars') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    ars_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ars') and lower(package_type) = 'sms') then 1 else 0 end)"
    ars_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ars') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    ars_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ars' and lower(package_type) = 'vas')) then 1 else 0 end)"
    ars_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'ars' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #---------------- ASP *modified 01/11/2021*--------------
    asp_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'asp' )then promotion_price_amount else 0 end)"
    asp_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'asp' )then 1 else 0 end)"
    asp_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'asp') and lower(package_type) = 'data') then 1 else 0 end)"
    asp_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'asp') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    asp_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'asp') and lower(package_type) = 'voice') then 1 else 0 end)"
    asp_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'asp') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    asp_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'asp') and lower(package_type) = 'sms') then 1 else 0 end)"
    asp_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'asp') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    asp_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'asp' and lower(package_type) = 'vas')) then 1 else 0 end)"
    asp_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'asp' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #------------------- BACK OFFICE *modified 01/11/2021*------------
    back_office_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'back office' )then promotion_price_amount else 0 end)"
    back_office_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'back office' )then 1 else 0 end)"
    back_office_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'back office') and lower(package_type) = 'data') then 1 else 0 end)"
    back_office_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'back office') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    back_office_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'back office') and lower(package_type) = 'voice') then 1 else 0 end)"
    back_office_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'back office') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    back_office_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'back office') and lower(package_type) = 'sms') then 1 else 0 end)"
    back_office_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'back office') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    back_office_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'back office' and lower(package_type) = 'vas')) then 1 else 0 end)"
    back_office_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'back office' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #--------------- CORPORATE *modified 01/11/2021*--------------------
    corporate_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'corporate' )then promotion_price_amount else 0 end)"
    corporate_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'corporate' )then 1 else 0 end)"
    corporate_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'corporate') and lower(package_type) = 'data') then 1 else 0 end)"
    corporate_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'corporate') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    corporate_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'corporate') and lower(package_type) = 'voice') then 1 else 0 end)"
    corporate_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'corporate') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    corporate_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'corporate') and lower(package_type) = 'sms') then 1 else 0 end)"
    corporate_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'corporate') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    corporate_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'corporate' and lower(package_type) = 'vas')) then 1 else 0 end)"
    corporate_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'corporate' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #----------------- DIRECTSALE *modified 01/11/2021*-------------------
    directsale_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'directsale' )then promotion_price_amount else 0 end)"
    directsale_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'directsale' )then 1 else 0 end)"
    directsale_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'directsale') and lower(package_type) = 'data') then 1 else 0 end)"
    directsale_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'directsale') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    directsale_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'directsale') and lower(package_type) = 'voice') then 1 else 0 end)"
    directsale_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'directsale') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    directsale_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'directsale') and lower(package_type) = 'sms') then 1 else 0 end)"
    directsale_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'directsale') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    directsale_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'directsale' and lower(package_type) = 'vas')) then 1 else 0 end)"
    directsale_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'directsale' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #------------------ FBB BACK OFFICE *modified 01/11/2021*---------------
    fbb_back_office_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'fbb back office' )then promotion_price_amount else 0 end)"
    fbb_back_office_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'fbb back office' )then 1 else 0 end)"
    fbb_back_office_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb back office') and lower(package_type) = 'data') then 1 else 0 end)"
    fbb_back_office_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb back office') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    fbb_back_office_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb back office') and lower(package_type) = 'voice') then 1 else 0 end)"
    fbb_back_office_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb back office') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    fbb_back_office_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb back office') and lower(package_type) = 'sms') then 1 else 0 end)"
    fbb_back_office_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb back office') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    fbb_back_office_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb back office' and lower(package_type) = 'vas')) then 1 else 0 end)"
    fbb_back_office_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb back office' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #------------------ FBB DEALER *modified 01/11/2021*----------------------
    fbb_dealer_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'fbb dealer' )then promotion_price_amount else 0 end)"
    fbb_dealer_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'fbb dealer' )then 1 else 0 end)"
    fbb_dealer_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb dealer') and lower(package_type) = 'data') then 1 else 0 end)"
    fbb_dealer_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb dealer') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    fbb_dealer_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb dealer') and lower(package_type) = 'voice') then 1 else 0 end)"
    fbb_dealer_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb dealer') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    fbb_dealer_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb dealer') and lower(package_type) = 'sms') then 1 else 0 end)"
    fbb_dealer_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb dealer') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    fbb_dealer_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb dealer' and lower(package_type) = 'vas')) then 1 else 0 end)"
    fbb_dealer_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb dealer' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #-------------------- FBB DIRECTSALE *modified 01/11/2021*------------------
    fbb_directsale_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'fbb directsale' )then promotion_price_amount else 0 end)"
    fbb_directsale_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'fbb directsale' )then 1 else 0 end)"
    fbb_directsale_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb directsale') and lower(package_type) = 'data') then 1 else 0 end)"
    fbb_directsale_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb directsale') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    fbb_directsale_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb directsale') and lower(package_type) = 'voice') then 1 else 0 end)"
    fbb_directsale_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb directsale') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    fbb_directsale_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb directsale') and lower(package_type) = 'sms') then 1 else 0 end)"
    fbb_directsale_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb directsale') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    fbb_directsale_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb directsale' and lower(package_type) = 'vas')) then 1 else 0 end)"
    fbb_directsale_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'fbb directsale' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #------------------- MODERN TRADE *modified 01/11/2021*---------------------
    modern_trade_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'modern trade' )then promotion_price_amount else 0 end)"
    modern_trade_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'modern trade' )then 1 else 0 end)"
    modern_trade_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'modern trade') and lower(package_type) = 'data') then 1 else 0 end)"
    modern_trade_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'modern trade') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    modern_trade_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'modern trade') and lower(package_type) = 'voice') then 1 else 0 end)"
    modern_trade_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'modern trade') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    modern_trade_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'modern trade') and lower(package_type) = 'sms') then 1 else 0 end)"
    modern_trade_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'modern trade') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    modern_trade_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'modern trade' and lower(package_type) = 'vas')) then 1 else 0 end)"
    modern_trade_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'modern trade' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #------------------- ONLINE *modified 01/11/2021*----------------------------
    online_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'online' )then promotion_price_amount else 0 end)"
    online_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'online' )then 1 else 0 end)"
    online_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'online') and lower(package_type) = 'data') then 1 else 0 end)"
    online_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'online') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    online_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'online') and lower(package_type) = 'voice') then 1 else 0 end)"
    online_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'online') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    online_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'online') and lower(package_type) = 'sms') then 1 else 0 end)"
    online_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'online') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    online_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'online' and lower(package_type) = 'vas')) then 1 else 0 end)"
    online_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'online' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #--------------------- RETAIL CHAIN *modified 01/11/2021*--------------------
    retail_chain_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'retail chain' )then promotion_price_amount else 0 end)"
    retail_chain_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'retail chain' )then 1 else 0 end)"
    retail_chain_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'retail chain') and lower(package_type) = 'data') then 1 else 0 end)"
    retail_chain_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'retail chain') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    retail_chain_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'retail chain') and lower(package_type) = 'voice') then 1 else 0 end)"
    retail_chain_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'retail chain') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    retail_chain_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'retail chain') and lower(package_type) = 'sms') then 1 else 0 end)"
    retail_chain_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'retail chain') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    retail_chain_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'retail chain' and lower(package_type) = 'vas')) then 1 else 0 end)"
    retail_chain_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'retail chain' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #----------------------- TELECOM *modified 01/11/2021*------------------------
    telecom_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'telecom' )then promotion_price_amount else 0 end)"
    telecom_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'telecom' )then 1 else 0 end)"
    telecom_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telecom') and lower(package_type) = 'data') then 1 else 0 end)"
    telecom_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telecom') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    telecom_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telecom') and lower(package_type) = 'voice') then 1 else 0 end)"
    telecom_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telecom') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    telecom_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telecom') and lower(package_type) = 'sms') then 1 else 0 end)"
    telecom_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telecom') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    telecom_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telecom' and lower(package_type) = 'vas')) then 1 else 0 end)"
    telecom_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telecom' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #---------------------- TELESALE *modified 01/11/2021*-------------------------
    telesale_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'telesale' )then promotion_price_amount else 0 end)"
    telesale_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'telesale' )then 1 else 0 end)"
    telesale_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telesale') and lower(package_type) = 'data') then 1 else 0 end)"
    telesale_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telesale') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    telesale_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telesale') and lower(package_type) = 'voice') then 1 else 0 end)"
    telesale_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telesale') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    telesale_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telesale') and lower(package_type) = 'sms') then 1 else 0 end)"
    telesale_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telesale') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    telesale_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telesale' and lower(package_type) = 'vas')) then 1 else 0 end)"
    telesale_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telesale' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #--------------------- TELEWIZ *modified 01/11/2021*----------------------------
    telewiz_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'telewiz' )then promotion_price_amount else 0 end)"
    telewiz_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'telewiz' )then 1 else 0 end)"
    telewiz_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telewiz') and lower(package_type) = 'data') then 1 else 0 end)"
    telewiz_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telewiz') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    telewiz_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telewiz') and lower(package_type) = 'voice') then 1 else 0 end)"
    telewiz_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telewiz') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    telewiz_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telewiz') and lower(package_type) = 'sms') then 1 else 0 end)"
    telewiz_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telewiz') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    telewiz_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telewiz' and lower(package_type) = 'vas')) then 1 else 0 end)"
    telewiz_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'telewiz' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #------------------------ TOURIST PARTNER *modified 01/11/2021*---------------------
    tourist_partner_volume_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'tourist partner' )then promotion_price_amount else 0 end)"
    tourist_partner_number_of_on_top_transaction:  "sum(case when (lower(use_channel_main_group) = 'tourist partner' )then 1 else 0 end)"
    tourist_partner_number_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'tourist partner') and lower(package_type) = 'data') then 1 else 0 end)"
    tourist_partner_volume_of_data_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'tourist partner') and lower(package_type) = 'data') then promotion_price_amount else 0 end)"
    tourist_partner_number_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'tourist partner') and lower(package_type) = 'voice') then 1 else 0 end)"
    tourist_partner_volume_of_voice_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'tourist partner') and lower(package_type) = 'voice') then promotion_price_amount else 0 end)"
    tourist_partner_number_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'tourist partner') and lower(package_type) = 'sms') then 1 else 0 end)"
    tourist_partner_volume_of_sms_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'tourist partner') and lower(package_type) = 'sms') then promotion_price_amount else 0 end)"
    tourist_partner_number_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'tourist partner' and lower(package_type) = 'vas')) then 1 else 0 end)"
    tourist_partner_volume_of_vas_activation_on_top_transaction:  "sum(case when ((lower(use_channel_main_group) = 'tourist partner' and lower(package_type) = 'vas')) then promotion_price_amount else 0 end)"

    #--------------------- Transaction channel preference *modified 01/11/2021*-----------------------
    share_of_number_acc_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'acc') then 1 else 0 end))/count(*)"
    share_of_volume_acc_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'acc') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_ais_buddy_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'ais buddy') then 1 else 0 end))/count(*)"
    share_of_volume_ais_buddy_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'ais buddy') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_ais_dealer_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'ais dealer') then 1 else 0 end))/count(*)"
    share_of_volume_ais_dealer_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'ais dealer') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_ais_other_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'ais other') then 1 else 0 end))/count(*)"
    share_of_volume_ais_other_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'ais other') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_ars_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'ars') then 1 else 0 end))/count(*)"
    share_of_volume_ars_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'ars') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_asp_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'asp') then 1 else 0 end))/count(*)"
    share_of_volume_asp_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'asp') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_back_office_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'back office') then 1 else 0 end))/count(*)"
    share_of_volume_back_office_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'back office') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_corporate_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'corporate') then 1 else 0 end))/count(*)"
    share_of_volume_corporate_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'corporate') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_directsale_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'directsale') then 1 else 0 end))/count(*)"
    share_of_volume_directsale_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'directsale') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_fbb_back_office_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'fbb back office') then 1 else 0 end))/count(*)"
    share_of_volume_fbb_back_office_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'fbb back office') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_fbb_dealer_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'fbb dealer') then 1 else 0 end))/count(*)"
    share_of_volume_fbb_dealer_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'fbb dealer') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_fbb_directsale_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'fbb directsale') then 1 else 0 end))/count(*)"
    share_of_volume_fbb_directsale_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'fbb directsale') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_modern_trade_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'modern trade') then 1 else 0 end))/count(*)"
    share_of_volume_modern_trade_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'modern trade') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_online_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'online') then 1 else 0 end))/count(*)"
    share_of_volume_online_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'online') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_retail_chain_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'retail chain') then 1 else 0 end))/count(*)"
    share_of_volume_retail_chain_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'retail chain') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_telecom_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'telecom') then 1 else 0 end))/count(*)"
    share_of_volume_telecom_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'telecom') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_telesale_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'telesale') then 1 else 0 end))/count(*)"
    share_of_volume_telesale_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'telesale') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_telewiz_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'telewiz') then 1 else 0 end))/count(*)"
    share_of_volume_telewiz_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'telewiz') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"
    share_of_number_tourist_partner_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'tourist partner') then 1 else 0 end))/count(*)"
    share_of_volume_tourist_partner_on_top_transaction:  "(sum(case when (lower(use_channel_main_group) = 'tourist partner') then promotion_price_amount else 0 end))/sum(promotion_price_amount)"



  granularity: "start_of_week,subscription_identifier"
  

# ----------lastest ------------------
l2_sales_feature_on_top_transactions_latest:
  feature_list:
    start_of_week: "start_of_week"
    subscription_identifier: "subscription_identifier"
    campaign_batch_pcm_other_name_of_latest_on_top_transaction: "first_value( (case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') then offering_title else null end), true) over(partition by
    start_of_week,
    subscription_identifier
    order by event_start_dttm desc)"

    ais_shop_name_of_latest_on_top_transaction: "first_value( (case when (lower(use_channel_main_group) = 'ais shop' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"   #-modified 01/11/2021-#

    mpay_name_of_latest_on_top_transaction: "first_value( (case when (lower(cmd_channel_type) = 'mpay'  or lower(cmd_channel_type) = 'mpay station' ) then offering_title else null end), true) over(partition by
    start_of_week,
    subscription_identifier
    order by event_start_dttm desc)"

    rom_name_of_latest_on_top_transaction: "first_value( (case when (lower(cmd_channel_type) = 'rom') then offering_title else null end), true) over(partition by
    start_of_week,
    subscription_identifier
    order by event_start_dttm desc)"

    ussd_name_of_latest_on_top_transaction: "first_value( (case when (lower(cmd_channel_type) = 'ussd') then offering_title else null end), true) over(partition by
    start_of_week,
    subscription_identifier
    order by event_start_dttm desc)"

    call_center_name_of_latest_on_top_transaction: "first_value( (case when (lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc' ) then offering_title else null end), true) over(partition by
    start_of_week,
    subscription_identifier
    order by event_start_dttm desc)"

    my_ais_app_name_of_latest_on_top_transaction: "first_value( (case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais') then offering_title else null end), true) over(partition by
    start_of_week,
    subscription_identifier
    order by event_start_dttm desc)"

    web_portal_name_of_latest_on_top_transaction: "first_value( (case when ((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
    lower(cmd_channel_type) = 'eservice' or
    lower(cmd_channel_type) = 'online'  or
    lower(cmd_channel_type) = 'onlinestore' ) then offering_title else null end) , true) over(partition by
    start_of_week,
    subscription_identifier
    order by event_start_dttm desc)"

    retail_stores_name_of_latest_on_top_transaction: "first_value( (case when (lower(cmd_channel_type) = 'ais buddy' or
                                                    lower(cmd_channel_type) = 'ais channel'  or
                                                    lower(cmd_channel_type) = 'ais distribution' or
    lower(cmd_channel_type) = 'asp shop' or
    lower(cmd_channel_type) = 'corperate'  or
    lower(cmd_channel_type) = 'dealer' or
    lower(cmd_channel_type) = 'direct sale' or
    lower(cmd_channel_type) = 'easy app' or
    lower(cmd_channel_type) = 'it channel' or
    lower(cmd_channel_type) = 'modern trade' or
    lower(cmd_channel_type) = 'retail chain' or
    lower(cmd_channel_type) = 'sales' or
    lower(cmd_channel_type) = 'telecom' or
    lower(cmd_channel_type) = 'telewiz shop') then offering_title else null end), true) over(partition by
    start_of_week,
    subscription_identifier
    order by event_start_dttm desc)"

    #----- create 01/11/2021  ---------
    acc_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'acc' ) then offering_title else null end), true) over(partition by start_of_weekorder by event_start_dttm desc)"
    ais_buddy_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'ais buddy' ) then offering_title else null end), true) over(partition by start_of_weekorder by event_start_dttm desc)"
    ais_dealer_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'ais dealer' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    ais_other_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'ais other' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    ars_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'ars' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    asp_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'asp' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    back_office_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'back office' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    corporate_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'corporate' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    directsale_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'directsale' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    fbb_back_office_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'fbb back office' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    fbb_dealer_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'fbb dealer' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    fbb_directsale_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'fbb directsale' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    modern_trade_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'modern trade' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    online_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'online' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    retail_chain_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'retail chain' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    telecom_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'telecom' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    telesale_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'telesale' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    telewiz_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'telewiz' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"
    tourist_partner_name_of_latest_on_top_transaction :  "first_value( (case when (lower(use_channel_main_group) = 'tourist partner' ) then offering_title else null end),  true) over(partition by start_of_week order by event_start_dttm desc)"

  granularity: ""


## ----------------main promotion ----------------------+
#
#l2_sales_number_and_volume_main_transaction:
#  feature_list:
#    # ---------------- share -------------
#    share_of_number_campaign_batch_pcm_other_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') then 1 else 0 end))/count(*)"
#    share_of_volume_campaign_batch_pcm_other_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') then offering_price else 0 end))/sum(offering_price)"
#
#    share_of_number_ussd_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'ussd') then 1 else 0 end))/count(*)"
#    share_of_volume_ussd_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'ussd') then offering_price else 0 end))/sum(offering_price)"
#
#    share_of_number_call_center_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc' )then 1 else 0 end))/count(*)"
#    share_of_volume_call_center_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc' )then offering_price else 0 end))/sum(offering_price)"
#
#    share_of_number_my_ais_app_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais' ) then 1 else 0 end))/count(*)"
#    share_of_volume_my_ais_app_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais' ) then offering_price else 0 end))/sum(offering_price)"
#
#    share_of_number_retail_stores_main_transaction: "(sum(case when ( lower(cmd_channel_type) = 'ais buddy' or
#                                                    lower(cmd_channel_type) = 'ais channel'  or
#                                                    lower(cmd_channel_type) = 'ais distribution' or
#                                                    lower(cmd_channel_type) = 'asp shop' or
#                                                    lower(cmd_channel_type) = 'corperate'  or
#                                                    lower(cmd_channel_type) = 'dealer' or
#                                                    lower(cmd_channel_type) = 'direct sale' or
#                                                    lower(cmd_channel_type) = 'easy app' or
#                                                    lower(cmd_channel_type) = 'it channel' or
#                                                    lower(cmd_channel_type) = 'modern trade' or
#                                                    lower(cmd_channel_type) = 'retail chain' or
#                                                    lower(cmd_channel_type) = 'sales' or
#                                                    lower(cmd_channel_type) = 'telecom' or
#                                                    lower(cmd_channel_type) = 'telewiz shop') then 1 else 0 end))/count(*)"
#    share_of_volume_retail_stores_main_transaction: "(sum(case when ( lower(cmd_channel_type) = 'ais buddy' or
#                                                    lower(cmd_channel_type) = 'ais channel'  or
#                                                    lower(cmd_channel_type) = 'ais distribution' or
#                                                    lower(cmd_channel_type) = 'asp shop' or
#                                                    lower(cmd_channel_type) = 'corperate'  or
#                                                    lower(cmd_channel_type) = 'dealer' or
#                                                    lower(cmd_channel_type) = 'direct sale' or
#                                                    lower(cmd_channel_type) = 'easy app' or
#                                                    lower(cmd_channel_type) = 'it channel' or
#                                                    lower(cmd_channel_type) = 'modern trade' or
#                                                    lower(cmd_channel_type) = 'retail chain' or
#                                                    lower(cmd_channel_type) = 'sales' or
#                                                    lower(cmd_channel_type) = 'telecom' or
#                                                    lower(cmd_channel_type) = 'telewiz shop') then offering_price else 0 end))/sum(offering_price)"
#
#    share_of_number_web_portal_number_main_transaction: "(sum(case when ((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
#    lower(cmd_channel_type) = 'eservice' or
#    lower(cmd_channel_type) = 'online'  or
#    lower(cmd_channel_type) = 'onlinestore' ) then 1 else 0 end))/count(*)"
#    share_of_volume_web_portal_number_main_transaction: "(sum(case when ((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
#    lower(cmd_channel_type) = 'eservice' or
#    lower(cmd_channel_type) = 'online'  or
#    lower(cmd_channel_type) = 'onlinestore' ) then offering_price else 0 end))/sum(offering_price)"
#
#    share_of_number_rom_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'rom') then 1 else 0 end))/count(*)"
#    share_of_volume_rom_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'rom') then offering_price else 0 end))/sum(offering_price)"
#
#    share_of_number_ais_shop_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'ais shop') then 1 else 0 end))/count(*)"
#    share_of_volume_ais_shop_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'ais shop') then offering_price else 0 end))/sum(offering_price)"
#
#    share_of_number_mpay_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') then 1 else 0 end))/count(*)"
#    share_of_volume_mpay_main_transaction: "(sum(case when (lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') then offering_price else 0 end))/sum(offering_price)"
#
#    # -----------------campaign_batch_pcm_othe ---------------------
#    campaign_batch_pcm_other_number_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') then 1 else 0 end)"
#    campaign_batch_pcm_other_volume_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') then offering_price else 0 end)"
#    campaign_batch_pcm_other_number_of_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(service_group) = 'data') then 1 else 0 end)"
#    campaign_batch_pcm_other_volume_of_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(service_group) = 'data') then offering_price else 0 end)"
#    campaign_batch_pcm_other_number_of_voice_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(service_group) = 'voice') then 1 else 0 end)"
#    campaign_batch_pcm_other_volume_of_voice_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(service_group) = 'voice') then offering_price else 0 end)"
#    campaign_batch_pcm_other_number_of_voice_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(service_group) = 'voice+data') then 1 else 0 end)"
#    campaign_batch_pcm_other_volume_of_voice_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff' and lower(service_group) = 'voice+data') then offering_price else 0 end)"
#
#    # --------------- ussd -----------
#    ussd_number_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd') then 1 else 0 end)"
#    ussd_volume_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd') then offering_price else 0 end)"
#    ussd_number_of_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(service_group) = 'data') then 1 else 0 end)"
#    ussd_volume_of_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(service_group) = 'data') then offering_price else 0 end)"
#    ussd_number_of_voice_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(service_group) = 'voice') then 1 else 0 end)"
#    ussd_volume_of_voice_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(service_group) = 'voice') then offering_price else 0 end)"
#    ussd_number_of_voice_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(service_group) = 'voice+data') then 1 else 0 end)"
#    ussd_volume_of_voice_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ussd' and lower(service_group) = 'voice+data') then offering_price else 0 end)"
#
#    # -----------call center ------------------
#    call_center_number_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') then 1 else 0 end)"
#    call_center_volume_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc' )then offering_price else 0 end)"
#    call_center_number_of_data_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(service_group) = 'data') then 1 else 0 end)"
#    call_center_volume_of_data_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(service_group) = 'data') then offering_price else 0 end)"
#    call_center_number_of_voice_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(service_group) = 'voice') then 1 else 0 end)"
#    call_center_volume_of_voice_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(service_group) = 'voice') then offering_price else 0 end)"
#    call_center_number_of_voice_data_activation_main_transaction:  "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(service_group) = 'voice+data') then 1 else 0 end)"
#    call_center_volume_of_voice_data_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc') and lower(service_group) = 'voice+data') then offering_price else 0 end)"
#
#    # --------------------- my ais app --------------------
#    my_ais_app_number_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais' ) then 1 else 0 end)"
#    my_ais_app_volume_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais' ) then offering_price else 0 end)"
#    my_ais_app_number_of_data_activation_main_transaction:  "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(service_group) = 'data') then 1 else 0 end)"
#    my_ais_app_volume_of_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(service_group) = 'data') then offering_price else 0 end)"
#    my_ais_app_number_of_voice_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(service_group) = 'voice') then 1 else 0 end)"
#    my_ais_app_volume_of_voice_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(service_group) = 'voice') then offering_price else 0 end)"
#    my_ais_app_number_of_voice_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(service_group) = 'voice+data') then 1 else 0 end)"
#    my_ais_app_volume_of_voice_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais'  and lower(service_group) = 'voice+data') then offering_price else 0 end)"
#    # -------------------- retail store -------------
#    retail_stores_number_of_main_transaction: "sum(case when ( lower(cmd_channel_type) = 'ais buddy' or
#                                                    lower(cmd_channel_type) = 'ais channel'  or
#                                                    lower(cmd_channel_type) = 'ais distribution' or
#                                                    lower(cmd_channel_type) = 'asp shop' or
#                                                    lower(cmd_channel_type) = 'corperate'  or
#                                                    lower(cmd_channel_type) = 'dealer' or
#                                                    lower(cmd_channel_type) = 'direct sale' or
#                                                    lower(cmd_channel_type) = 'easy app' or
#                                                    lower(cmd_channel_type) = 'it channel' or
#                                                    lower(cmd_channel_type) = 'modern trade' or
#                                                    lower(cmd_channel_type) = 'retail chain' or
#                                                    lower(cmd_channel_type) = 'sales' or
#                                                    lower(cmd_channel_type) = 'telecom' or
#                                                    lower(cmd_channel_type) = 'telewiz shop') then 1 else 0 end)"
#    retail_stores_volume_of_main_transaction: "sum(case when ( lower(cmd_channel_type) = 'ais buddy' or
#                                                    lower(cmd_channel_type) = 'ais channel'  or
#                                                    lower(cmd_channel_type) = 'ais distribution' or
#                                                    lower(cmd_channel_type) = 'asp shop' or
#                                                    lower(cmd_channel_type) = 'corperate'  or
#                                                    lower(cmd_channel_type) = 'dealer' or
#                                                    lower(cmd_channel_type) = 'direct sale' or
#                                                    lower(cmd_channel_type) = 'easy app' or
#                                                    lower(cmd_channel_type) = 'it channel' or
#                                                    lower(cmd_channel_type) = 'modern trade' or
#                                                    lower(cmd_channel_type) = 'retail chain' or
#                                                    lower(cmd_channel_type) = 'sales' or
#                                                    lower(cmd_channel_type) = 'telecom' or
#                                                    lower(cmd_channel_type) = 'telewiz shop') then offering_price else 0 end)"
#    retail_stores_number_of_data_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
#                                                    lower(cmd_channel_type) = 'ais channel'  or
#                                                    lower(cmd_channel_type) = 'ais distribution' or
#    lower(cmd_channel_type) = 'asp shop' or
#    lower(cmd_channel_type) = 'corperate'  or
#    lower(cmd_channel_type) = 'dealer' or
#    lower(cmd_channel_type) = 'direct sale' or
#    lower(cmd_channel_type) = 'easy app' or
#    lower(cmd_channel_type) = 'it channel' or
#    lower(cmd_channel_type) = 'modern trade' or
#    lower(cmd_channel_type) = 'retail chain' or
#    lower(cmd_channel_type) = 'sales' or
#    lower(cmd_channel_type) = 'telecom' or
#    lower(cmd_channel_type) = 'telewiz shop') and lower(service_group) = 'data') then 1 else 0 end)"
#    retail_stores_volume_of_data_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
#                                                    lower(cmd_channel_type) = 'ais channel'  or
#                                                    lower(cmd_channel_type) = 'ais distribution' or
#    lower(cmd_channel_type) = 'asp shop' or
#    lower(cmd_channel_type) = 'corperate'  or
#    lower(cmd_channel_type) = 'dealer' or
#    lower(cmd_channel_type) = 'direct sale' or
#    lower(cmd_channel_type) = 'easy app' or
#    lower(cmd_channel_type) = 'it channel' or
#    lower(cmd_channel_type) = 'modern trade' or
#    lower(cmd_channel_type) = 'retail chain' or
#    lower(cmd_channel_type) = 'sales' or
#    lower(cmd_channel_type) = 'telecom' or
#    lower(cmd_channel_type) = 'telewiz shop') and lower(service_group) = 'data') then offering_price else 0 end)"
#    retail_stores_number_of_voice_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
#                                                    lower(cmd_channel_type) = 'ais channel'  or
#                                                    lower(cmd_channel_type) = 'ais distribution' or
#    lower(cmd_channel_type) = 'asp shop' or
#    lower(cmd_channel_type) = 'corperate'  or
#    lower(cmd_channel_type) = 'dealer' or
#    lower(cmd_channel_type) = 'direct sale' or
#    lower(cmd_channel_type) = 'easy app' or
#    lower(cmd_channel_type) = 'it channel' or
#    lower(cmd_channel_type) = 'modern trade' or
#    lower(cmd_channel_type) = 'retail chain' or
#    lower(cmd_channel_type) = 'sales' or
#    lower(cmd_channel_type) = 'telecom' or
#    lower(cmd_channel_type) = 'telewiz shop') and lower(service_group) = 'voice') then 1 else 0 end)"
#    retail_stores_volume_of_voice_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
#                                                    lower(cmd_channel_type) = 'ais channel'  or
#                                                    lower(cmd_channel_type) = 'ais distribution' or
#    lower(cmd_channel_type) = 'asp shop' or
#    lower(cmd_channel_type) = 'corperate'  or
#    lower(cmd_channel_type) = 'dealer' or
#    lower(cmd_channel_type) = 'direct sale' or
#    lower(cmd_channel_type) = 'easy app' or
#    lower(cmd_channel_type) = 'it channel' or
#    lower(cmd_channel_type) = 'modern trade' or
#    lower(cmd_channel_type) = 'retail chain' or
#    lower(cmd_channel_type) = 'sales' or
#    lower(cmd_channel_type) = 'telecom' or
#    lower(cmd_channel_type) = 'telewiz shop') and lower(service_group) = 'voice') then offering_price else 0 end)"
#    retail_stores_number_of_voice_data_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
#                                                    lower(cmd_channel_type) = 'ais channel'  or
#                                                    lower(cmd_channel_type) = 'ais distribution' or
#    lower(cmd_channel_type) = 'asp shop' or
#    lower(cmd_channel_type) = 'corperate'  or
#    lower(cmd_channel_type) = 'dealer' or
#    lower(cmd_channel_type) = 'direct sale' or
#    lower(cmd_channel_type) = 'easy app' or
#    lower(cmd_channel_type) = 'it channel' or
#    lower(cmd_channel_type) = 'modern trade' or
#    lower(cmd_channel_type) = 'retail chain' or
#    lower(cmd_channel_type) = 'sales' or
#    lower(cmd_channel_type) = 'telecom' or
#    lower(cmd_channel_type) = 'telewiz shop') and lower(service_group) = 'voice+data') then 1 else 0 end)"
#    retail_stores_volume_of_voice_data_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'ais buddy' or
#                                                    lower(cmd_channel_type) = 'ais channel'  or
#                                                    lower(cmd_channel_type) = 'ais distribution' or
#    lower(cmd_channel_type) = 'asp shop' or
#    lower(cmd_channel_type) = 'corperate'  or
#    lower(cmd_channel_type) = 'dealer' or
#    lower(cmd_channel_type) = 'direct sale' or
#    lower(cmd_channel_type) = 'easy app' or
#    lower(cmd_channel_type) = 'it channel' or
#    lower(cmd_channel_type) = 'modern trade' or
#    lower(cmd_channel_type) = 'retail chain' or
#    lower(cmd_channel_type) = 'sales' or
#    lower(cmd_channel_type) = 'telecom' or
#    lower(cmd_channel_type) = 'telewiz shop') and lower(service_group) = 'voice+data') then offering_price else 0 end)"
#    # ---------------web portal -------------------
#    web_portal_number_of_main_transaction:  "sum(case when ((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
#    lower(cmd_channel_type) = 'eservice' or
#    lower(cmd_channel_type) = 'online'  or
#    lower(cmd_channel_type) = 'onlinestore' ) then 1 else 0 end)"
#    web_portal_volume_of_main_transaction:  "sum(case when ((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
#    lower(cmd_channel_type) = 'eservice' or
#    lower(cmd_channel_type) = 'online'  or
#    lower(cmd_channel_type) = 'onlinestore' ) then offering_price else 0 end)"
#
#    web_portal_number_of_data_activation_main_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
#    lower(cmd_channel_type) = 'eservice' or
#    lower(cmd_channel_type) = 'online'  or
#    lower(cmd_channel_type) = 'onlinestore' ) and lower(service_group) = 'data') then 1 else 0 end)"
#    web_portal_volume_of_data_activation_main_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
#    lower(cmd_channel_type) = 'eservice' or
#    lower(cmd_channel_type) = 'online'  or
#    lower(cmd_channel_type) = 'onlinestore' ) and lower(service_group) = 'data') then offering_price else 0 end)"
#    web_portal_number_of_voice_activation_main_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
#    lower(cmd_channel_type) = 'eservice' or
#    lower(cmd_channel_type) = 'online'  or
#    lower(cmd_channel_type) = 'onlinestore' ) and lower(service_group) = 'voice') then 1 else 0 end)"
#    web_portal_volume_of_voice_activation_main_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
#    lower(cmd_channel_type) = 'eservice' or
#    lower(cmd_channel_type) = 'online'  or
#    lower(cmd_channel_type) = 'onlinestore' ) and lower(service_group) = 'voice') then offering_price else 0 end)"
#    web_portal_number_of_voice_data_activation_main_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
#    lower(cmd_channel_type) = 'eservice' or
#    lower(cmd_channel_type) = 'online'  or
#    lower(cmd_channel_type) = 'onlinestore' ) and lower(service_group) = 'voice+data') then 1 else 0 end)"
#    web_portal_volume_of_voice_data_activation_main_transaction: "sum(case when (((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
#    lower(cmd_channel_type) = 'eservice' or
#    lower(cmd_channel_type) = 'online'  or
#    lower(cmd_channel_type) = 'onlinestore' ) and lower(service_group) = 'voice+data') then offering_price else 0 end)"
#
#    # -----------------ROM----------------
#    rom_number_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'rom') then 1 else 0 end)"
#    rom_volume_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'rom') then offering_price else 0 end)"
#    rom_number_of_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(service_group) = 'data') then 1 else 0 end)"
#    rom_volume_of_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(service_group) = 'data') then offering_price else 0 end)"
#    rom_number_of_voice_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(service_group) = 'voice') then 1 else 0 end)"
#    rom_volume_of_voice_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(service_group) = 'voice') then offering_price else 0 end)"
#    rom_number_of_voice_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(service_group) = 'voice+data') then 1 else 0 end)"
#    rom_volume_of_voice_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'rom' and lower(service_group) = 'voice+data') then offering_price else 0 end)"
#
#    # ------------------ AIS SHOP ---------------
#    ais_shop_number_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ais shop') then 1 else 0 end)"
#    ais_shop_volume_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ais shop') then offering_price else 0 end)"
#    ais_shop_number_of_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ais shop' and lower(service_group) = 'data') then 1 else 0 end)"
#    ais_shop_volume_of_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ais shop' and lower(service_group) = 'data') then offering_price else 0 end)"
#    ais_shop_number_of_voice_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ais shop' and lower(service_group) = 'voice') then 1 else 0 end)"
#    ais_shop_volume_of_voice_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ais shop' and lower(service_group) = 'voice') then offering_price else 0 end)"
#    ais_shop_number_of_voice_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ais shop' and lower(service_group) = 'voice+data') then 1 else 0 end)"
#    ais_shop_volume_of_voice_data_activation_main_transaction: "sum(case when (lower(cmd_channel_type) = 'ais shop' and lower(service_group) = 'voice+data') then offering_price else 0 end)"
#    # ----------------- mpay --------------------
#    mpay_number_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') then 1 else 0 end)"
#    mpay_volume_of_main_transaction: "sum(case when (lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') then offering_price else 0 end)"
#    mpay_number_of_data_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(service_group) = 'data') then 1 else 0 end)"
#    mpay_volume_of_data_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(service_group) = 'data') then offering_price else 0 end)"
#    mpay_number_of_voice_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(service_group) = 'voice') then 1 else 0 end)"
#    mpay_volume_of_voice_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(service_group) = 'voice') then offering_price else 0 end)"
#    mpay_number_of_voice_data_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(service_group) = 'voice+data') then 1 else 0 end)"
#    mpay_volume_of_voice_data_activation_main_transaction: "sum(case when ((lower(cmd_channel_type) = 'mpay' or lower(cmd_channel_type) = 'mpay station') and lower(service_group) = 'voice+data') then offering_price else 0 end)"
#
#  granularity: "start_of_week,subscription_identifier"
#
#
## ----------lastest ------------------
#l2_sales_feature_main_transactions_latest:
#  feature_list:
#    start_of_week: "start_of_week"
#    subscription_identifier: "subscription_identifier"
#
#    campaign_batch_pcm_other_name_of_latest_main_transaction: "first_value( (case when (lower(cmd_channel_type) = 'batch' or lower(cmd_channel_type) = 'pcm' or lower(cmd_channel_type) = 'webstaff') then offering_title else null end), true) over(partition by
#    start_of_week,
#    subscription_identifier
#    order by service_order_item_eff_dttm desc)"
#
#    ais_shop_name_of_latest_main_transaction: "first_value( (case when (lower(cmd_channel_type) = 'ais shop' ) then offering_title else null end), true) over(partition by
#    start_of_week,
#    subscription_identifier
#    order by service_order_item_eff_dttm desc)"
#
#    mpay_name_of_latest_main_transaction: "first_value( (case when (lower(cmd_channel_type) = 'mpay'  or lower(cmd_channel_type) = 'mpay station' ) then offering_title else null end), true) over(partition by
#    start_of_week,
#    subscription_identifier
#    order by service_order_item_eff_dttm desc)"
#
#    rom_name_of_latest_main_transaction: "first_value( (case when (lower(cmd_channel_type) = 'rom') then offering_title else null end), true) over(partition by
#    start_of_week,
#    subscription_identifier
#    order by service_order_item_eff_dttm desc)"
#
#    ussd_name_of_latest_main_transaction: "first_value( (case when (lower(cmd_channel_type) = 'ussd') then offering_title else null end), true) over(partition by
#    start_of_week,
#    subscription_identifier
#    order by service_order_item_eff_dttm desc)"
#
#    call_center_name_of_latest_main_transaction: "first_value( (case when (lower(cmd_channel_type) = 'call center' or lower(cmd_channel_type) = 'ivr' or  lower(cmd_channel_type) = 'ivr_acc' ) then offering_title else null end), true) over(partition by
#    start_of_week,
#    subscription_identifier
#    order by service_order_item_eff_dttm desc)"
#
#    my_ais_app_name_of_latest_main_transaction: "first_value( (case when (lower(cmd_channel_type) = 'online channel' and lower(cmd_channel_sub_type) = 'myais') then offering_title else null end), true) over(partition by
#    start_of_week,
#    subscription_identifier
#    order by service_order_item_eff_dttm desc)"
#
#    web_portal_name_of_latest_main_transaction: "first_value( (case when ((lower(cmd_channel_type) = 'online channel' and (lower(cmd_channel_sub_type) != 'myais' or lower(cmd_channel_sub_type) is null)) or
#    lower(cmd_channel_type) = 'eservice' or
#    lower(cmd_channel_type) = 'online'  or
#    lower(cmd_channel_type) = 'onlinestore' ) then offering_title else null end) , true) over(partition by
#    start_of_week,
#    subscription_identifier
#    order by service_order_item_eff_dttm desc)"
#
#    retail_stores_name_of_latest_main_transaction: "first_value( (case when (lower(cmd_channel_type) = 'ais buddy' or
#                                                    lower(cmd_channel_type) = 'ais channel'  or
#                                                    lower(cmd_channel_type) = 'ais distribution' or
#    lower(cmd_channel_type) = 'asp shop' or
#    lower(cmd_channel_type) = 'corperate'  or
#    lower(cmd_channel_type) = 'dealer' or
#    lower(cmd_channel_type) = 'direct sale' or
#    lower(cmd_channel_type) = 'easy app' or
#    lower(cmd_channel_type) = 'it channel' or
#    lower(cmd_channel_type) = 'modern trade' or
#    lower(cmd_channel_type) = 'retail chain' or
#    lower(cmd_channel_type) = 'sales' or
#    lower(cmd_channel_type) = 'telecom' or
#    lower(cmd_channel_type) = 'telewiz shop') then offering_title else null end), true) over(partition by
#    start_of_week,
#    subscription_identifier
#    order by service_order_item_eff_dttm desc)"
#
#  granularity: ""
#
#
#
#
