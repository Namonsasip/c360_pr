l4_loyalty_number_of_services_features:
  partition_by: ["subscription_identifier"]
  feature_list:
    sum: ["loyalty_services_total","loyalty_services_travel","loyalty_services_ais_rewards","loyalty_services_entertainment",
          "loyalty_services_food_and_drink","loyalty_services_lifestyle","loyalty_services_others"]
    avg: ["loyalty_services_total","loyalty_services_travel","loyalty_services_ais_rewards","loyalty_services_entertainment",
          "loyalty_services_food_and_drink","loyalty_services_lifestyle","loyalty_services_others"]
    max: ["loyalty_privilege_registered_date"]
  read_from: "l2"

l4_loyalty_number_of_rewards_redeemed_features:
  partition_by: ["subscription_identifier"]
  feature_list:
    sum: ["loyalty_rewards_total","loyalty_rewards_travel","loyalty_rewards_ais_rewards","loyalty_rewards_entertainment",
          "loyalty_rewards_food_and_drink","loyalty_rewards_lifestyle","loyalty_rewards_others"]
    avg: ["loyalty_rewards_total","loyalty_rewards_travel","loyalty_rewards_ais_rewards","loyalty_rewards_entertainment",
          "loyalty_rewards_food_and_drink","loyalty_rewards_lifestyle","loyalty_rewards_others"]
  read_from: "l2"

l4_loyalty_number_of_points_spend_features:
  partition_by: ["subscription_identifier"]
  feature_list:
    sum: ["loyalty_points_spend_total","loyalty_points_spend_travel","loyalty_points_spend_ais_rewards","loyalty_points_spend_entertainment",
          "loyalty_points_spend_food_and_drink","loyalty_points_spend_lifestyle","loyalty_points_spend_others"]
    avg: ["loyalty_points_spend_total","loyalty_points_spend_travel","loyalty_points_spend_ais_rewards","loyalty_points_spend_entertainment",
          "loyalty_points_spend_food_and_drink","loyalty_points_spend_lifestyle","loyalty_points_spend_others"]
  read_from: "l2"

l4_loyalty_priv_point_balance_statuses_features:
  partition_by: ["subscription_identifier"]
  feature_list:
    max: ["loyalty_points_total_balance", "loyalty_points_last_modified_date", "loyalty_points_last_expired_date",
    "loyalty_is_status_emerald", "loyalty_is_status_gold", "loyalty_is_status_platinum", "loyalty_is_status_ms_emerald",
    "loyalty_is_status_prospect_platinum", "loyalty_is_status_prospect_gold", "loyalty_is_status_platinum_plus",
    "loyalty_last_mobile_status_date", "loyalty_is_status_classic"]
    min: ["loyalty_points_total_balance", "loyalty_points_last_expired_date"]
  read_from: "l3"