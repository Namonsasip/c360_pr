l1_loyalty_number_of_services_daily:
    where_clause: "where event_partition_date is not null"
    feature_list:
        loyalty_services_total: "sum(case when mobile_no is not null then 1 else 0 end)"
        loyalty_services_travel: "sum(case when category in (545,565,116,124) then 1 else 0 end)"
        loyalty_services_ais_rewards: "sum(case when category in (10,11,17,27,125) then 1 else 0 end)"
        loyalty_services_entertainment: "sum(case when category in (30,97,100,100041) then 1 else 0 end)"
        loyalty_services_food_and_drink: "sum(case when category in (12,15,16,26,29,118,119,120,121,122,585) then 1 else 0 end)"
        loyalty_services_lifestyle: "sum(case when category in (13,28,117,126,127,129,130,131,132,133,134,501,505) then 1 else 0 end)"
        loyalty_services_others: "sum(case when category in (14,25,101,123,128,525) then 1 else 0 end)"
    granularity: "start_of_month,start_of_week,event_partition_date,access_method_num,register_date,subscription_identifier"

#l1_loyalty_number_of_rewards_daily:
#    where_clause: "where event_partition_date is not null and project_type_id = 6 and project_subtype like 'REDEEM%' and msg_event_id = 13"
#    feature_list:
#        loyalty_rewards_total: "sum(case when mobile_no is not null then 1 else 0 end)"
#        loyalty_rewards_travel: "sum(case when category in (545,565,116,124) then 1 else 0 end)"
#        loyalty_rewards_ais_rewards: "sum(case when category in (10,11,17,27,125) then 1 else 0 end)"
#        loyalty_rewards_entertainment: "sum(case when category in (30,97,100,100041) then 1 else 0 end)"
#        loyalty_rewards_food_and_drink: "sum(case when category in (12,15,16,26,29,118,119,120,121,122,585) then 1 else 0 end)"
#        loyalty_rewards_lifestyle: "sum(case when category in (13,28,117,126,127,129,130,131,132,133,134,501,505) then 1 else 0 end)"
#        loyalty_rewards_others: "sum(case when category in (14,25,101,123,128,525) then 1 else 0 end)"
#    granularity: "start_of_month,start_of_week,event_partition_date,access_method_num,register_date,subscription_identifier"

#l1_loyalty_number_of_points_spend_daily:
#    where_clause: "where event_partition_date is not null and project_type_id = 6 and project_subtype like 'REDEEM%' and msg_event_id = 13"
#    feature_list:
#        loyalty_points_spend_total: "sum(case when msisdn is not null then loyalty_points_spend else 0 end)"
#        loyalty_points_spend_travel: "sum(case when category in (545,565,116,124) then loyalty_points_spend else 0 end)"
#        loyalty_points_spend_ais_rewards: "sum(case when category in (10,11,17,27,125) then loyalty_points_spend else 0 end)"
#        loyalty_points_spend_entertainment: "sum(case when category in (30,97,100,100041) then loyalty_points_spend else 0 end)"
#        loyalty_points_spend_food_and_drink: "sum(case when category in (12,15,16,26,29,118,119,120,121,122,585) then loyalty_points_spend else 0 end)"
#        loyalty_points_spend_lifestyle: "sum(case when category in (13,28,117,126,127,129,130,131,132,133,134,501,505) then loyalty_points_spend else 0 end)"
#        loyalty_points_spend_others: "sum(case when category in (14,25,101,123,128,525) then loyalty_points_spend else 0 end)"
#    granularity: "start_of_month,start_of_week,event_partition_date,access_method_num,register_date,subscription_identifier"


l1_loyalty_number_of_rewards_daily:
    where_clause: "where event_partition_date is not null"
    feature_list:
        loyalty_rewards_total: "sum(case when mobile_no is not null then 1 else 0 end)"
        loyalty_rewards_travel: "sum(case when category in (545,565,116,124) then 1 else 0 end)"
        loyalty_rewards_ais_rewards: "sum(case when category in (10,11,17,27,125) then 1 else 0 end)"
        loyalty_rewards_entertainment: "sum(case when category in (30,97,100,100041) then 1 else 0 end)"
        loyalty_rewards_food_and_drink: "sum(case when category in (12,15,16,26,29,118,119,120,121,122,585) then 1 else 0 end)"
        loyalty_rewards_lifestyle: "sum(case when category in (13,28,117,126,127,129,130,131,132,133,134,501,505) then 1 else 0 end)"
        loyalty_rewards_others: "sum(case when category in (14,25,101,123,128,525) then 1 else 0 end)"
    granularity: "start_of_month,start_of_week,event_partition_date,access_method_num,register_date,subscription_identifier"



l1_loyalty_number_of_points_spend_daily:
    where_clause: "where event_partition_date is not null"
    feature_list:
        loyalty_points_spend_total: "sum(case when msisdn is not null then loyalty_points_spend else 0 end)"
        loyalty_points_spend_travel: "sum(case when category in (545,565,116,124) then loyalty_points_spend else 0 end)"
        loyalty_points_spend_ais_rewards: "sum(case when category in (10,11,17,27,125) then loyalty_points_spend else 0 end)"
        loyalty_points_spend_entertainment: "sum(case when category in (30,97,100,100041) then loyalty_points_spend else 0 end)"
        loyalty_points_spend_food_and_drink: "sum(case when category in (12,15,16,26,29,118,119,120,121,122,585) then loyalty_points_spend else 0 end)"
        loyalty_points_spend_lifestyle: "sum(case when category in (13,28,117,126,127,129,130,131,132,133,134,501,505) then loyalty_points_spend else 0 end)"
        loyalty_points_spend_others: "sum(case when category in (14,25,101,123,128,525) then loyalty_points_spend else 0 end)"
    granularity: "start_of_month,start_of_week,event_partition_date,access_method_num,register_date,subscription_identifier"
