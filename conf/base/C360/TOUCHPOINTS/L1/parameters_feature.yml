l1_touchpoints_to_call_center_features:
  # AIS 1175 and AIS-SRN 1148
  where_clause: "where called_no = 'hYAUKs+f31uJzUZp3iM5F.fO8CgW7107gM602izDqDn.6GjSvNd8lhU6af7ItzfP' or
                called_no = '98MkP5bMx1ykVd8RBE3C.XztcSxOJmjcyHAUmXwvCHW2Bb+cKKwh1kqv0.QI4ddw'"
  feature_list:
    number_of_calls_on_cc: "sum(total_successful_call)"
    duration_of_calls_on_cc: "sum(total_durations)"
  granularity: "caller_no, day_id"
  event_date_column: "date(day_id)"
  join_column_with_cust_profile:
    access_method_num: caller_no
    event_partition_date: event_partition_date
  partition_num_per_job: 60
  output_catalog: "l1_touchpoints_to_call_center_features"


l1_touchpoints_from_call_center_features:
  # AIS 1175 and AIS-SRN 1148
  where_clause: "where caller_no = 'hYAUKs+f31uJzUZp3iM5F.fO8CgW7107gM602izDqDn.6GjSvNd8lhU6af7ItzfP' or
                 caller_no = '98MkP5bMx1ykVd8RBE3C.XztcSxOJmjcyHAUmXwvCHW2Bb+cKKwh1kqv0.QI4ddw'"
  feature_list:
    number_of_calls_from_cc: "sum(total_successful_call)"
    duration_of_calls_from_cc: "sum(total_durations)"
  granularity: "called_no, day_id"
  event_date_column: "date(day_id)"
  join_column_with_cust_profile:
    access_method_num: called_no
    event_partition_date: event_partition_date
  partition_num_per_job: 60
  output_catalog: "l1_touchpoints_from_call_center_features"

l1_touchpoints_nim_work_features:
  where_clause: "where mobilenumber is not null"
  feature_list:
    num_of_commercial_question_with_cc: "count(distinct(case when lower(InteractionType) like '%phone%'
                                          or lower(InteractionType) = 'voice' then caseID else null end))"
    num_of_claims_with_cc: "count(distinct(case when lower(InteractionType) like '%phone%'
                                          or lower(InteractionType) = 'voice' then tt_caseID else null end))"
    num_of_consultation_with_cc: "sum(case when lower(topic) like '%information%'
                                  and (lower(InteractionType) like '%phone%' or lower(InteractionType) = 'voice') then 1 else 0 end)"

    num_of_commercial_question_in_store: "count(distinct(case when lower(InteractionType) like '%offline%' then caseID else null end))"
    num_of_claims_in_store: "count(distinct(case when lower(InteractionType) like '%offline%' then tt_caseID else null end))"
    num_of_consultation_in_store: "sum(case when lower(topic) like '%information%' and lower(InteractionType) like '%offline%' then 1 else 0 end)"

    num_of_commercial_question_with_chatbot: "count(distinct(case when lower(InteractionType) like '%bot%' then caseID else null end))"
    num_of_claims_with_chatbot: "count(distinct(case when lower(InteractionType) like '%bot%' then tt_caseID else null end))"
    num_of_consultation_with_chatbot: "sum(case when lower(topic) like '%information%' and lower(InteractionType) like '%bot%' then 1 else 0 end)"
    num_of_chatbot_visit: "sum(case when lower(InteractionType) like '%bot%' then 1 else 0 end)"
    num_of_days_with_chatbot: "case when sum(case when lower(InteractionType) like '%bot%' then 1 else 0 end) > 0 then 1 else 0 end"

    num_of_commercial_question_with_ais_app: "count(distinct(case when lower(InteractionType) like '%my%ais%' then caseID else null end))"
    num_of_claims_with_ais_app: "count(distinct(case when lower(InteractionType) like '%my%ais%' then tt_caseID else null end))"
    num_of_consultation_with_ais_app: "sum(case when lower(topic) like '%information%' and lower(InteractionType) like '%my%ais%' then 1 else 0 end)"
    num_of_days_with_ais_app: "case when sum(case when lower(InteractionType) like '%my%ais%' then 1 else 0 end) > 0 then 1 else 0 end"


    num_of_commercial_question_online: "count(distinct(case when lower(InteractionType) like '%email%'
                                                                 or lower(InteractionType) like '%facebook%'
                                                                 or lower(InteractionType) like '%instagram%'
                                                                 or lower(InteractionType) like '%pantip%'
                                                                 or lower(InteractionType) like '%social%'
                                                                 or lower(InteractionType) like '%twitter%'
                                                                 or lower(InteractionType) like '%youtube%' then caseID else null end))"
    num_of_claims_with_online: "count(distinct(case when lower(InteractionType) like '%email%'
                                                         or lower(InteractionType) like '%facebook%'
                                                         or lower(InteractionType) like '%instagram%'
                                                         or lower(InteractionType) like '%pantip%'
                                                         or lower(InteractionType) like '%social%'
                                                         or lower(InteractionType) like '%twitter%'
                                                         or lower(InteractionType) like '%youtube%' then tt_caseID else null end))"
    num_of_consultation_online: "sum(case when lower(topic) like '%information%' and (lower(InteractionType) like '%email%'
                                                        or lower(InteractionType) like '%facebook%'
                                                        or lower(InteractionType) like '%instagram%'
                                                        or lower(InteractionType) like '%pantip%'
                                                        or lower(InteractionType) like '%social%'
                                                        or lower(InteractionType) like '%twitter%'
                                                        or lower(InteractionType) like '%youtube%') then 1 else 0 end)"
  granularity: "mobilenumber, partition_date"
  event_date_column: "to_date(cast(partition_date as string), 'yyyyMMdd')"
  join_column_with_cust_profile:
    access_method_num: mobilenumber
    event_partition_date: event_partition_date
  partition_num_per_job: 60
  output_catalog: "l1_touchpoints_nim_work_features"
