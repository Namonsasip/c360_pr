l4_geo_time_spent_by_location:
  partition_by: ["imsi, location_id"]
  feature_list:
    sum: ["duration", "num_visit"]
  read_from: "l2"

l4_geo_time_spent_by_store:
  partition_by: ["imsi, location_id, landmark_sub_name_en, location_name, landmark_cat_name_en"]
  feature_list:
    sum: ["duration", "num_visit"]
  read_from: "l2"

l4_geo_count_visit_by_location:
  partition_by: ["imsi, location_id"]
  feature_list:
    sum: ["count_location_id", "count_distinct_location_id", "count_cell_id"]
  read_from: "l2"

l4_geo_home_work_location_id:
  where_clause: ""
  feature_list:
    imsi: "imsi"
    start_of_month: "start_of_month"
    home_location_id_weekday: "home_location_id_weekday"
    home_latitude_weekday: "home_latitude_weekday"
    home_longitude_weekday: "home_longitude_weekday"
    home_location_id_weekend: "home_location_id_weekend"
    home_latitude_weekend: "home_latitude_weekend"
    home_longitude_weekend: "home_longitude_weekend"
    work_location_id: "work_location_id"
    work_latitude: "work_latitude"
    work_longitude: "work_longitude"
  granularity: ""

l4_geo_top3_visit_exclude_hw:
  where_clause: ""
  feature_list:
    imsi: "imsi"
    start_of_month: "start_of_month"
    top_location_1st: "top_location_1st"
    top_location_2nd: "top_location_2nd"
    top_location_3rd: "top_location_3rd"
    top_location_1st_weekday: "top_location_1st_weekday"
    top_location_2nd_weekday: "top_location_2nd_weekday"
    top_location_3rd_weekday: "top_location_3rd_weekday"
    top_location_1st_weekend: "top_location_1st_weekend"
    top_location_2nd_weekend: "top_location_2nd_weekend"
    top_location_3rd_weekend: "top_location_3rd_weekend"
    same_fav_weekday_and_weekend: "same_fav_weekday_and_weekend"
  granularity: ""

l4_geo_work_area_center_average:
  where_clause: ""
  feature_list:
    imsi: "imsi"
    start_of_month: "start_of_month"
    avg_work_latitude: "avg_work_latitude"
    avg_work_longitude: "avg_work_longitude"
    work_latitude: "work_latitude"
    work_longitude: "work_longitude"
    radius: "radius"
  granularity: ""

l4_geo_home_weekday_city_citizens:
  partition_by: ["region_name", "province_name", "district_name", "sub_district_name", "home_location_id_weekday"]
  feature_list:
    sum: ["citizens"]
    avg: ["citizens"]
    max: ["citizens"]
    min: ["citizens"]
  read_from: "l3"

l4_geo_total_distance_km:
  partition_by: ["imsi"]
  feature_list:
    sum: ["distance_km_weekday", "distance_km_weekend", "distance_km_total"]
  read_from: "l2"

l4_geo_visit_ais_store_location:
  where_clause: ""
  feature_list:
    imsi: "imsi"
    start_of_month: "start_of_month"
    last_visit_ais_shop: "last_visit_ais_shop"
    count_visit_ais_shop: "count_visit_ais_shop"
    duration_visit_ais_shop: "duration_visit_ais_shop"
    landmark_name_th_near_home_weekday: "landmark_name_th_near_home_weekday"
    landmark_sub_name_en_near_home_weekday: "landmark_sub_name_en_near_home_weekday"
    landmark_latitude_near_home_weekday: "landmark_latitude_near_home_weekday"
    landmark_longitude_near_home_weekday: "landmark_longitude_near_home_weekday"
    landmark_name_th_near_home_weekend: "landmark_name_th_near_home_weekend"
    landmark_sub_name_en_near_home_weekend: "landmark_sub_name_en_near_home_weekend"
    landmark_latitude_near_home_weekend: "landmark_latitude_near_home_weekend"
    landmark_longitude_near_home_weekend: "landmark_longitude_near_home_weekend"
    landmark_name_th_near_work: "landmark_name_th_near_work"
    landmark_sub_name_en_near_work: "landmark_sub_name_en_near_work"
    landmark_latitude_near_work: "landmark_latitude_near_work"
    landmark_longitude_near_work: "landmark_longitude_near_work"
    landmark_name_th_near_1st: "landmark_name_th_near_1st"
    landmark_sub_name_en_near_1st: "landmark_sub_name_en_near_1st"
    landmark_latitude_near_1st: "landmark_latitude_near_1st"
    landmark_longitude_near_1st: "landmark_longitude_near_1st"
    landmark_name_th_near_2nd: "landmark_name_th_near_2nd"
    landmark_sub_name_en_near_2nd: "landmark_sub_name_en_near_2nd"
    landmark_latitude_near_2nd: "landmark_latitude_near_2nd"
    landmark_longitude_near_2nd: "landmark_longitude_near_2nd"
    landmark_name_th_near_3rd: "landmark_name_th_near_3rd"
    landmark_sub_name_en_near_3rd: "landmark_sub_name_en_near_3rd"
    landmark_latitude_near_3rd: "landmark_latitude_near_3rd"
    landmark_longitude_near_3rd: "landmark_longitude_near_3rd"
  granularity: ""

l4_geo_top3_voice_location:
  where_clause: ""
  feature_list:
    access_method_num: "access_method_num"
    start_of_week: "start_of_week"
    start_of_month: "start_of_month"
    top_voice_location_1st: "top_voice_location_id_1st"
    top_voice_latitude_1st: "top_voice_latitude_1st"
    top_voice_longitude_1st: "top_voice_longitude_1st"
    top_voice_location_id_2nd: "top_voice_location_id_2nd"
    top_voice_latitude_2nd: "top_voice_latitude_2nd"
    top_voice_longitude_2nd: "top_voice_longitude_2nd"
    top_voice_location_id_3rd: "top_voice_location_id_3rd"
    top_voice_latitude_3rd: "top_voice_latitude_3rd"
    top_voice_longitude_3rd: "top_voice_longitude_3rd"
    distance_2nd_voice_location: "distance_2nd_voice_location"
    distance_3rd_voice_location: "distance_3rd_voice_location"
  granularity: ""

#=================================================================================================
#=================================================================================================
#=================================================================================================

###Traffic_fav_location###
l4_geo_use_traffic_home_work_weekly:
  partition_by: ["imsi"]
  feature_list:
    sum: ["Home_traffic_KB","Work_traffic_KB","Top1_location_traffic_KB","Top2_location_traffic_KB","share_Home_traffic_KB","share_Work_traffic_KB","share_Top1_location_traffic_KB","share_Top2_location_traffic_KB"]
  read_from: "l3"


###feature_sum_voice_location###
l4_geo_call_home_work_location:
  partition_by: ["imsi"]
  feature_list:
    sum: ["call_count_location_home_weekday","call_count_location_work","call_count_location_top_1st","call_count_location_top_2nd"]
  read_from: "l3"


### Number of Unique Cells Used ###
l4_geo_number_unique_cell_used:
  where_clause: ""
  feature_list:
    mobile_no: "mobile_no"
    avg_duration: "avg_duration"
    max_duration: "max_duration"
    min_duration: "min_duration"
    sum_duration: "sum_duration"
  granularity: ""

###Top_3_cells_on_voice_usage###
l4_geo_top3_cells_on_voice_usage:
  partition_by: ["imsi","rnk","latitude","longitude"]
  feature_list:
    sum: ["total_call"]
  read_from: "l2"


###distance_top_call###
l4_geo_distance_top_call:
  partition_by: ["imsi"]
  feature_list:
    avg: ["avg_distance_top_call"]
    max: ["max_distance_top_call"]
    min: ["min_distance_top_call"]
    sum: ["sd_distance_top_call","sum_distance_top_call"]
  read_from: "l2"


###Distance between nearest store and most visited store###
l4_geo_range_from_most_visited:
  where_clause: ""
  feature_list:
    imsi: "imsi"
    weekday_home_id:  "home_weekday_location_id"
    nearest_branch_name: "near_location"
    nearest_branch_loc_id:  "near_location_id"
    most_visit_branch_name: "most_location"
    most_visit_branch_id: "most_location_id"
    range_from_near_to_most_visit: "range_diff"
    partition_month:  "partition_month"


###Number of used most###
l4_area_from_number_of_used_most_frequent_weekdays:
  where_clause: ""
  feature_list:
    mobile_no: "mobile_no"
    start_of_week: "start_of_week"
    avg_distance_km:  "avg_distance_km"
    max_distance_km:  "max_distance_km"
    min_distance_km:  "min_distance_km"
    sum_distance_km: "sum_distance_km"
  granularity: ""

l4_area_from_number_of_used_most_frequent_weekends:
  where_clause: ""
  feature_list:
    mobile_no: "mobile_no"
    start_of_week: "start_of_week"
    avg_distance_km:  "avg_distance_km"
    max_distance_km:  "max_distance_km"
    min_distance_km:  "min_distance_km"
    sum_distance_km: "sum_distance_km"
  granularity: ""


#============== Number of used most frequent top 5 =====================
l4_area_from_number_of_used_most_frequent_top_5:
  where_clause: ""
  feature_list:
    mobile_no: "mobile_no"
    event_partition_date:  "event_partition_date"
    sum_all_no_of_call_weekend:  "sum_all_no_of_call_all"
    avg_all_no_of_call_weekend:  "avg_all_no_of_call_all"
    max_all_no_of_call_weekend: "max_all_no_of_call_all"
    min_all_no_of_call_weekend: "min_all_no_of_call_all"
  granularity: ""

l4_area_from_number_of_used_most_frequent_top_5_weekday:
  where_clause: ""
  feature_list:
    mobile_no: "mobile_no"
    event_partition_date:  "event_partition_date"
    sum_all_no_of_call_weekend:  "sum_all_no_of_call_weekday"
    avg_all_no_of_call_weekend:  "avg_all_no_of_call_weekday"
    max_all_no_of_call_weekend: "max_all_no_of_call_weekday"
    min_all_no_of_call_weekend: "min_all_no_of_call_weekday"
  granularity: ""

l4_area_from_number_of_used_most_frequent_top_5_weekend:
  where_clause: ""
  feature_list:
    mobile_no: "mobile_no"
    event_partition_date:  "event_partition_date"
    sum_all_no_of_call_weekend:  "sum_all_no_of_call_weekend"
    avg_all_no_of_call_weekend:  "avg_all_no_of_call_weekend"
    max_all_no_of_call_weekend: "max_all_no_of_call_weekend"
    min_all_no_of_call_weekend: "min_all_no_of_call_weekend"
  granularity: ""

###Traffic_fav_location###
int_l4_geo_use_traffic_home_work_weekly:
  where_clause: ""
  feature_list:
    Home_traffic_KB: "sum(Home_traffic_KB)"
    Work_traffic_KB: "sum(Work_traffic_KB)"
    Top1_location_traffic_KB: "sum(Top1_location_traffic_KB)"
    Top2_location_traffic_KB: "sum(Top2_location_traffic_KB)"
    share_Home_traffic_KB: "(sum(Home_traffic_KB)*100)/(sum(Home_traffic_KB)+sum(Work_traffic_KB)+sum(Top1_location_traffic_KB)+sum(Top2_location_traffic_KB))"
    share_Work_traffic_KB: "(sum(Work_traffic_KB)*100)/(sum(Home_traffic_KB)+sum(Work_traffic_KB)+sum(Top1_location_traffic_KB)+sum(Top2_location_traffic_KB))"
    share_Top1_location_traffic_KB: "(sum(Top1_location_traffic_KB)*100)/(sum(Home_traffic_KB)+sum(Work_traffic_KB)+sum(Top1_location_traffic_KB)+sum(Top2_location_traffic_KB))"
    share_Top2_location_traffic_KB: "(sum(Top2_location_traffic_KB)*100)/(sum(Home_traffic_KB)+sum(Work_traffic_KB)+sum(Top1_location_traffic_KB)+sum(Top2_location_traffic_KB))"
  granularity: "imsi, start_of_month"