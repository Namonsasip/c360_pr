name_all_feature:
  weekly:
    l4_geo_time_spent_by_location: ""
    l4_geo_time_spent_by_store: ""
    l4_geo_total_distance_km: ""
    l4_geo_count_visit_by_location: ""
    l4_geo_top3_voice_location: ""
    l4_geo_data_session_location: ""
  monthly:
    l4_geo_top3_visit_exclude_hw: ""
    l4_geo_home_work_location_id: ""
    l4_geo_work_area_center_average: ""
    l4_geo_home_weekday_city_citizens: ""

#---------------------l4_geo_time_spent_by_location--------------------------------------
l4_geo_time_spent_by_location:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_time_spent_by_location/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#------------------------l4_geo_time_spent_by_store--------------------------------------
l4_geo_time_spent_by_store:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_time_spent_by_store/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#------------------------l4_geo_total_distance_km--------------------------------------
l4_geo_total_distance_km:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_total_distance_km/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#------------------------l4_geo_count_visit_by_location-----------------------------------
l4_geo_count_visit_by_location:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_count_visit_by_location/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_monthly'

#------------------------l4_geo_top3_voice_location-----------------------------------
l4_geo_top3_voice_location:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_top3_voice_location/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_monthly'

#------------------------l4_geo_data_session_location-----------------------------------
l4_geo_data_session_location:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_data_session_location/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_monthly'

#------------------------l4_geo_top3_visit_exclude_hw-----------------------------------
l4_geo_top3_visit_exclude_hw:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_top3_visit_exclude_hw/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_month"
    read_layer: 'l3_monthly'
    target_layer: 'l4_monthly'

#------------------------l4_geo_home_work_location_id-----------------------------------
l4_geo_home_work_location_id:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_home_work_location_id/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_month"
    read_layer: 'l3_monthly'
    target_layer: 'l4_monthly'

#------------------------l4_geo_work_area_center_average-----------------------------------
l4_geo_work_area_center_average:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_work_area_center_average/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_month"
    read_layer: 'l3_monthly'
    target_layer: 'l4_monthly'

#------------------------l4_geo_home_weekday_city_citizens-----------------------------------
l4_geo_home_weekday_city_citizens:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_home_weekday_city_citizens/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_month"
    read_layer: 'l3_monthly'
    target_layer: 'l4_monthly'











#====================================================================================================
#====================================================================================================
#====================================================================================================

#-----------------Traffic_fav_location------------------------------------------
l4_geo_use_traffic_home_work_most:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_use_traffic_most_location_most/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'yes'
    mode: "overwrite"
    partitionBy: "start_of_month"
    read_layer: 'l3_monthly'
    target_layer: 'l4_monthly'

#--------------------feature_sum_voice_location---------------------------------------
l4_geo_call_location_home_work_weekly:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_call_location_home_work_weekly/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#-------------------------Number of Unique Cells Used----------------------------------
l4_geo_number_unique_cell_used:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_number_unique_cell_used/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "event_partition_date"
    read_layer: 'l0_daily'
    target_layer: 'l4_weekly'
