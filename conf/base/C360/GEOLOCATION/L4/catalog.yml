#---------------------l4_geo_time_spent_by_location--------------------------------------
l4_geo_time_spent_by_location:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_time_spent_by_location/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#-------------------l4_geo_area_from_ais_store----------------------------------------
l4_geo_area_from_ais_store:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_area_from_ais_store/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#------------------l4_geo_area_from_competitor_store-----------------------------------------
l4_geo_area_from_competitor_store:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_area_from_competitor_store/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#------------------------Home and Work feature-----------------------------------
l4_geo_home_work_location_id:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_home_work_location_id/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_month"
    read_layer: 'l3_monthly'
    target_layer: 'l4_monthly'


#------------------------l4_geo_work_area_center_average-----------------------------------
l4_geo_work_area_center_average:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_work_area_center_average/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_month"
    read_layer: 'l0_daily'
    target_layer: 'l4_monthly'


#------------------------l4_geo_top_visit_exclude_homework-----------------------------------
l4_geo_top_visit_exclude_homework:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_top_visit_exclude_homework/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_month"
    read_layer: 'l3_monthly'
    target_layer: 'l4_monthly'

#---------------------l4_geo_home_weekday_city_citizens--------------------------------------
l4_geo_home_weekday_city_citizens:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_home_weekday_city_citizens/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_month"
    read_layer: 'l3_monthly'
    target_layer: 'l4_monthly'

#------------------------total_distance_km-----------------------------------
l4_geo_total_distance_km:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_total_distance_km/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l4_monthly'
    target_layer: 'l4_monthly'

#----------------l4_geo_cust_subseqently_distance-------------------------------------------
l4_geo_cust_subseqently_distance:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_cust_subseqently_distance/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#-----------------Traffic_fav_location------------------------------------------
l4_geo_use_traffic_home_work_most:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_use_traffic_most_location_most/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'yes'
    mode: "overwrite"
    partitionBy: "start_of_month"
    read_layer: 'l3_monthly'
    target_layer: 'l4_monthly'

#----------------------Number_of_base_station-------------------------------------
l4_geo_number_of_base_station:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_number_of_base_station/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#--------------------feature_sum_voice_location---------------------------------------
l4_geo_call_location_home_work_weekly:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_call_location_home_work_weekly/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#-------------------------Number of Unique Cells Used----------------------------------
l4_geo_number_unique_cell_used:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_number_unique_cell_used/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "event_partition_date"
    read_layer: 'l0_daily'
    target_layer: 'l4_weekly'

#----------------------feature_AIS_store-------------------------------------
l4_geo_last_AIS_store_visit:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_last_AIS_store_visit/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "partition_month"
    read_layer: 'l1_daily'
    target_layer: 'l4_monthly'

l4_geo_most_AIS_store_visit:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_most_AIS_store_visit/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "partition_month"
    read_layer: 'l1_daily'
    target_layer: 'l4_monthly'

l4_geo_store_close_to_home:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_store_close_to_home/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_month"
    read_layer: 'l1_daily'
    target_layer: 'l4_monthly'
  load_args:
    increment_flag: 'no'

l4_geo_store_close_to_work:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_store_close_to_work/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_month"
    read_layer: 'l1_daily'
    target_layer: 'l4_monthly'

#---------------------------op_3_cells_on_voice_usage--------------------------------
l4_geo_top3_cells_on_voice_usage:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_home_work_location_id/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#---------------------------distance_top_call#--------------------------------
l4_geo_distance_top_call:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_distance_top_call/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'

#-------------------------Distance between nearest store and most visited store----------------------------------
l4_geo_range_from_most_visited:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_store_diff_range/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "partition_month"
    read_layer: 'l1_daily'
    target_layer: 'l4_monthly'

#-----------------------27 Same favourite location for weekend and weekday------------------------------------
l4_same_favourite_location_weekend_weekday_weekly:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_same_favourite_location_weekend_weekday_weekly/
  file_format: parquet
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l2_weekly'
    target_layer: 'l4_weekly'



#------------------47 Same favourite location for weekend and weekday-----------------------------------------
l4_the_favourite_locations_daily:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_favourite_locations_daily/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "event_partition_date"
    read_layer: 'l1_daily'
    target_layer: 'l4_daily'

#--------------------48 The most frequently used Location for data sessions on weekdays (Mon to Fri)---------------------------------------
l4_the_most_frequently_location_weekdays:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_most_frequently_location_weekdays/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'

#----------------------49 The most frequently used Location for data sessions on weekdays (Mon to Fri) is 4G flag-------------------------------------
l4_the_most_frequently_location_weekdays_4g:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_most_frequently_location_weekdays_4g/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'

#-------------------50 The most frequently used Location for data sessions on weekends----------------------------------------
l4_the_most_frequently_location_weekends:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_most_frequently_location_weekends/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'

#-------------------------51 The most frequently used Location for data sessions on weekends is 4G flag----------------------------------
l4_the_most_frequently_location_weekends_4g:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_most_frequently_location_weekends_4g/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'

#-----------------------52 The most frequently used Location for data sessions------------------------------------
l4_the_most_frequently_location:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_most_frequently_location/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'

#---------------------53 The most frequently used Location for data sessions is 4G flag--------------------------------------
l4_the_most_frequently_location_4g:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_most_frequently_location_4g/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'

#------------------------54 The second most frequently used cell for data sessions on weekdays (Mon to Fri)-----------------------------------
l4_the_second_frequently_location_weekdays:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_second_frequently_location_weekdays/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'

#-------------------------55 The second most frequently used cell for data sessions on weekdays (Mon to Fri) is 4G flag----------------------------------
l4_the_second_frequently_location_weekdays_4g:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_second_frequently_location_weekdays_4g/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'

#------------------------56 The second most frequently used cell for data sessions on weekends-----------------------------------
l4_the_second_frequently_location_weekends:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_second_frequently_location_weekends/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'
#----------------------------57 The second most frequently used cell for data sessions on weekends is 4G flag-------------------------------
l4_the_second_frequently_location_weekends_4g:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_second_frequently_location_weekends_4g/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'

#-------------------------58 The second most frequently used cell for data sessions----------------------------------
l4_the_second_frequently_location:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_second_frequently_location/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'

#---------------------------59 The second most frequently used cell for data sessions is 4G flag--------------------------------
l4_the_second_frequently_location_4g:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/the_second_frequently_location_4g/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy:  "start_of_week"
    read_layer: 'l1_daily'
    target_layer: 'l4_weekly'

#------------------------Number of used most frequent-----------------------------------
l4_geo_from_number_of_used_most_frequent_weekdays:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_from_number_of_used_most_frequent_weekdays/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l4_weekly'
    target_layer: 'l4_weekly'

l4_geo_from_number_of_used_most_frequent_weekends:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_from_number_of_used_most_frequent_weekends/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_week"
    read_layer: 'l4_weekly'
    target_layer: 'l4_weekly'

#-------------------------Number of used most frequent top five----------------------------------
l4_geo_number_most_frequent_top_five:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: /mnt/customer360-blob-output/C360/GEO/l4_features/geo_number_most_frequent_top_five/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "event_partition_date"
    read_layer: 'l4_weekly'
    target_layer: 'l4_weekly'

l4_geo_number_most_frequent_top_five_weekdays:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_number_most_frequent_top_five_weekdays/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "event_partition_date"
    read_layer: 'l1_daily'
    target_layer: 'l4_daily'

l4_geo_number_most_frequent_top_five_weekends:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/geo_number_most_frequent_top_five_weekends/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "event_partition_date"
    read_layer: 'l1_daily'
    target_layer: 'l4_daily'

l4_geo_call_home_work_location:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: base_path/GEO/l4_features/l4_geo_call_home_work_location/
  file_format: parquet
  metadata_table_path: 'metadata_path'
  save_args:
    increment_flag: 'no'
    mode: "overwrite"
    partitionBy: "start_of_month"
    read_layer: 'l3_monthly'
    target_layer: 'l4_monthly'
