
##HDFS : Footfall
#l0_geo_footfall_daily:
#  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
#  filepath: /mnt/customer360-blob-data/C360/GEO/dataspark_footfall_daily
#  file_format: parquet
#
##  unused ?
#l0_geo_tdr_roaming_info:
#  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
#  filepath: /mnt/customer360-blob-data/C360/GEO/geo_tdr_roaming_info/
#  file_format: parquet
#
##GEO.GEO_MST_CELL_MASTERPLAN    Cloud : C360/GEO/mst_cell_masterplan
#l0_mst_cell_masterplan:
#  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
#  filepath: /mnt/customer360-blob-data/C360/GEO/mst_cell_masterplan/
#  file_format: parquet
#
## geo.lm_poi_master
#l0_mst_poi_location:
#  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
#  filepath: /mnt/customer360-blob-data/C360/GEO/mst_poi_location/    # REAL DATA IN PROGRESS
#  file_format: parquet
#
#
## HDFS : Homework
#l0_locals_homework:
#  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
#  filepath: /mnt/customer360-blob-data/C360/GEO/locals_homework_new/
#  file_format: parquet

################# catalog for incremental added below

l0_geo_footfall_daily_for_l1_int_geo_cust_cell_visit_time_daily:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: /mnt/customer360-blob-data/C360/GEO/dataspark_footfall_daily
  file_format: parquet
  metadata_table_path: '/mnt/customer360-blob-output/C360/metadata_table/'
  load_args:
    increment_flag: 'yes'
    lookup_table_name: 'l1_int_geo_cust_cell_visit_time_daily'
    read_layer: 'l0_daily'
    target_layer: 'l1_daily'
    lookback: '0'


l0_geo_footfall_daily_for_l1_geo_number_of_location_with_transactions:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: /mnt/customer360-blob-data/C360/GEO/dataspark_footfall_daily
  file_format: parquet
  metadata_table_path: '/mnt/customer360-blob-output/C360/metadata_table/'
  load_args:
    increment_flag: 'yes'
    lookup_table_name: 'l1_geo_number_of_location_with_transactions'
    read_layer: 'l0_daily'
    target_layer: 'l1_daily'
    lookback: '0'

l0_mst_cell_masterplan_for_l1_geo_number_of_location_with_transactions:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: /mnt/customer360-blob-data/C360/GEO/mst_cell_masterplan
  file_format: parquet
  metadata_table_path: '/mnt/customer360-blob-output/C360/metadata_table/'
  load_args:
    increment_flag: 'yes'
    lookup_table_name: 'l1_geo_number_of_location_with_transactions'
    read_layer: 'l0_daily'
    target_layer: 'l1_daily'
    lookback: '0'

l0_usage_sum_voice_location_daily_for_l1_geo_voice_distance_daily_intermediate:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: /mnt/customer360-blob-data/C360/USAGE/usage_sum_voice_location_daily/
  file_format: parquet
  metadata_table_path: '/mnt/customer360-blob-output/C360/metadata_table/'
  load_args:
    increment_flag: 'yes'
    lookup_table_name: 'l1_geo_voice_distance_daily_intermediate'
    read_layer: 'l0_daily'
    target_layer: 'l1_daily'
    lookback: '0'

l0_usage_sum_data_location_daily_for_l1_geo_first_data_session_cell_identifier_daily:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: /mnt/customer360-blob-data/C360/USAGE/usage_sum_data_location_daily/
  file_format: parquet
  metadata_table_path: '/mnt/customer360-blob-output/C360/metadata_table/'
  load_args:
    increment_flag: 'yes'
    lookup_table_name: 'l1_geo_first_data_session_cell_identifier_daily'
    read_layer: 'l0_daily'
    target_layer: 'l1_daily'
    lookback: '0'

l0_usage_sum_data_location_daily_for_l1_geo_usage_sum_data_location_dow_intermediate:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: /mnt/customer360-blob-data/C360/USAGE/usage_sum_data_location_daily/partition_date=20191101/940d105df92a7b7-9a6fa7d200000000_1574365341_data.0.parq
  file_format: parquet
  metadata_table_path: '/mnt/customer360-blob-output/C360/metadata_table/'
  load_args:
    increment_flag: 'yes'
    lookup_table_name: 'l1_geo_usage_sum_data_location_dow_intermediate'
    read_layer: 'l0_daily'
    target_layer: 'l1_daily'
    lookback: '0'

l0_locals_homework_for_l3_geo_home_work_location_id:
  type: datasets.spark_dbfs_dataset.SparkDbfsDataSet
  filepath: /mnt/customer360-blob-data/C360/GEO/locals_homework_new/
  file_format: parquet
  metadata_table_path: '/mnt/customer360-blob-output/C360/metadata_table/'
  load_args:
    increment_flag: 'yes'
    lookup_table_name: 'l3_geo_home_work_location_id'
    read_layer: 'l0_daily'
    target_layer: 'l3_monthly'
    lookback: '0'