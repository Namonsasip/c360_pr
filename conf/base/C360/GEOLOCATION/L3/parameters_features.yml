l3_number_of_bs_used: #396
  where_clause: ""
  feature_list:
    number_of_bs_used: "count(distinct(cell_id))"
  granularity: "start_of_month,imsi"

l3_voice_distance_daily: #425,426,427,428
  where_clause: ""
  feature_list:
    call_count_list: "first(sum_list)"
    average_distance: "first(avg_distance)"
    minimum_distance: "first(min_distance)"
    maximum_distance: "first(max_distance)"
    standard_deviation_distance: "first(stdev_distance)"
  granularity: "start_of_month,access_method_num"

l3_first_data_session_cell_identifier: #470
  where_clause: "where rank_monthly = 1"
  feature_list:
    start_of_month: "start_of_month"
    mobile_no: "mobile_no"
    gprs_type: "gprs_type"
    imei: "imei"
    lac: "lac"
    ci: "ci"
  granularity: ""

l3_data_distance_monthly: #473,476,479
  where_clause: ""
  feature_list:
    call_count_list: "first(sum_list)"
    average_distance: "first(avg_distance)"
    minimum_distance: "first(min_distance)"
    maximum_distance: "first(max_distance)"
#    standard_deviation_distance: "first(stdev_distance)"
  granularity: "start_of_month,mobile_no"

l3_data_distance_weekday_monthly: #471,474,477
  where_clause: ""
  feature_list:
    call_count_list: "first(sum_list)"
    average_distance: "first(avg_distance)"
    minimum_distance: "first(min_distance)"
    maximum_distance: "first(max_distance)"
  #    standard_deviation_distance: "first(stdev_distance)"
  granularity: "start_of_month,mobile_no"

l3_data_distance_weekend_monthly: #472,475,478
  where_clause: ""
  feature_list:
    call_count_list: "first(sum_list)"
    average_distance: "first(avg_distance)"
    minimum_distance: "first(min_distance)"
    maximum_distance: "first(max_distance)"
  #    standard_deviation_distance: "first(stdev_distance)"
  granularity: "start_of_month,mobile_no"

l3_geo_home_work_location_id: # 398/399
  where_clause: ""
  feature_list:
    home_location_id: "first(home_shape_id)"
    work_location_id: "first(work_shape_id)"
  granularity: "start_of_month,imsi,msisdn"


l3_data_frequent_cell_weekday_monthly: #434/437/443/449/452/455/458/461/464
  where_clause: ""
  feature_list:
    sum_no_of_call_rank_1: "sum(sum_rank_1)"
    rank_1_is_4G_Flag: "most_frequent_cell_type='4GLTE'"
    sum_no_of_call_rank_2: "sum(sum_rank_2)"
    rank_2_is_4G_Flag: "second_most_frequent_tell_type='4GLTE'"
    sum_no_of_call_rank_3: "sum(sum_rank_3)"
    sum_no_of_call_rank_4: "sum(sum_rank_4)"
    sum_no_of_call_rank_5: "sum(sum_rank_5)"
    sum_no_of_call_all: "sum(sum_call)"
    Number_of_Unique_Cells: "count(1)"
    cgi_partial_rank_1: "concat_ws('', collect_list(cgi_partial_rank_1))"
    cgi_partial_rank_2: "concat_ws('', collect_list(cgi_partial_rank_2))"
  granularity: "start_of_month,mobile_no"

l3_data_frequent_cell_weekend_monthly: #435/439/445/450/453/456/459/462/465
  where_clause: ""
  feature_list:
    sum_no_of_call_rank_1: "sum(sum_rank_1)"

    sum_no_of_call_rank_2: "sum(sum_rank_2)"

    sum_no_of_call_rank_3: "sum(sum_rank_3)"
    sum_no_of_call_rank_4: "sum(sum_rank_4)"
    sum_no_of_call_rank_5: "sum(sum_rank_5)"
    sum_no_of_call_all: "sum(sum_call)"
    Number_of_Unique_Cells: "count(1)"
    cgi_partial_rank_1: "concat_ws('', collect_list(cgi_partial_rank_1))"
    cgi_partial_rank_2: "concat_ws('', collect_list(cgi_partial_rank_2))"
  granularity: "start_of_month,mobile_no"

l3_data_frequent_cell_monthly: #436/441/447/451/454/457/460/463
  where_clause: ""
  feature_list:
    sum_no_of_call_rank_1: "sum(sum_rank_1)"

    sum_no_of_call_rank_2: "sum(sum_rank_2)"

    sum_no_of_call_rank_3: "sum(sum_rank_3)"
    sum_no_of_call_rank_4: "sum(sum_rank_4)"
    sum_no_of_call_rank_5: "sum(sum_rank_5)"
    Number_of_Unique_Cells: "count(1)"
    cgi_partial_rank_1: "concat_ws('', collect_list(cgi_partial_rank_1))"
    cgi_partial_rank_2: "concat_ws('', collect_list(cgi_partial_rank_2))"
  granularity: "start_of_month,mobile_no"




#l3_data_frequent_cell_4g_weekday_monthly: #438/444
#  where_clause: ""
#  feature_list:
#    cgi_partial_rank_1: "concat_ws('', collect_list(cgi_partial_rank_1))"
#    cgi_partial_rank_2: "concat_ws('', collect_list(cgi_partial_rank_2))"
#  granularity: "start_of_month,mobile_no"
#
#l3_data_frequent_cell_4g_weekend_monthly: #440/446
#  where_clause: ""
#  feature_list:
#    cgi_partial_rank_1: "concat_ws('', collect_list(cgi_partial_rank_1))"
#    cgi_partial_rank_2: "concat_ws('', collect_list(cgi_partial_rank_2))"
#  granularity: "start_of_month,mobile_no"
#
#l3_data_frequent_cell_4g_monthly: #442/448
#  where_clause: ""
#  feature_list:
#    cgi_partial_rank_1: "concat_ws('', collect_list(cgi_partial_rank_1))"
#    cgi_partial_rank_2: "concat_ws('', collect_list(cgi_partial_rank_2))"
#  granularity: "start_of_month,mobile_no"

l3_geo_call_count_location_monthly: #402,403,404,405
  where_clause: ""
  feature_list:
    cgi_partial_home : "sum(cgi_partial_home)"
    sum_call_home : "sum(sum_call_home)"
    cgi_partial_office : "sum(cgi_partial_office)"
    sum_call_office : "sum(sum_call_office)"
    cgi_partial_other_rank_1 : "sum(cgi_partial_other_rank_1)"
    sum_call_other_rank_1 : "sum(sum_call_other_rank_1)"
    cgi_partial_other_rank_2 : "sum(cgi_partial_other_rank_2)"
    sum_call_other_rank_2 : "sum(sum_call_other_rank_2)"
  granularity: "start_of_month,access_method_num"

l3_geo_data_traffic_location_monthly: #406-413
  where_clause: ""
  feature_list:
    cgi_partial_home : "sum(cgi_partial_home)"
    sum_total_vol_kb_home : "sum(sum_total_vol_kb_home)"
    cgi_partial_office : "sum(cgi_partial_office)"
    sum_total_vol_kb_office : "sum(sum_total_vol_kb_office)"
    cgi_partial_other_rank_1 : "sum(cgi_partial_other_rank_1)"
    sum_total_vol_kb_rank_1 : "sum(sum_total_vol_kb_other_rank_1)"
    cgi_partial_other_rank_2 : "sum(cgi_partial_other_rank_2)"
    sum_total_vol_kb_rank_2 : "sum(sum_total_vol_kb_other_rank_2)"
  granularity: "start_of_month,access_method_num"

l3_geo_data_share_location_monthly:
  where_clause: ""
  feature_list:
    data_share_home_percent: "sum(sum_total_vol_kb_home)/sum(sum_total_vol_kb)*100"
    data_share_office_percent: "sum(sum_total_vol_kb_office)/sum(sum_total_vol_kb)*100"
    data_share_other_rank_1_percent: "sum(sum_total_vol_kb_other_rank_1)/sum(sum_total_vol_kb)*100"
    data_share_other_rank_2_percent: "sum(sum_total_vol_kb_other_rank_2)/sum(sum_total_vol_kb)*100"
    total_all: "sum(sum_total_vol_kb)"
    total_home: "sum(sum_total_vol_kb_home)"
    total_office: "sum(sum_total_vol_kb_office)"
    total_other_rank_1: "sum(sum_total_vol_kb_other_rank_1)"
    total_other_rank_2: "sum(sum_total_vol_kb_other_rank_2)"
  granularity: "start_of_month,access_method_num"

