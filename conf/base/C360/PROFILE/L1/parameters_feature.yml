# Config file for query generator
l1_customer_profile_union_daily_feature:
  customer_pre:
    imsi: imsi
    subscription_identifier: "subscription_identifier"
    access_method_num: "mobile_no"
    register_date: "register_date"
    zipcode: "zipcode"
    prefer_language: "prefer_language"
    company_size: "null"
    corporate_flag: "case when (upper(cust_type) = 'B') then 'Y' else 'N' end"
    prefer_language_eng: "case when lower(prefer_language) like 'eng%' then 'Y' else 'N' end"
    prefer_language_thai: "case when lower(prefer_language) like 'thai%' then 'Y' else 'N' end"
    prefer_language_other: >
      case when lower(prefer_language) not like 'thai%' or
               lower(prefer_language) not like 'eng%'
               then 'Y' else 'N' end
    current_package_id: package_id
    current_package_name: promotion_name
    age: age
    gender: gender
    subscriber_tenure_day: "datediff(to_date(cast(partition_date as STRING), 'yyyyMMdd'), to_date(register_date))"
    subscriber_tenure_month: "service_month"
    subscription_status: mobile_status
    customer_segment: "mobile_segment"
    serenade_status: "mobile_segment"
    network_type: "root_network_type"
    national_id_card: "card_no"
    partition_date: "to_date(cast(partition_date as string), 'yyyyMMdd')"
    charge_type: "'Pre-paid'" # TODO: change once we have the column in cloud
    billing_account_no: "null"
    suppress_sms: "suppress_sms"
    supp_cntn_all: "supp_cntn_all"
    vip_flag: "vip_flag"
    royal_family_flag: "royal_family_flag"

  customer_post:
    imsi: imsi
    subscription_identifier: "subscription_identifier"
    access_method_num: "mobile_no"
    register_date: "register_date"
    zipcode: "zipcode"
    prefer_language: "prefer_language"
    company_size: "corp_account_size"
    corporate_flag: "case when (upper(cust_type) = 'B') or (upper(cust_type) = 'R' and upper(rsme_flag) = 'Y') then 'Y' else 'N' end"
    prefer_language_eng: "case when lower(prefer_language) like 'eng%' then 'Y' else 'N' end"
    prefer_language_thai: "case when lower(prefer_language) like 'thai%' then 'Y' else 'N' end"
    prefer_language_other: >
      case when lower(prefer_language) not like 'thai%' or
               lower(prefer_language) not like 'eng%'
               then 'Y' else 'N' end
    current_package_id: current_promotion_id_ma
    current_package_name: current_promotion_title_ma
    age: ma_age
    gender: ma_gender_code
    subscriber_tenure_day: "datediff(to_date(cast(partition_date as STRING), 'yyyyMMdd'), to_date(register_date))"
    subscriber_tenure_month: "service_month"
    subscription_status: mobile_status
    customer_segment: "mobile_segment"
    serenade_status: "mobile_segment"
    network_type: "network_type"
    national_id_card: "card_id"
    partition_date: "to_date(cast(partition_date as string), 'yyyyMMdd')"
    charge_type: "'Post-paid'" # TODO: change once we have the column in cloud
    billing_account_no: "account_no"
    suppress_sms: "suppress_sms"
    supp_cntn_all: "supp_cntn_all"
    vip_flag: "vip_flag"
    royal_family_flag: "royal_family_flag"

  customer_non_mobile:
    imsi: imsi
    subscription_identifier: "subscription_identifier"
    access_method_num: "mobile_no"
    register_date: "register_date"
    zipcode: "zipcode"
    prefer_language: "prefer_language"
    company_size: "corp_account_size"
    corporate_flag: "case when (upper(cust_type) = 'B') or (upper(cust_type) = 'R' and upper(rsme_flag) = 'Y') then 'Y' else 'N' end"
    prefer_language_eng: "case when lower(prefer_language) like 'eng%' then 'Y' else 'N' end"
    prefer_language_thai: "case when lower(prefer_language) like 'thai%' then 'Y' else 'N' end"
    prefer_language_other: >
      case when lower(prefer_language) not like 'thai%' or
               lower(prefer_language) not like 'eng%'
               then 'Y' else 'N' end
    current_package_id: current_promotion_id_ma
    current_package_name: current_promotion_title_ma
    age: ma_age
    gender: ma_gender_code
    subscriber_tenure_day: "datediff(to_date(cast(partition_date as STRING), 'yyyyMMdd'), to_date(register_date))"
    subscriber_tenure_month: "service_month"
    subscription_status: mobile_status
    customer_segment: "mobile_segment"
    serenade_status: "mobile_segment"
    network_type: "network_type"
    national_id_card: "card_id"
    partition_date: "to_date(cast(partition_date as string), 'yyyyMMdd')"
    charge_type: "'Post-paid'" # TODO: change once we have the column in cloud
    billing_account_no: "account_no"
    suppress_sms: "suppress_sms"
    supp_cntn_all: "supp_cntn_all"
    vip_flag: "vip_flag"
    royal_family_flag: "royal_family_flag"


customer_profile_partition_col: "partition_date"
