# Config file for query generator
l1_customer_profile_union_daily_feature:
  customer_pre:
    imsi: imsi
    old_subscription_identifier: "subscription_identifier"
    access_method_num: "mobile_no"
    register_date: "register_date"
    zipcode: "zipcode"
    prefer_language: "prefer_language"
    corp_account_size: "null"
    corporate_flag: "case when (upper(cust_type) = 'B') then 'Y' else 'N' end"
    prefer_language_eng: "case when lower(prefer_language) like 'eng%' then 'Y' else 'N' end"
    prefer_language_thai: "case when lower(prefer_language) like 'tha%' then 'Y' else 'N' end"
    prefer_language_other: >
      case when lower(prefer_language) not like 'tha%' or
               lower(prefer_language) not like 'eng%'
               then 'Y' else 'N' end
    current_package_id: package_id
    current_package_name: promotion_name
    age: age
    gender: gender
    subscriber_tenure_day: "datediff(to_date(cast(partition_date as STRING), 'yyyyMMdd'), to_date(register_date))"
    subscriber_tenure_month: "service_month"
    subscription_status: mobile_status
    mobile_segment: "mobile_segment"
    serenade_flag: "case when mobile_segment = 'MS_CLASSIC' then 'N' else 'Y' end"
    network_type: "'OTC'"
    national_id_card: "card_no"
    partition_date: "to_date(cast(partition_date as string), 'yyyyMMdd')"
    charge_type: "'Pre-paid'"
    billing_account_no: "null"
    suppress_sms: "suppress_sms"
    supp_cntn_all: "supp_cntn_all"
    vip_flag: "vip_flag"
    royal_family_flag: "royal_family_flag"
    time_with_current_package: "null"
    foreign_flag: "null"
    global_control_group: "global_control_group"

  customer_post:
    imsi: imsi
    old_subscription_identifier: "subscription_identifier"
    access_method_num: "mobile_no"
    register_date: "register_date"
    zipcode: "zipcode"
    prefer_language: "prefer_language"
    corp_account_size: "corp_account_size"
    corporate_flag: "case when (upper(cust_type) = 'B') or (upper(cust_type) = 'R' and upper(rsme_flag) = 'Y') then 'Y' else 'N' end"
    prefer_language_eng: "case when lower(prefer_language) like 'eng%' then 'Y' else 'N' end"
    prefer_language_thai: "case when lower(prefer_language) like 'tha%' then 'Y' else 'N' end"
    prefer_language_other: >
      case when lower(prefer_language) not like 'tha%' or
               lower(prefer_language) not like 'eng%'
               then 'Y' else 'N' end
    current_package_id: current_promotion_id_ma
    current_package_name: current_promotion_title_ma
    age: ma_age
    gender: ma_gender_code
    subscriber_tenure_day: "datediff(to_date(cast(partition_date as STRING), 'yyyyMMdd'), to_date(register_date))"
    subscriber_tenure_month: "service_month"
    subscription_status: mobile_status
    mobile_segment: "mobile_segment"
    serenade_flag: "case when lower(mobile_segment) like 'classic%'
                                     or lower(mobile_segment) like 'standard%'
                                     or lower(mobile_segment) like 'prospect%'
                                     then 'N' else 'Y' end"
    network_type: "network_type"
    national_id_card: "card_id"
    partition_date: "to_date(cast(partition_date as string), 'yyyyMMdd')"
    charge_type: "'Post-paid'"
    billing_account_no: "account_no"
    suppress_sms: "suppress_sms"
    supp_cntn_all: "supp_cntn_all"
    vip_flag: "vip_flag"
    royal_family_flag: "royal_family_flag"
    time_with_current_package: "datediff(current_date(), current_promotion_effdate_ma)"
    foreign_flag: "case when cust_type = 'R' and cust_stype = 'FOR' THEN 'Y' else 'N' end"
    global_control_group: "global_control_group"

  customer_non_mobile:
    imsi: imsi
    old_subscription_identifier: "subscription_identifier"
    access_method_num: "mobile_no"
    register_date: "register_date"
    zipcode: "zipcode"
    prefer_language: "prefer_language"
    corp_account_size: "corp_account_size"
    corporate_flag: "case when (upper(cust_type) = 'B') or (upper(cust_type) = 'R' and upper(rsme_flag) = 'Y') then 'Y' else 'N' end"
    prefer_language_eng: "case when lower(prefer_language) like 'eng%' then 'Y' else 'N' end"
    prefer_language_thai: "case when lower(prefer_language) like 'tha%' then 'Y' else 'N' end"
    prefer_language_other: >
      case when lower(prefer_language) not like 'tha%' or
               lower(prefer_language) not like 'eng%'
               then 'Y' else 'N' end
    current_package_id: current_promotion_id_ma
    current_package_name: current_promotion_title_ma
    age: ma_age
    gender: ma_gender_code
    subscriber_tenure_day: "datediff(to_date(cast(partition_date as STRING), 'yyyyMMdd'), to_date(register_date))"
    subscriber_tenure_month: "service_month"
    subscription_status: mobile_status
    mobile_segment: "mobile_segment"
    serenade_flag: "case when lower(mobile_segment) like 'classic%'
                                     or lower(mobile_segment) like 'standard%'
                                     or lower(mobile_segment) like 'prospect%'
                                     then 'N' else 'Y' end"
    network_type: "network_type"
    national_id_card: "card_id"
    partition_date: "to_date(cast(partition_date as string), 'yyyyMMdd')"
    charge_type: "'Non-Mobile'"
    billing_account_no: "account_no"
    suppress_sms: "suppress_sms"
    supp_cntn_all: "supp_cntn_all"
    vip_flag: "vip_flag"
    royal_family_flag: "royal_family_flag"
    time_with_current_package: "datediff(current_date(), current_promotion_effdate_ma)"
    foreign_flag: "case when cust_type = 'R' and cust_stype = 'FOR' THEN 'Y' else 'N' end"
    global_control_group: "null"

customer_profile_partition_col: "partition_date"
