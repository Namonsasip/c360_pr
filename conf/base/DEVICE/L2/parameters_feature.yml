l2_device_handset_summary_with_configuration:
    where_clause: ""
    feature_list:
      start_of_month: "start_of_month"
      start_of_week: "start_of_week"
      mobile_no: "mobile_no"
      register_date: "date(register_date)"
      device_last_use_time: "handset_last_use_time"
      device_brand_code: "handset_brand_code"
      device_model_code: "handset_model_code"
      device_brand_name: "handset_brand_name"
      device_model_name: "handset_model_name"
      device_imei: "handset_imei"
      device_type: "handset_type"
      SmartPhone_device: "case when handset_type in ('SmartPhone','smartphone','Smart Phone','Smart phone','Smartphone','Phablet')
                          then 'Y' else 'N' end"
      FeaturePhone_device: "case when handset_type in ('StandardPhone','standardphone','Standard Phone','Standard phone','Standardphone',
                                'LegacyPhone','legacyphone','Legacy Phone','Legacy phone','Legacyphone')
                            then 'Y' else 'N' end"
      Tablet_device: "case when handset_type in ('Tablet','tablet')
                      then 'Y' else 'N' end"
      Modem_device: "case when handset_type in ('Modem','modem','WirelessRouter','wirelessrouter','Wireless Router','Wireless router',
                         'Wirelessrouter','AirCard/Dongle')
                     then 'Y' else 'N' end"
      SmartWatch_device: "case when handset_type in ('WatchPhone','watchphone','Watch Phone','Watch phone','Watchphone','SmartWatch',
                              'smartwatch','Smart Watch','Smart watch','Smartwatch')
                          then 'Y' else 'N' end"
      Unknown_device: "case when handset_type is null
                       then 'Y' else 'N' end"
      device_launch_price: "launchprice"
      device_sale_price: "saleprice"
      device_supports_umts: "handset_support_3g_2100_yn"
      device_supports_wds: "handset_wds_flag"
      is_ais_customer: "case when handset_channel='AIS'
                        then 'Y' else 'N' end"
      device_supports_dual_sim: "dual_sim"
      device_supports_lte: "hs_support_lte_1800"
      devices_uses_both_sim_slot: "dual_user_yn"
      device_supports_hsdpa: "hsdpa"
      device_supports_video_call: "video_call"
      device_operating_system: "os"
      device_supports_gprs: "gprs_handset_support"
      device_supports_google_map: "google_map"
      rank: "row_number()
             over(partition by start_of_month,start_of_week,mobile_no,date(register_date)
             order by handset_last_use_time desc)"
    granularity: ""