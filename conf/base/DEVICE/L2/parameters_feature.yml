l2_device_handset_summary_with_configuration:
    where_clause: ""
    feature_list:
      start_of_week: "start_of_week"
      mobile_no: "mobile_no"
      register_date: "date(register_date)"
      device_last_use_time: "handset_last_use_time"
      device_brand_code: "handset_brand_code"
      device_model_code: "handset_model_code"
      device_brand_name: "handset_brand_name"
      device_model_name: "handset_model_name"
      device_imei: "handset_imei"
      device_type: "handset_type"
      device_time_with_current_device_days: "datediff(handset_last_use_time,handset_first_use_time)"
      device_SmartPhone: "case when handset_type in ('SmartPhone','smartphone','Smart Phone','Smart phone','Smartphone')
                          then 'Y' else 'N' end"
      device_StandardPhone: "case when handset_type in ('StandardPhone','standardphone','Standard Phone','Standard phone','Standardphone')
                            then 'Y' else 'N' end"
      device_LegacyPhone: "case when handset_type in ('LegacyPhone','legacyphone','Legacy Phone','Legacy phone','Legacyphone')
                            then 'Y' else 'N' end"
      device_NetBook: "case when handset_type in ('NetBook','netbook','Net Book','Net book','Netbook')
                            then 'Y' else 'N' end"
      device_Tablet: "case when handset_type in ('Tablet','tablet')
                      then 'Y' else 'N' end"
      device_Phablet: "case when handset_type in ('Phablet','phablet')
                      then 'Y' else 'N' end"
      device_Module: "case when handset_type in ('Module','module')
                      then 'Y' else 'N' end"
      device_Handheld: "case when handset_type in ('Handheld','handheld')
                      then 'Y' else 'N' end"
      device_Vehicle: "case when handset_type in ('Vehicle','vehicle')
                      then 'Y' else 'N' end"
      device_Air_card_or_dongle: "case when handset_type in ('AirCard/Dongle')
                      then 'Y' else 'N' end"
      device_Modem: "case when handset_type in ('Modem','modem')
                     then 'Y' else 'N' end"
      device_WirelessRouter: "case when handset_type in ('WirelessRouter','wirelessrouter','Wireless Router','Wireless router',
                         'Wirelessrouter')
                     then 'Y' else 'N' end"
      device_SmartWatch: "case when handset_type in ('SmartWatch','smartwatch','Smart Watch','Smart watch','Smartwatch')
                          then 'Y' else 'N' end"
      device_WatchPhone: "case when handset_type in ('WatchPhone','watchphone','Watch Phone','Watch phone','Watchphone')
                          then 'Y' else 'N' end"
      device_IotVehicle: "case when handset_type in ('IOT-VEHICLE','Iot-Vehicle')
                      then 'Y' else 'N' end"
      device_Unknown: "case when handset_type is null
                       then 'Y' else 'N' end"
      device_high_range: "case when coalesce(launchprice ,saleprice  ) > 14500
                          then 'Y' else 'N' end"
      device_mid_range: "case when coalesce(launchprice ,saleprice  ) >= 4500 and coalesce(launchprice ,saleprice  ) <= 14500
                          then 'Y' else 'N' end"
      device_low_range: "case when coalesce(launchprice ,saleprice  ) < 4500
                          then 'Y' else 'N' end"
      device_launch_price: "launchprice"
      device_sale_price: "saleprice"
      device_supports_umts: "handset_support_3g_2100_yn"
      device_supports_wds: "handset_wds_flag"
      is_ais_customer: "case when handset_channel='AIS'
                        then 'Y' else 'N' end"
      device_supports_dual_sim: "dual_sim"
      device_supports_lte: "hs_support_lte_1800"
      devices_uses_both_sim_slot: "dual_user_yn"
      device_supports_hsdpa: "hsdpa"
      device_supports_video_call: "video_call"
      device_operating_system: "os"
      device_supports_gprs: "gprs_handset_support"
      device_supports_google_map: "google_map"
      rank: "row_number()
             over(partition by start_of_week,mobile_no,date(register_date)
             order by handset_last_use_time desc)"
    granularity: ""

l2_device_most_used_initial:
    where_clause: ""
    feature_list:
        device_used_days: "count(distinct date_id)"
        rank: "row_number() over(partition by start_of_week,mobile_no,register_date
               order by count(distinct date_id) desc)"
    granularity: "start_of_week,mobile_no,register_date,handset_brand_name"

l2_device_most_used:
    where_clause: "where rank = 1"
    feature_list:
        start_of_week: "start_of_week"
        mobile_no: "mobile_no"
        register_date: "register_date"
        device_most_used_handset_samsung: "case when handset_brand_name='SAMSUNG' then 'Y' else 'N' end"
        device_most_used_handset_huawei: "case when handset_brand_name='HUAWEI' then 'Y' else 'N' end"
        device_most_used_handset_oppo: "case when handset_brand_name='OPPO' then 'Y' else 'N' end"
        device_most_used_handset_apple: "case when handset_brand_name='APPLE' then 'Y' else 'N' end"
        device_most_used_handset_xiaomi: "case when handset_brand_name='XIAOMI' then 'Y' else 'N' end"
        device_most_used_handset_others: "case when handset_brand_name not in ('SAMSUNG','HUAWEI','OPPO','APPLE','XIAOMI') then 'Y' else 'N' end"
    granularity: ""

l2_previous_device_features_with_config_ranked:
    where_clause: ""
    feature_list:
        device_last_use_time: "max(handset_last_use_time)"
        rank: "row_number() over( partition by start_of_week,mobile_no,register_date
                                  order by max(handset_last_use_time) desc)"
    granularity: "start_of_week,mobile_no,register_date,handset_imei,
    handset_brand_code,handset_model_code,handset_brand_name,handset_model_name"

l2_previous_device_features_with_config:
    where_clause: "where rank<=2"
    feature_list:
        start_of_week: "start_of_week"
        mobile_no: "mobile_no"
        register_date: "register_date"
        device_previous_imei: "last_value(handset_imei) over( partition by start_of_week,mobile_no,register_date
                                                              order by rank)"
        device_previous_brand_code: "last_value(handset_brand_code) over( partition by start_of_week,mobile_no,register_date
                                                                          order by rank)"
        device_previous_brand_name: "last_value(handset_brand_name) over( partition by start_of_week,mobile_no,register_date
                                                                    order by rank)"
        device_previous_model_name: "last_value(handset_model_name) over( partition by start_of_week,mobile_no,register_date
                                                                    order by rank)"
    granularity: ""

l2_device_number_of_phone_updates:
    where_clause: ""
    feature_list:
        device_number_of_phone_updates: "count(distinct handset_imei)"
    granularity: "start_of_week,mobile_no,date(register_date)"