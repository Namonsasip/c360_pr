l4_device_most_used_initial:
  partition_by: ["access_method_num","register_date","subscription_identifier","handset_brand_name"]
  feature_list:
    sum: ["device_used_days"]
  read_from: "l2"

l4_device_most_used_with_ranks:
  where_clause: ""
  feature_column:
    handset_brand_name: "handset_brand_name"
  partition_by: ["access_method_num","register_date","subscription_identifier", "start_of_week"]
  order_by_column_prefix: "sum_device_used_days"
  read_from: "l2"
  to_join: True
  order: desc

l4_device_most_used:
  where_clause: ""
  feature_list:
      start_of_week: "start_of_week"
      access_method_num: "access_method_num"
      register_date: "register_date"
      subscription_identifier: "subscription_identifier"
      device_most_used_handset_samsung_last_week: "case when handset_brand_name_last_week='SAMSUNG' then 'Y' else 'N' end"
      device_most_used_handset_huawei_last_week: "case when handset_brand_name_last_week='HUAWEI' then 'Y' else 'N' end"
      device_most_used_handset_oppo_last_week: "case when handset_brand_name_last_week='OPPO' then 'Y' else 'N' end"
      device_most_used_handset_apple_last_week: "case when handset_brand_name_last_week='APPLE' then 'Y' else 'N' end"
      device_most_used_handset_xiaomi_last_week: "case when handset_brand_name_last_week='XIAOMI' then 'Y' else 'N' end"
      device_most_used_handset_others_last_week: "case when handset_brand_name_last_week not in ('SAMSUNG','HUAWEI','OPPO','APPLE','XIAOMI') then 'Y' else 'N' end"
      device_most_used_handset_samsung_last_two_week: "case when handset_brand_name_last_two_week='SAMSUNG' then 'Y' else 'N' end"
      device_most_used_handset_huawei_last_two_week: "case when handset_brand_name_last_two_week='HUAWEI' then 'Y' else 'N' end"
      device_most_used_handset_oppo_last_two_week: "case when handset_brand_name_last_two_week='OPPO' then 'Y' else 'N' end"
      device_most_used_handset_apple_last_two_week: "case when handset_brand_name_last_two_week='APPLE' then 'Y' else 'N' end"
      device_most_used_handset_xiaomi_last_two_week: "case when handset_brand_name_last_two_week='XIAOMI' then 'Y' else 'N' end"
      device_most_used_handset_others_last_two_week: "case when handset_brand_name_last_two_week not in ('SAMSUNG','HUAWEI','OPPO','APPLE','XIAOMI') then 'Y' else 'N' end"
      device_most_used_handset_samsung_last_four_week: "case when handset_brand_name_last_four_week='SAMSUNG' then 'Y' else 'N' end"
      device_most_used_handset_huawei_last_four_week: "case when handset_brand_name_last_four_week='HUAWEI' then 'Y' else 'N' end"
      device_most_used_handset_oppo_last_four_week: "case when handset_brand_name_last_four_week='OPPO' then 'Y' else 'N' end"
      device_most_used_handset_apple_last_four_week: "case when handset_brand_name_last_four_week='APPLE' then 'Y' else 'N' end"
      device_most_used_handset_xiaomi_last_four_week: "case when handset_brand_name_last_four_week='XIAOMI' then 'Y' else 'N' end"
      device_most_used_handset_others_last_four_week: "case when handset_brand_name_last_four_week not in ('SAMSUNG','HUAWEI','OPPO','APPLE','XIAOMI') then 'Y' else 'N' end"
      device_most_used_handset_samsung_last_twelve_week: "case when handset_brand_name_last_twelve_week='SAMSUNG' then 'Y' else 'N' end"
      device_most_used_handset_huawei_last_twelve_week: "case when handset_brand_name_last_twelve_week='HUAWEI' then 'Y' else 'N' end"
      device_most_used_handset_oppo_last_twelve_week: "case when handset_brand_name_last_twelve_week='OPPO' then 'Y' else 'N' end"
      device_most_used_handset_apple_last_twelve_week: "case when handset_brand_name_last_twelve_week='APPLE' then 'Y' else 'N' end"
      device_most_used_handset_xiaomi_last_twelve_week: "case when handset_brand_name_last_twelve_week='XIAOMI' then 'Y' else 'N' end"
      device_most_used_handset_others_last_twelve_week: "case when handset_brand_name_last_twelve_week not in ('SAMSUNG','HUAWEI','OPPO','APPLE','XIAOMI') then 'Y' else 'N' end"
  granularity: ""

l4_device_number_of_phone_updates:
  partition_by: ["access_method_num","register_date","subscription_identifier"]
  feature_list:
    sum: ["device_number_of_phone_updates"]
    avg: ["device_number_of_phone_updates"]
  read_from: "l2"