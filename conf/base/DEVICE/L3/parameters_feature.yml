l3_device_handset_summary_with_configuration:
    where_clause: ""
    feature_list:
        start_of_month: "start_of_month"
        mobile_no: "mobile_no"
        register_date: "register_date"
        device_last_use_time: "device_last_use_time"
        device_brand_code: "first_value(device_brand_code)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_model_code: "first_value(device_model_code)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_brand_name: "first_value(device_brand_name)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_model_name: "first_value(device_model_name)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_imei: "first_value(device_imei)
                      over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_type: "first_value(device_type)
                      over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        SmartPhone_device: "first_value(SmartPhone_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        StandardPhone_device: "first_value(StandardPhone_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        LegacyPhone_device: "first_value(LegacyPhone_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        NetBook_device: "first_value(NetBook_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        Tablet_device: "first_value(Tablet_device)
                              over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        Phablet_device: "first_value(Phablet_device)
                        over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        Module_device: "first_value(Module_device)
                       over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        Handheld_device: "first_value(Handheld_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        Vehicle_device: "first_value(Vehicle_device)
                         over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        Air_card_or_dongle_device: "first_value(Air_card_or_dongle_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        Modem_device: "first_value(Modem_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        WirelessRouter_device: "first_value(WirelessRouter_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        SmartWatch_device: "first_value(SmartWatch_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        WatchPhone_device: "first_value(WatchPhone_device)
                              over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        IotVehicle_device: "first_value(IotVehicle_device)
                        over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        Unknown_device: "first_value(Unknown_device)
                       over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        high_range_device: "first_value(high_range_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        mid_range_device: "first_value(mid_range_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        low_range_device: "first_value(low_range_device)
                            over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_launch_price: "first_value(device_launch_price)
                      over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_sale_price: "first_value(device_sale_price)
                      over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_supports_umts: "first_value(device_supports_umts)
                               over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_supports_wds: "first_value(device_supports_wds)
                              over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        is_ais_customer: "first_value(is_ais_customer)
                         over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_supports_dual_sim: "first_value(device_supports_dual_sim)
                                   over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_supports_lte: "first_value(device_supports_lte)
                              over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        devices_uses_both_sim_slot: "first_value(devices_uses_both_sim_slot)
                                     over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_supports_hsdpa: "first_value(device_supports_hsdpa)
                                over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_supports_video_call: "first_value(device_supports_video_call)
                                     over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_operating_system: "first_value(device_operating_system)
                                  over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_supports_gprs: "first_value(device_supports_gprs)
                               over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
        device_supports_google_map: "first_value(device_supports_google_map)
                                     over(partition by start_of_month,mobile_no,register_date order by device_last_use_time desc)"
    granularity: ""

l3_device_most_used_initial:
    where_clause: ""
    feature_list:
        device_used_days: "sum(device_used_days)"
        rank: "row_number() over(partition by start_of_month,mobile_no,register_date
               order by sum(device_used_days) desc)"
    granularity: "start_of_month,mobile_no,register_date,handset_brand_name"

l3_device_most_used:
    where_clause: "where rank = 1"
    feature_list:
        start_of_month: "start_of_month"
        mobile_no: "mobile_no"
        register_date: "register_date"
        most_used_handset_samsung: "case when handset_brand_name='SAMSUNG' then 'Y' else 'N' end"
        most_used_handset_huawei: "case when handset_brand_name='HUAWEI' then 'Y' else 'N' end"
        most_used_handset_oppo: "case when handset_brand_name='OPPO' then 'Y' else 'N' end"
        most_used_handset_apple: "case when handset_brand_name='APPLE' then 'Y' else 'N' end"
        most_used_handset_xiaomi: "case when handset_brand_name='XIAOMI' then 'Y' else 'N' end"
        most_used_handset_others: "case when handset_brand_name not in ('SAMSUNG','HUAWEI','OPPO','APPLE','XIAOMI') then 'Y' else 'N' end"
    granularity: ""

l3_previous_device_features_with_config_ranked:
    where_clause: ""
    feature_list:
        device_last_use_time: "max(handset_last_use_time)"
        rank: "row_number() over( partition by start_of_month,mobile_no,register_date
                                  order by max(handset_last_use_time) desc)"
    granularity: "start_of_month,mobile_no,register_date,handset_imei,
    handset_brand_code,handset_model_code,handset_brand_name,handset_model_name"

l3_previous_device_features_with_config:
    where_clause: "where rank<=2"
    feature_list:
        start_of_month: "start_of_month"
        mobile_no: "mobile_no"
        register_date: "register_date"
        previous_device_imei: "last_value(handset_imei) over( partition by start_of_month,mobile_no,register_date
                                                              order by rank)"
        previous_device_brand_code: "last_value(handset_brand_code) over( partition by start_of_month,mobile_no,register_date
                                                                          order by rank)"
        previous_device_brand_name: "last_value(handset_brand_name) over( partition by start_of_month,mobile_no,register_date
                                                                    order by rank)"
        previous_device_model_name: "last_value(handset_model_name) over( partition by start_of_month,mobile_no,register_date
                                                                    order by rank)"
    granularity: ""


