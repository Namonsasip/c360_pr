# Config file for query generator
int_l4_customer_profile_basic_features:
    where_clause: ""
    feature_list:
        # this is mandatory for joining to union_features table
        access_method_num: "access_method_num"
        register_date: "register_date"
        crm_sub_id: "crm_sub_id"
        charge_type: "charge_type"
        partition_month: "partition_month"

        # this is the rest of the features
        age: "floor(months_between(last_day(to_date(cast(partition_month as STRING), 'yyyyMM')), to_date(birth_date))/12)"
        gender: "gender"
        contract_expiry: "contract_end_month"
        time_with_current_package: "months_between(last_day(to_date(cast(partition_month as STRING), 'yyyyMM')), contract_start_month)"
        customer_segment: "mobile_segment"
        serenade_status: "mobile_segment"
        network_type: "network_type"
        acquisition_channel: "trade_cmd_channel_type"
        subscriber_tenure: "months_between(last_day(to_date(cast(partition_month as STRING), 'yyyyMM')), to_date(register_date))"
    granularity: ""


union_customer_profile_column_to_extract:
  - "zipcode"
